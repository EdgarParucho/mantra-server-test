(function(e){function t(t){for(var n,o,c=t[0],s=t[1],l=t[2],d=0,m=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&m.push(i[o][0]),i[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);u&&u(t);while(m.length)m.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,c=1;c<a.length;c++){var s=a[c];0!==i[s]&&(n=!1)}n&&(r.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},i={app:0},r=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";a("85ec")},"05e6":function(e,t,a){e.exports=a.p+"img/office-building.eeb5b1df.svg"},"0c6e":function(e,t,a){e.exports=a.p+"img/target.73f5ad96.svg"},"179c":function(e,t,a){e.exports=a.p+"img/gear.d2f7a2f6.svg"},"221b":function(e,t,a){e.exports=a.p+"img/technician.3f95dcab.svg"},4211:function(e,t){e.exports={rules:{corpEmail:[function(e){return!!e||"Campo requerido"},function(e){return/^\S+$/.test(e)||"Elimine los espacios"},function(e){return/.+@+microfilmscenterjaha+\.+com+/.test(e)||/.+@+microfilmscenter+\.+com+/.test(e)||"Ingrese el correo corporativo"}],passwordRules:[function(e){return!!e||"Campo requerido"},function(e){return e?8===e.length||"Se requieren 8 caracteres":""}],idRules:[function(e){return/^\d+$/.test(e)||"Campo numérico"}],officeCode:[function(e){return/\d{4}/.test(e)||"Campo de 4 dígitos"}],phone:[function(e){return/\d{11}/.test(e)||"Req. 11 dígitos (0-9)"}],serviceOrder:[function(e){return/\d{6}/.test(e)||"Campo de 6 dígitos"}],emailRule:[function(e){return/.+@.+/.test(e)||"Formato de e-mail inválido"}],required:[function(e){return!!e||"Requerido"},function(e){return/\S/.test(e)||"Requerido"}],noSpaces:[function(e){return!!e||"Requerido"},function(e){return/^\S+$/.test(e)||"Elimine los espacios"}]},states:["Amazonas","Anzoátegui","Aragua","Apure","Barinas","Bolívar","Carabobo","Cojedes","Delta Amacuro","Distrito Capital","Falcón","Guárico","Lara","Mérida","Miranda","Monagas","Nueva Esparta","Portuguesa","Sucre","Táchira","Trujillo","Vargas","Yaracuy","Zulia"],statusOptions:["Cerrado - Operativo","Cerrado - Reemplazado","Cerrado - Desincorporado","Pendiente - Por repuestos","En programación"],maintenanceStatus:["Por culminar","Culminado"],replacementOptions:["Desgaste","Fallas eléctricas","Manipulación incorrecta","Indefinida"],productLocations:["TQ","RS","GO","CP","BO","HA","CO"],departments:["Almacén","Operaciones","Soporte técnico"],roles:[{text:"Usuario",value:2},{text:"Invitado",value:3},{text:"Administrador",value:1}]}},4678:function(e,t,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=r,e.exports=i,i.id="4678"},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[e.$session.get("session")?a("AppBar",{attrs:{app:""}}):e._e(),a("v-main",[a("router-view"),a("v-snackbar",{attrs:{vertical:"",shaped:""},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.attrs;return[a("v-icon",e._b({attrs:{color:e.snackbar.error?"error":"success"}},"v-icon",n,!1),[e._v(" "+e._s(e.snackbar.error?"mdi-alert-circle-outline":"mdi-check")+" ")])]}}]),model:{value:e.snackbar.activated,callback:function(t){e.$set(e.snackbar,"activated",t)},expression:"snackbar.activated"}},[a("span",{staticClass:"overline font-weight-bold"},[e._v(" "+e._s(e.snackbar.title)+" ")]),a("v-divider"),a("p",[e._v(e._s(e.snackbar.message))])],1)],1)],1)},r=[],o=a("5530"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-app-bar",{staticClass:"px-3",attrs:{color:"primary",dark:"",app:""}},[n("v-menu",{attrs:{value:e.drawer,"nudge-bottom":"70"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-app-bar-nav-icon",e._g({},a))]}}])},[n("v-card",{staticClass:"gradients",attrs:{width:"256"}},[n("AppMenu")],1)],1),n("v-spacer"),n("v-avatar",{attrs:{color:"secondary"}},[n("v-avatar",{attrs:{size:"90%",color:"white"}},[n("v-img",{attrs:{src:a("cbb6")}})],1)],1),n("v-spacer"),n("v-menu",{attrs:{"nudge-left":"155","nudge-bottom":"35"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({attrs:{icon:""}},a),[n("v-icon",[e._v("mdi-account-circle")])],1)]}}])},[n("v-card",{staticClass:"gradients pa-5",attrs:{dark:""}},[n("v-list-item",[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"4"}},[n("v-avatar",[n("v-avatar",{attrs:{size:"90%","max-with":"50","max-height":"50"}},[n("v-icon",[e._v("mdi-account")])],1)],1)],1),n("v-col",[n("small",{staticClass:"caption font-weight-bold"},[e._v(" "+e._s(this.$session.get("session").user.firstName)+" "+e._s(this.$session.get("session").user.lastName)+" ")])])],1)],1),n("v-divider",{staticClass:"my-2"}),n("v-list",{attrs:{color:"hsla(140, 45%, 55%, .2)",dense:"",nav:"",elevation:"1"}},[n("v-list-item",[n("v-list-item-icon",[n("v-icon",[e._v("mdi-key")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Cambiar contraseña")])],1)],1),n("v-list-item",{on:{click:e.killSession}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-logout")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Cerrar sesión")])],1)],1)],1)],1)],1)],1)],1)},s=[],l=a("2f62"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-list",{attrs:{color:"hsla(140, 45%, 55%, .3)",dark:"",dense:"",nav:"",elevation:"1"}},e._l(e.options,(function(t){return a("v-list-item",{directives:[{name:"show",rawName:"v-show",value:t.minRole>=e.$store.state.session.user.userRole&&(!t.onlyFor||t.onlyFor===e.$store.state.session.user.department),expression:"\n        option.minRole >= $store.state.session.user.userRole\n        && (!option.onlyFor || option.onlyFor === $store.state.session.user.department)\n      "}],key:t.title,attrs:{link:"",to:t.redirect}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(t.title))])],1)],1)})),1)],1)},d=[],m={name:"AppMenu",data:function(){return{options:[{title:"Panel",icon:"mdi-monitor-dashboard",redirect:"/",minRole:3},{title:"Correctivo",icon:"mdi-tools",redirect:"/correctivo",minRole:3,onlyFor:"Operaciones"},{title:"Preventivo",icon:"mdi-broom",redirect:"/preventivo",minRole:3,onlyFor:"Operaciones"},{title:"Consultas",icon:"mdi-folder-search",redirect:"/consultas",minRole:3,onlyFor:"Operaciones"},{title:"Piezas",icon:"mdi-cog",redirect:"/piezas",minRole:1},{title:"Solicitudes",icon:"mdi-package-variant",redirect:"/solicitudes",minRole:3},{title:"Despachos",icon:"mdi-truck",redirect:"/despachos",minRole:3},{title:"Clientes",icon:"mdi-account-tie",redirect:"/clientes",minRole:3},{title:"Oficinas",icon:"mdi-bank",redirect:"/oficinas",minRole:3,onlyFor:"Operaciones"},{title:"Productos",icon:"mdi-printer",redirect:"/productos",minRole:2},{title:"Usuarios",icon:"mdi-account",redirect:"/usuarios",minRole:1}]}}},f=m,v=a("2877"),p=a("6544"),b=a.n(p),h=a("a523"),g=a("132d"),y=a("8860"),C=a("da13"),k=a("5d23"),x=a("34c3"),_=Object(v["a"])(f,u,d,!1,null,null,null),D=_.exports;b()(_,{VContainer:h["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemTitle:k["c"]});var w={components:{AppMenu:D},name:"AppBar",data:function(){return{drawer:!1}},methods:Object(o["a"])(Object(o["a"])({},Object(l["d"])(["logOut"])),{},{killSession:function(){this.logOut(),this.$session.destroy(),this.$router.push("/login")}})},O=w,S=a("40dc"),V=a("5bc1"),F=a("8212"),j=a("8336"),N=a("b0af"),I=a("62ad"),M=a("ce7e"),$=a("adda"),P=a("e449"),T=a("0fd9"),R=a("2fa4"),A=Object(v["a"])(O,c,s,!1,null,null,null),q=A.exports;b()(A,{VAppBar:S["a"],VAppBarNavIcon:V["a"],VAvatar:F["a"],VBtn:j["a"],VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDivider:M["a"],VIcon:g["a"],VImg:$["a"],VList:y["a"],VListItem:C["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VMenu:P["a"],VRow:T["a"],VSpacer:R["a"]});var E={name:"App",components:{AppBar:q},computed:Object(o["a"])({},Object(l["e"])(["snackbar"])),methods:Object(o["a"])(Object(o["a"])({},Object(l["d"])(["logIn"])),Object(l["b"])(["getcollections"])),created:function(){var e=this.$session.get("session");this.$store.state.session=e,e?this.getcollections():"/login"!==this.$router.currentRoute.fullPath&&this.$router.push("/login")}},L=E,H=(a("034f"),a("7496")),B=a("f6c4"),Y=a("2db4"),z=Object(v["a"])(L,i,r,!1,null,null,null),G=z.exports;b()(z,{VApp:H["a"],VDivider:M["a"],VIcon:g["a"],VMain:B["a"],VSnackbar:Y["a"]});var U=a("9483");Object(U["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var Q=a("8c4f"),X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Estado general",subtitle:"Indicadores de gestión - "+e.thisMonth}}),a("v-alert",{attrs:{type:"info",icon:"mdi-tools",color:"primary",dense:""}},[e._v(" Los indicadores de mantenimiento "),a("b",[e._v("correctivo")]),e._v(" se contabilizan por reporte o servicio especial. ")]),a("v-alert",{attrs:{type:"info",icon:"mdi-broom",color:"accent",dense:""}},[e._v(" Los indicadores de mantenimiento "),a("b",[e._v("preventivo")]),e._v(" se contabilizan por oficina culminada y orden validada. ")]),a("v-row",e._l(e.cards,(function(t,n){return a("v-col",{key:n,attrs:{cols:e.mobile?12:4}},[a("DashboardCard",{attrs:{cardInfo:t,mobile:e.mobile}})],1)})),1),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[e.loading?a("v-sheet",{staticClass:"pa-3"},[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{"max-width":"300",type:"card"}})],1):a("Graph",{attrs:{id:"dashboardGraph2",loading:e.loading,chartData:e.servicesXClient,title:"Servicios por cliente",subtitle:e.thisMonth}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[e.loading?a("v-sheet",{staticClass:"pa-3"},[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{"max-width":"300",type:"card"}})],1):a("Graph",{attrs:{id:"dashboardGraph1",loading:e.loading,chartData:e.servicesXTechnician,title:"Servicios por técnico",subtitle:e.thisMonth}})],1)],1),a("v-row",[a("v-col",[a("v-card",[a("v-card-title",[e._v("Asignaciones del día")]),a("v-chip-group",{attrs:{mandatory:"","active-class":"primary--text",light:""}},[a("v-icon",[e._v("mdi-filter")]),a("v-chip",{attrs:{small:""},on:{click:function(t){e.showTodays=!0}}},[e._v(" "+e._s(e.today)+" ")]),a("v-chip",{attrs:{small:""},on:{click:function(t){e.showTodays=!1}}},[e._v(" "+e._s(e.nextWorkingDay)+" ")])],1),a("QueryResult",{attrs:{result:e.showTodays?e.todaySchedule:e.nextDaySchedule,mobile:e.mobile}})],1)],1)],1)],1)},W=[],Z=a("b85c"),J=a("2909"),K=(a("b0c0"),a("99af"),a("4de4"),a("d81d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-row",[a("v-col",[e.loading?a("v-skeleton-loader",{attrs:{type:"card",height:"40"}}):a("v-alert",{attrs:{color:"primary",border:"left",icon:e.closable?null:"mdi-map-marker",dense:"",dark:"",outlined:!e.closable}},[a("v-row",[a("v-col",[a("v-toolbar-title",[e._v(e._s(e.title))])],1),e.closable?a("v-col",{attrs:{cols:2,align:"end"}},[a("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.$emit("hideInterface")}}},[a("v-icon",[e._v("mdi-close")])],1)],1):e._e()],1),a("small",[e._v(e._s(e.subtitle))])],1)],1)],1)],1)}),ee=[],te={name:"Header",props:["title","subtitle","closable"],computed:Object(o["a"])({},Object(l["e"])(["loading"]))},ae=te,ne=a("0798"),ie=a("3129"),re=a("2a7f"),oe=Object(v["a"])(ae,K,ee,!1,null,null,null),ce=oe.exports;b()(oe,{VAlert:ne["a"],VBtn:j["a"],VCol:I["a"],VIcon:g["a"],VRow:T["a"],VSkeletonLoader:ie["a"],VToolbarTitle:re["a"]});var se=a("7f45"),le=a.n(se),ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"mx-auto"},[a("v-row",[a("canvas",{staticClass:"pa-3",attrs:{id:e.id}})]),a("v-card-title",[e._v(e._s(e.title))]),a("v-card-subtitle",[e._v(e._s(e.subtitle))])],1)],1)},de=[],me=a("d549"),fe={name:"Graph",props:["loading","id","title","subtitle","chartData"],computed:{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}},methods:{createChart:function(e,t){var a=document.getElementById(e),n=new me["a"](a,t);return n}},watch:{loading:function(){this.loading||this.createChart(this.id,this.chartData)}},mounted:function(){this.loading||this.createChart(this.id,this.chartData)}},ve=fe,pe=a("99d9"),be=Object(v["a"])(ve,ue,de,!1,null,null,null),he=be.exports;b()(be,{VCard:N["a"],VCardSubtitle:pe["b"],VCardTitle:pe["d"],VContainer:h["a"],VRow:T["a"]});var ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",[a("v-col",[a("v-card",{staticClass:"text-no-wrap my-2 px-2",attrs:{disabled:!e.cardInfo.data.length}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:"4"}},[a("v-img",{attrs:{src:e.cardInfo.icon,width:"70"}})],1),a("v-col",[a("v-card-title",[e._v(" "+e._s(e.cardInfo.data.length)+" "),e.cardInfo.data.length?a("v-btn",{attrs:{icon:"",small:""},on:{click:e.showBottomSheet}},[a("v-icon",{attrs:{small:"",color:"accent"}},[e._v(" mdi-eye-settings-outline ")])],1):e._e()],1),a("v-card-subtitle",[e._v(" "+e._s(e.cardInfo.title)+" ")])],1)],1)],1)],1)],1),a("v-bottom-sheet",{attrs:{scrollable:""},model:{value:e.bottomSheet,callback:function(t){e.bottomSheet=t},expression:"bottomSheet"}},[a("v-card",[a("Header",{attrs:{closable:"1",title:e.cardInfo.title,subtitle:""},on:{hideInterface:function(t){e.bottomSheet=!1}}}),a("v-card-text",[a("QueryResult",{attrs:{result:e.cardInfo.data,mobile:e.mobile}})],1)],1)],1)],1)},ye=[],Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{md:"3"}},[a("v-text-field",{attrs:{"prepend-inner-icon":"mdi-magnify",label:"Filtrar"},model:{value:e.tableFilter,callback:function(t){e.tableFilter=t},expression:"tableFilter"}})],1),a("v-col",{attrs:{align:"end"}},[e.xlsFormat?a("export-excel",{attrs:{data:e.xlsFormat}},[a("v-btn",{attrs:{dark:"",small:"",disabled:!e.result.length,color:"#2a5"}},[a("v-icon",[e._v("mdi-microsoft-excel")])],1)],1):e._e()],1)],1),a("v-data-table",{staticClass:"elevation-2",attrs:{dense:"","items-per-page":5,headers:e.headers,items:e.result,search:e.tableFilter},scopedSlots:e._u([{key:"item.serviceType",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("serviceType")(a))+" ")]}},{key:"item.reportedAt",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("friendlyDate")(a.reportedAt))+" ")]}},{key:"item.actions",fn:function(t){var n=t.item;return[a("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{color:"primary",small:""}},n),[a("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[a("v-list",{attrs:{color:"primary",dark:"",dense:""}},[n.reportCode?a("v-list-item-group",e._l(e.reportsMenu,(function(t,i){return a("v-list-item",{key:i,attrs:{disabled:n.status.includes("Cerrado")&&"details"!==t.action},on:{click:function(a){return e.showDialog(t.action,n)}}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" "+e._s(t.title)+" ")])],1)],1)})),1):a("v-list-item-group",e._l(e.maintenanceMenu,(function(t,i){return a("v-list-item",{key:i,attrs:{disabled:"Asignado"!==n.status&&"Por culminar"!==n.status},on:{click:function(a){return e.showDialog(t.action,n)}}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" "+e._s(t.title)+" ")])],1)],1)})),1)],1)],1)]}}])}),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:"",fullscreen:e.detailsInterface},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.detailsInterface?a("CorrectiveInfo",{attrs:{selectedDocument:e.selectedDocument,mobile:e.mobile},on:{hideInterface:function(t){return e.hideInterface("details")}}}):e._e(),e.scheduleInterface?a("CorrectiveSchedule",{attrs:{selectedDocument:e.selectedDocument,mobile:e.mobile},on:{hideInterface:function(t){return e.hideInterface("schedule")}}}):e._e(),e.updateInterface?a("CorrectiveUpdate",{attrs:{selectedDocument:e.selectedDocument,mobile:e.mobile},on:{hideInterface:function(t){return e.hideInterface("update")}}}):e._e(),e.scheduleMaintenanceInterface?a("MaintenanceForm",{attrs:{editing:e.selectedDocument,collections:e.collections,mobile:e.mobile,pendingMaintenance:e.pendingMaintenance},on:{hideInterface:function(t){return e.hideInterface("scheduleMaintenance")}}}):e._e(),e.updateMaintenanceInterface?a("MaintenanceUpdate",{attrs:{updating:e.selectedDocument,collections:e.collections,mobile:e.mobile},on:{hideInterface:function(t){return e.hideInterface("updateMaintenance")}}}):e._e()],1)],1)],1)},ke=[],xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Asignación",subtitle:"Registre la fecha y el personal asignado"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-form",{ref:"form",model:{value:e.assignForm,callback:function(t){e.assignForm=t},expression:"assignForm"}},[a("v-row",{attrs:{justify:"end"}},[a("v-col",{attrs:{cols:e.mobile?12:9}},[a("v-autocomplete",{attrs:{label:"Técnico asignado",items:e.formOptions.technicians,rules:e.rules.required},model:{value:e.schedule.technician,callback:function(t){e.$set(e.schedule,"technician",t)},expression:"schedule.technician"}})],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{align:"center",cols:"3"}},[a("DateMenu",{on:{setDate:function(t){return e.dateSubmitted=t}}})],1),a("v-col",{attrs:{cols:"9"}},[a("v-text-field",{attrs:{"error-messages":e.itIsWeekend(e.dateSubmitted)?"Seleccione un día de la semana":"",rules:e.rules.required,label:"Fecha estimada de atención",readonly:""},model:{value:e.friendlyDate,callback:function(t){e.friendlyDate=t},expression:"friendlyDate"}})],1)],1),a("v-row",{staticClass:"pb-2",attrs:{align:"center"}},[a("v-col",{attrs:{align:"center"}},[a("v-btn",{attrs:{disabled:!e.assignForm,loading:e.loader,color:"primary"},on:{click:e.save}},[e._v(" Registrar ")])],1)],1)],1)],1)},_e=[],De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-menu",{ref:"datemenu",attrs:{"close-on-content-click":!1,"return-value":e.dateSubmitted},on:{"update:returnValue":function(t){e.dateSubmitted=t},"update:return-value":function(t){e.dateSubmitted=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ma-1",attrs:{color:e.itIsWeekend(e.dateSubmitted)?"error":"primary",small:""}},"v-btn",i,!1),n),[a("v-icon",[e._v("mdi-calendar")])],1)]}}]),model:{value:e.datePicker,callback:function(t){e.datePicker=t},expression:"datePicker"}},[a("v-date-picker",{attrs:{color:e.itIsWeekend(e.dateSubmitted)?"error":"primary","no-title":"",scrollable:""},model:{value:e.dateSubmitted,callback:function(t){e.dateSubmitted=t},expression:"dateSubmitted"}},[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.datePicker=!1}}},[e._v(" Cancelar ")]),a("v-btn",{attrs:{disabled:e.itIsWeekend(e.dateSubmitted),color:"primary",text:""},on:{click:function(t){return e.$refs.datemenu.save(e.dateSubmitted)}}},[e._v(" OK ")]),e.itIsWeekend(e.dateSubmitted)?a("v-tooltip",{attrs:{right:"",color:"error"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-icon",e._g({attrs:{color:"error"}},n),[e._v("mdi-alert-circle-outline")])]}}],null,!1,1817395708)},[e._v(" Por favor seleccione un día válido ")]):e._e()],1)],1)],1)},we=[];le.a.locale("es");var Oe={name:"DateMenu",props:[],data:function(){return{datePicker:!1,dateSubmitted:(new Date).toISOString().substr(0,10)}},methods:{itIsWeekend:function(e){return"sábado"===le()(e).format("dddd")||"domingo"===le()(e).format("dddd")}},watch:{dateSubmitted:function(){this.$emit("setDate",this.dateSubmitted)}}},Se=Oe,Ve=a("2e4b"),Fe=a("3a2f"),je=Object(v["a"])(Se,De,we,!1,null,null,null),Ne=je.exports;b()(je,{VBtn:j["a"],VContainer:h["a"],VDatePicker:Ve["a"],VIcon:g["a"],VMenu:P["a"],VSpacer:R["a"],VTooltip:Fe["a"]});var Ie=a("4211");le.a.locale("es");var Me=n["a"].extend({name:"CorrectiveSchedule",components:{Header:ce,DateMenu:Ne},props:["mobile","selectedDocument"],created:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("dddd, DD [de] MMMM")),this.schedule.technician=this.selectedDocument.schedule.technician},data:function(){return{assignForm:!1,schedule:{scheduledDate:(new Date).toISOString().substr(0,10),technician:{}},dateSubmitted:(new Date).toISOString().substr(0,10),loader:!1,friendlyDate:"",rules:Ie["rules"]}},computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),{},{formattedDate:function(){return le()("".concat(this.dateSubmitted," 08:00")).format("YYYY-MM-DD[T]HH:mm[:00.000+00:00]")}}),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["updateDocument"])),{},{itIsWeekend:function(e){return"sábado"===le()(e).format("dddd")||"domingo"===le()(e).format("dddd")},save:function(){var e=this;this.loader=!0;var t=this.selectedDocument.documentation;t.push(this.setDocumentation("Servicio asignado a ".concat(this.schedule.technician.fullName,", fecha estimada de atención: ").concat(this.friendlyDate,"."))),this.updateDocument({collection:"Active",body:{_id:this.selectedDocument._id,documentation:t,schedule:{technician:this.schedule.technician,scheduledDate:this.formattedDate},status:"Atención programada"}}).then((function(){return e.$emit("hideInterface")})).catch((function(){return e.loader=!1}))},setDocumentation:function(e){return{type:"Asignado",observations:e,status:"En programación"===this.selectedDocument.status?"Atención programada":this.selectedDocument.status,date:"",author:this.formOptions.user,technician:this.schedule.technician,updatedAt:le()(Date.now()).format()}}}),watch:{dateSubmitted:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("dddd, DD [de] MMMM"))}}}),$e=Me,Pe=a("c6a6"),Te=a("4bd4"),Re=a("8654"),Ae=Object(v["a"])($e,xe,_e,!1,null,null,null),qe=Ae.exports;b()(Ae,{VAutocomplete:Pe["a"],VBtn:j["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VRow:T["a"],VTextField:Re["a"]});var Ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información del servicio"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-card",[a("v-card-text",[a("v-form",{ref:"maintenanceForm",model:{value:e.maintenanceForm,callback:function(t){e.maintenanceForm=t},expression:"maintenanceForm"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-switch",{attrs:{disabled:void 0!==e.editing,label:"Ocultar clientes inactivos"},model:{value:e.hideInactiveClients,callback:function(t){e.hideInactiveClients=t},expression:"hideInactiveClients"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-autocomplete",{attrs:{disabled:void 0!==e.editing,items:e.formLists.clientNames,rules:e.rules.required,label:"Cliente"},model:{value:e.serviceForm.clientName,callback:function(t){e.$set(e.serviceForm,"clientName",t)},expression:"serviceForm.clientName"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-switch",{attrs:{label:"Ocultar oficinas atendidas"},model:{value:e.hideVisitedOffices,callback:function(t){e.hideVisitedOffices=t},expression:"hideVisitedOffices"}})],1),a("v-col",[a("v-autocomplete",{attrs:{items:e.formLists.clientOfficeNames,rules:e.rules.required,disabled:!e.serviceForm.clientName,label:"Oficina"},model:{value:e.serviceForm.officeName,callback:function(t){e.$set(e.serviceForm,"officeName",t)},expression:"serviceForm.officeName"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:5}},[a("v-autocomplete",{attrs:{items:e.formOptions.technicians,rules:e.rules.required,label:"Personal asignado"},model:{value:e.technician,callback:function(t){e.technician=t},expression:"technician"}})],1),a("v-col",{attrs:{cols:e.mobile?3:2}},[a("DateMenu",{on:{setDate:function(t){return e.dateSubmitted=t}}})],1),a("v-col",{attrs:{cols:e.mobile?9:5}},[a("v-text-field",{attrs:{label:"Fecha estimada de atención",readonly:"",rules:e.rules.required,"error-messages":e.itIsWeekend(e.dateSubmitted)?"Seleccione un día de la semana":""},model:{value:e.friendlyDate,callback:function(t){e.friendlyDate=t},expression:"friendlyDate"}})],1)],1),a("v-row",[a("v-col",[a("v-btn",{attrs:{color:"success",block:"",disabled:!e.maintenanceForm,loading:e.loader},on:{click:function(t){return e.save(e.serviceForm)}}},[e._v(" Registrar ")])],1)],1)],1)],1)],1)],1)},Le=[],He=a("1da1");a("96cf"),a("7db0");le.a.locale("es");var Be=n["a"].extend({name:"MaintenanceForm",components:{Header:ce,DateMenu:Ne},props:["pendingMaintenance","collections","mobile","editing","startTemplate"],data:function(){return{maintenanceForm:!1,datePicker:!1,hideVisitedOffices:!0,hideInactiveClients:!0,serviceForm:{clientName:"",officeName:""},technician:null,dateSubmitted:(new Date).toISOString().substr(0,10),loader:!1,friendlyDate:"",rules:Ie["rules"]}},created:function(){this.startTemplate&&(this.serviceForm=Object.assign({},this.startTemplate)),this.editing&&(this.serviceForm=Object.assign({},this.editing),this.technician=this.editing.schedule.technician,this.dateSubmitted=le()(this.editing.serviceDate).parseZone("America/Caracas").format("YYYY-MM-D")),this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM"))},computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),{},{formLists:function(){var e=this,t=this.hideInactiveClients?this.formOptions.clientsWithContract.map((function(e){return e.clientName})):this.collections.Client.map((function(e){return e.clientName})),a=this.hideVisitedOffices?this.formOptions.pendingMaintenance:this.collections.Office,n=this.serviceForm.clientName?a.filter((function(t){return t.clientName===e.serviceForm.clientName})):[],i=n!==[]?n.map((function(e){return e.officeName})):[],r=this.serviceForm.officeName?this.collections.Office.find((function(t){return t.officeName===e.serviceForm.officeName})):{};return console.log(r),{clientNames:t,clientOfficeNames:i,officeInfo:r}}}),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","updateDocument","findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{itIsWeekend:function(e){return"sábado"===le()(e).format("dddd")||"domingo"===le()(e).format("dddd")},preventDuplicity:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i,r,o,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.clientName,i=e.officeName,r=t.editing?t.editing._id:null,o={clientName:n,officeName:i,$or:[{status:"Asignado"},{status:"Culminado"},{status:"Por culminar"}],_id:{$ne:r}},a.next=5,t.findDocuments({collection:"Maintenance",filter:o});case 5:if(c=a.sent,console.log(c),c.length){a.next=11;break}return a.abrupt("return",!1);case 11:return a.abrupt("return",(t.showSnackbar({error:"Registrado anteriormente, verifique por cliente y oficina"}),!0));case 12:case"end":return a.stop()}}),a)})))()},save:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loader=!0,a.next=3,t.preventDuplicity(e);case 3:if(n=a.sent,!n){a.next=6;break}return a.abrupt("return",t.loader=!1);case 6:if(console.log(n),i=t.completeFields(e),!t.editing){a.next=12;break}return a.abrupt("return",t.update({collection:"Maintenance",body:i}));case 12:t.create({collection:"Maintenance",body:i});case 13:case"end":return a.stop()}}),a)})))()},completeFields:function(e){return e.schedule={scheduledDate:this.dateSubmitted,technician:this.technician},e.officeRegion=this.formLists.officeInfo.region,e.officeState=this.formLists.officeInfo.officeState,e},update:function(e){var t=this;this.updateDocument(e).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},create:function(e){var t=this;this.createDocument(e).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))}}),watch:{dateSubmitted:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM"))}}}),Ye=Be,ze=a("b73d"),Ge=Object(v["a"])(Ye,Ee,Le,!1,null,null,null),Ue=Ge.exports;b()(Ge,{VAutocomplete:Pe["a"],VBtn:j["a"],VCard:N["a"],VCardText:pe["c"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VRow:T["a"],VSwitch:ze["a"],VTextField:Re["a"]});var Qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Actualización",subtitle:e.updating.officeName+" - Mantenimiento"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-card",[a("v-card-text",[a("v-form",{ref:"maintenanceForm",model:{value:e.maintenanceForm,callback:function(t){e.maintenanceForm=t},expression:"maintenanceForm"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?7:3}},[a("v-text-field",{attrs:{rules:e.inventorySlot.serviceOrder?e.rules.serviceOrder:[],label:"#Orden",maxlength:6},model:{value:e.inventorySlot.serviceOrder,callback:function(t){e.$set(e.inventorySlot,"serviceOrder",t)},expression:"inventorySlot.serviceOrder"}})],1),a("v-col",{attrs:{cols:e.mobile?5:2}},[a("v-text-field",{attrs:{label:"Cantidad",type:"number"},model:{value:e.inventorySlot.quantity,callback:function(t){e.$set(e.inventorySlot,"quantity",t)},expression:"inventorySlot.quantity"}})],1)],1),a("v-row",{attrs:{justify:"space-between"}},[a("v-col",{attrs:{cols:e.mobile?10:9}},[a("v-select",{attrs:{items:e.formLists.clientProducts,label:"Producto(s)"},model:{value:e.inventorySlot.productType,callback:function(t){e.$set(e.inventorySlot,"productType",t)},expression:"inventorySlot.productType"}})],1),a("v-col",{attrs:{cols:e.mobile?12:3}},[a("v-btn",{attrs:{block:e.mobile,small:"",color:"secondary"},on:{click:function(t){return e.attachOrder(e.inventorySlot)}}},[a("v-icon",[e._v("mdi-plus")])],1)],1)],1),a("v-row",[a("v-col",[a("v-chip-group",e._l(e.serviceOrders,(function(t,n){return a("v-tooltip",{key:n,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var i=n.on;return[a("v-chip",e._g({attrs:{close:"",color:"accent",small:""},on:{"click:close":function(a){return e.removeOrder(t)}}},i),[e._v(" "+e._s(t)+" ")])]}}],null,!0)},[e._v(" "+e._s(e.orderInfo(t).productType)+" ("+e._s(e.orderInfo(t).quantity)+") ")])})),1)],1)],1),a("v-row",{attrs:{justify:"space-between",align:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-autocomplete",{attrs:{items:e.formOptions.technicians,rules:e.rules.required,label:"Personal asignado",solo:""},model:{value:e.serviceForm.schedule.technician,callback:function(t){e.$set(e.serviceForm.schedule,"technician",t)},expression:"serviceForm.schedule.technician"}})],1),a("v-col",{attrs:{cols:(e.mobile,2)}},[a("DateMenu",{on:{setDate:function(t){return e.dateSubmitted=t}}})],1),a("v-col",{attrs:{cols:e.mobile?8:4}},[a("v-text-field",{attrs:{label:"Fecha de atención",rules:e.rules.required,readonly:"","error-messages":e.itIsWeekend(e.dateSubmitted)?"Seleccione un día de la semana":""},model:{value:e.friendlyDate,callback:function(t){e.friendlyDate=t},expression:"friendlyDate"}})],1)],1),a("v-row",[a("v-col",[a("v-select",{attrs:{items:e.maintenanceStatus,label:"Status",rules:e.rules.required},model:{value:e.serviceForm.status,callback:function(t){e.$set(e.serviceForm,"status",t)},expression:"serviceForm.status"}})],1)],1),a("v-row",[a("v-col",[a("v-btn",{attrs:{color:"success",disabled:!e.maintenanceForm,loading:e.loader,block:""},on:{click:function(t){return e.save(e.serviceForm)}}},[e._v(" Registrar ")])],1)],1)],1)],1)],1)],1)},Xe=[];a("d3b7"),a("6062"),a("3ca3"),a("ddb0");le.a.locale("es");var We=n["a"].extend({name:"MaintenanceUpdate",components:{Header:ce,DateMenu:Ne},props:["collections","mobile","updating"],data:function(){return{maintenanceForm:!1,datePicker:!1,serviceForm:{},inventorySlot:{serviceOrder:"",quantity:0,productType:"",status:""},maintenanceStatus:Ie["maintenanceStatus"],technician:{},dateSubmitted:(new Date).toISOString().substr(0,10),loader:!1,friendlyDate:"",rules:Ie["rules"]}},created:function(){this.serviceForm=Object.assign({},this.updating),this.serviceForm.status="",this.dateSubmitted=this.serviceForm.schedule.scheduledDate,this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM"))},computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),{},{formLists:function(){var e=this,t=this.serviceForm.clientName?this.collections.Client.find((function(t){return t.clientName===e.serviceForm.clientName})):{},a=t.contracts.find((function(e){return e.active})),n=a?a.products.map((function(e){return e.productType})):this.collections.Product.map((function(e){return e.productType}));return{clientInfo:t,clientProducts:n}},serviceOrders:function(){var e=this.serviceForm.inventory.map((function(e){return e.serviceOrder}));return e=new Set(Object(J["a"])(e)),e}}),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","updateDocument"])),{},{attachOrder:function(e){var t=e.productType,a=e.serviceOrder,n=e.quantity,i=this.serviceForm,r=i.clientName,o=i.officeName,c=i.officeRegion,s=i.officeState,l=i.schedule,u=0;while(u<n)this.serviceForm.inventory.push({clientName:r,officeName:o,officeState:s,officeRegion:c,location:"",observations:"",productType:t,productName:"",serialCode:"",schedule:l,serviceOrder:a,status:""}),u++;this.inventorySlot={}},itIsWeekend:function(e){return"sábado"===le()(e).format("dddd")||"domingo"===le()(e).format("dddd")},removeOrder:function(e){var t=this.serviceForm.inventory.filter((function(t){return t.serviceOrder!==e}));this.serviceForm.inventory=t},orderInfo:function(e){var t=this.serviceForm.inventory.filter((function(t){return t.serviceOrder===e})),a=t[0].productType,n=t.length;return{productType:a,quantity:n}},save:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.loader=!0,e.schedule.scheduledDate=t.dateSubmitted,e.finished="Culminado"===e.status,t.updateDocument({collection:"Maintenance",body:e}).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}));case 4:case"end":return a.stop()}}),a)})))()}}),watch:{dateSubmitted:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM"))}}}),Ze=We,Je=a("cc20"),Ke=a("ef9a"),et=a("b974"),tt=Object(v["a"])(Ze,Qe,Xe,!1,null,null,null),at=tt.exports;b()(tt,{VAutocomplete:Pe["a"],VBtn:j["a"],VCard:N["a"],VCardText:pe["c"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VIcon:g["a"],VRow:T["a"],VSelect:et["a"],VTextField:Re["a"],VTooltip:Fe["a"]});var nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Servicio "+e.selectedDocument.reportCode,subtitle:"Serial "+e.selectedDocument.serialCode+", Oficina "+e.selectedDocument.officeName},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-stepper",{attrs:{vertical:""},model:{value:e.activeStep,callback:function(t){e.activeStep=t},expression:"activeStep"}},[a("v-stepper-step",{attrs:{step:"1",editable:"",complete:e.step1Completed}},[e._v(" Observaciones ")]),a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{ref:"step1Completed",model:{value:e.step1Completed,callback:function(t){e.step1Completed=t},expression:"step1Completed"}},[a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-radio-group",{staticClass:"ml-2",attrs:{row:""},model:{value:e.documentation.visit,callback:function(t){e.$set(e.documentation,"visit",t)},expression:"documentation.visit"}},e._l(["Visita","Seguimiento"],(function(e,t){return a("v-radio",{key:t,attrs:{label:e,value:"Visita"===e}})})),1)],1),a("v-col",{attrs:{cols:e.mobile?7:3}},[a("v-text-field",{attrs:{rules:this.documentation.visit||this.documentation.serviceOrder.number?e.rules.serviceOrder:[],maxlength:6,hint:e.documentation.visit?"Requerido":"Opcional","persistent-hint":"",label:"#Orden"},model:{value:e.documentation.serviceOrder.number,callback:function(t){e.$set(e.documentation.serviceOrder,"number",t)},expression:"documentation.serviceOrder.number"}})],1)],1),a("v-textarea",{staticClass:"mt-1",attrs:{rules:e.rules.required,maxlength:400,outlined:"",counter:"",label:"Observaciones"},model:{value:e.documentation.observations,callback:function(t){e.$set(e.documentation,"observations",t)},expression:"documentation.observations"}}),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-autocomplete",{attrs:{items:e.statusOptions,rules:e.rules.required,solo:"",label:"Status"},model:{value:e.documentation.status,callback:function(t){e.$set(e.documentation,"status",t)},expression:"documentation.status"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},["Cerrado - Reemplazado"===e.documentation.status?a("v-text-field",{attrs:{rules:e.rules.required,label:"#Serial (Equipo instalado)"},model:{value:e.documentation.newSerial,callback:function(t){e.$set(e.documentation,"newSerial",t)},expression:"documentation.newSerial"}}):e._e()],1)],1)],1),a("v-row",{staticClass:"pa-2"},[a("v-col",[a("v-btn",{attrs:{color:"primary",text:"",block:"",disabled:!e.step1Completed},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")])],1)],1)],1),a("v-stepper-step",{attrs:{step:"2",editable:e.step1Completed,complete:e.step2Completed}},[e._v(" Solicite el envío de piezas ")]),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"step2Completed",model:{value:e.step2Completed,callback:function(t){e.step2Completed=t},expression:"step2Completed"}},[e._l(e.suggestions,(function(t,n){return a("v-chip-group",{key:t+" ("+n+")",attrs:{row:""}},e._l(t.value,(function(t,n){return a("v-chip",{key:n,attrs:{small:""},on:{click:function(a){return e.acceptSuggestion(t)}}},[e._v(" "+e._s(t)+" ")])})),1)})),a("v-row",[a("v-col",[a("v-autocomplete",{attrs:{items:e.piecesNames,disabled:!e.piecesNames.length,"menu-props":{nudgeRight:150},"hide-no-data":"",label:"Piezas requeridas","error-messages":e.requiresAssignement,multiple:"","deletable-chips":"","small-chips":"","prepend-inner-icon":"mdi-clipboard-list-outline"},model:{value:e.selectedPieces,callback:function(t){e.selectedPieces=t},expression:"selectedPieces"}})],1)],1),e._l(e.assembledRequests,(function(t,n){return a("v-row",{key:n},[a("v-col",{attrs:{cols:e.mobile?9:10}},[a("v-select",{attrs:{items:e.replacementOptions,rules:e.rules.required,hint:"Causa de reemplazo: "+t.pieceName,"prepend-inner-icon":"mdi-account-question-outline",label:"Causa del reemplazo","persistent-hint":"",solo:""},model:{value:e.replacementCauses[n],callback:function(t){e.$set(e.replacementCauses,n,t)},expression:"replacementCauses[index]"}})],1),a("v-col",{attrs:{cols:e.mobile?3:2}},[a("v-text-field",{attrs:{type:"number",value:"1",min:"1",solo:""},model:{value:t.quantity,callback:function(a){e.$set(t,"quantity",a)},expression:"request.quantity"}})],1)],1)})),a("v-row",{staticClass:"pa-2"},[a("v-col",[e.documentation.visit?a("v-btn",{attrs:{disabled:!e.step1Completed||!e.step2Completed,color:"primary",text:"",block:""},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")]):a("v-btn",{attrs:{disabled:!e.step1Completed||!e.step2Completed,loading:e.loader,color:"primary",text:"",block:""},on:{click:e.save}},[e._v(" Actualizar ")])],1)],1)],2)],1),e.documentation.visit?a("v-stepper-step",{attrs:{step:"3",editable:e.step2Completed,complete:e.step3Completed}},[e._v(" Indique los datos de la visita ")]):e._e(),e.documentation.visit?a("v-stepper-content",{attrs:{step:"3"}},[a("v-form",{ref:"step3Completed",model:{value:e.step3Completed,callback:function(t){e.step3Completed=t},expression:"step3Completed"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?6:4}},[a("DateMenu",{on:{setDate:function(t){return e.dateSubmitted=t}}})],1),a("v-col",{attrs:{cols:e.mobile?6:4}},[a("TimeMenu",{on:{setTime:function(t){return e.timeSubmitted=t}}})],1),a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-text-field",{attrs:{rules:e.rules.required,"error-messages":e.itIsWeekend(e.dateSubmitted)?"Seleccione un día de la semana":"",readonly:"",label:"Fecha de visita"},model:{value:e.friendlyDate,callback:function(t){e.friendlyDate=t},expression:"friendlyDate"}}),a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{rules:e.rules.required},model:{value:e.timeSubmitted,callback:function(t){e.timeSubmitted=t},expression:"timeSubmitted"}})],1)],1),a("v-row",[a("v-col",[a("v-autocomplete",{attrs:{items:e.formOptions.technicians,hint:"Requerido",rules:e.rules.required,label:"Personal asignado","persistent-hint":"",solo:""},model:{value:e.documentation.technician,callback:function(t){e.$set(e.documentation,"technician",t)},expression:"documentation.technician"}})],1)],1),a("v-row",{staticClass:"pa-2"},[a("v-col",[a("v-btn",{attrs:{color:"success",disabled:!e.step1Completed||!e.step2Completed||!e.step3Completed||!e.documentation.technician._id,loading:e.loader,block:""},on:{click:e.save}},[e._v(" Actualizar ")])],1)],1)],1)],1):e._e()],1)],1)},it=[],rt=(a("caad"),a("2532"),a("4e827"),a("ac1f"),a("1276"),a("466d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.timeSubmitted,"max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){e.timeSubmitted=t},"update:return-value":function(t){e.timeSubmitted=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ma-1",attrs:{outlined:!e.timeSubmitted,color:e.timeSubmitted?"primary":"error",small:""}},"v-btn",i,!1),n),[a("v-icon",[e._v("mdi-clock-time-four-outline")])],1)]}}]),model:{value:e.timePicker,callback:function(t){e.timePicker=t},expression:"timePicker"}},[e.timePicker?a("v-time-picker",{attrs:{"allowed-hours":function(e){return e<17&&e>7},"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menu.save(e.timeSubmitted)}},model:{value:e.timeSubmitted,callback:function(t){e.timeSubmitted=t},expression:"timeSubmitted"}}):e._e()],1)],1)}),ot=[],ct={name:"TimeMenu",props:[],data:function(){return{timePicker:!1,timeSubmitted:""}},watch:{timeSubmitted:function(){this.$emit("setTime",this.timeSubmitted)}}},st=ct,lt=a("c964"),ut=Object(v["a"])(st,rt,ot,!1,null,null,null),dt=ut.exports;b()(ut,{VBtn:j["a"],VContainer:h["a"],VIcon:g["a"],VMenu:P["a"],VTimePicker:lt["a"]}),le.a.locale("es");var mt=n["a"].extend({name:"CorrectiveUpdate",components:{Header:ce,DateMenu:Ne,TimeMenu:dt},props:["mobile","selectedDocument"],data:function(){return{replacementOptions:Ie["replacementOptions"],statusOptions:Ie["statusOptions"],rules:Ie["rules"],activeStep:1,step1Completed:!1,step2Completed:!1,step3Completed:!1,documentation:{author:"",date:"",observations:"",newSerial:"",serviceOrder:{number:"",validated:!1},status:"",technician:{fullName:"",id:""},type:"Actualizado",updatedAt:le()(Date.now()).format(),visit:!0},replacementCauses:[],selectedPieces:[],pieces:[],dateSubmitted:(new Date).toISOString().substr(0,10),timeSubmitted:"",loader:!1,friendlyDate:"",suggestions:[{key:"pieceNames",value:[]}]}},created:function(){this.documentation.technician=this.selectedDocument.schedule.technician},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections"])),Object(l["c"])(["formOptions"])),{},{piecesNames:function(){var e=this,t=function(t){return t.asociatedProducts.includes(e.selectedDocument.productName)},a=this.collections.Piece.filter((function(e){return e.asociatedProducts.length}));a=this.collections.Piece.filter(t);var n=a.map((function(e){return e.pieceName})).sort();return n},requiresAssignement:function(){var e=this.selectedPieces.length,t=this.documentation.technician._id,a=this.documentation.visit;return e?a||!e||t||a?"":"Asigne un responsable para realizar solicitudes":""},assembledRequests:function(){var e=[];for(var t in this.selectedPieces){var a=this.selectedDocument,n=a.clientName,i=a.officeName,r=a.productName,o=a.productType,c=a.reportCode,s=a.serialCode;e[t]={clientName:n,officeName:i,productName:r,productType:o,reportCode:c,serialCode:s,pieceName:this.selectedPieces[t],replacementCause:"Indefinida",requestDate:le()(Date.now()).format(),requestedBy:this.formOptions.user,requestStatus:"Enviada a Almacén",technician:this.documentation.technician,quantity:1}}return e}}),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","updateDocument","deleteDocument"])),{},{itIsWeekend:function(e){var t=le()(e).format("dddd");return"sábado"===t||"domingo"===t},acceptSuggestion:function(e){this.selectedPieces.push(e)},findSuggestions:function(e,t,a){if(e&&!(e.length<3)){var n=e.split(" ");n=n.filter((function(e){return e.length>3}));var i,r=this.suggestions.find((function(e){return e.key===t})),o=Object(Z["a"])(a);try{var c=function(){var e,t=i.value,a=Object(Z["a"])(n);try{for(a.s();!(e=a.n()).done;){var o=e.value,c=t.toLowerCase().match(o.toLowerCase()),s=r.value.find((function(e){return e===t}));c&&!s&&r.value.push(t)}}catch(l){a.e(l)}finally{a.f()}};for(o.s();!(i=o.n()).done;)c()}catch(s){o.e(s)}finally{o.f()}}},save:function(){this.loader=!0,this.assembledRequests.length&&this.requestPieces();var e=this.consolidateBody();if(this.documentation.status.includes("Cerrado"))return this.closeService(e);this.update(e)},closeService:function(e){var t=this;this.createDocument({collection:"Closed",body:e}).then((function(){return t.deleteDocument({collection:"Active",body:e})})).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},update:function(e){var t=this;this.updateDocument({collection:"Active",body:e}).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},consolidateBody:function(){var e=Object.assign({},this.selectedDocument);this.documentation.date=le()("".concat(this.dateSubmitted," ").concat(this.timeSubmitted)).format("YYYY-MM-DD[T]HH:mm[:00.000+00:00]");var t=le()(this.selectedDocument.expireDate).diff(new Date,"minutes"),a=t<0;if(e.documentation.push(this.documentation),e.status=this.documentation.status,e.expired=a,this.documentation.visit&&(e.schedule.technician=this.documentation.technician),this.documentation.visit&&(e.schedule.scheduledDate=this.documentation.date),this.assembledRequests.length){var n,i=Object(Z["a"])(this.assembledRequests);try{for(i.s();!(n=i.n()).done;){var r=n.value;e.pieces.push({pieceName:r.pieceName,quantity:r.quantity})}}catch(o){i.e(o)}finally{i.f()}}return this.documentation.author=this.formOptions.user,e},requestPieces:function(){var e,t=[],a=Object(Z["a"])(this.assembledRequests);try{for(a.s();!(e=a.n()).done;){var n=e.value,i=0;do{i++,t.push(this.createDocument({collection:"Request",body:n}))}while(i<n.quantity)}}catch(r){a.e(r)}finally{a.f()}}}),watch:{activeStep:function(){2===this.activeStep&&this.findSuggestions(this.documentation.observations,"pieceNames",this.piecesNames)},timeSubmitted:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM,")," ").concat(this.timeSubmitted)},dateSubmitted:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM,")," ").concat(this.timeSubmitted)}}}),ft=mt,vt=a("67b6"),pt=a("43a6"),bt=a("7e85"),ht=a("e516"),gt=a("56a4"),yt=a("a844"),Ct=Object(v["a"])(ft,nt,it,!1,null,null,null),kt=Ct.exports;b()(Ct,{VAutocomplete:Pe["a"],VBtn:j["a"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VRadio:vt["a"],VRadioGroup:pt["a"],VRow:T["a"],VSelect:et["a"],VStepper:bt["a"],VStepperContent:ht["a"],VStepperStep:gt["a"],VTextField:Re["a"],VTextarea:yt["a"]});var xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("Header",{attrs:{closable:"1",title:"Documentación",subtitle:"Resumen e historial del servicio"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),n("v-card",{staticClass:"mx-auto",attrs:{elevation:"2"}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{align:"center"}},[n("v-avatar",{staticClass:"mb-2",attrs:{color:"secondary"}},[n("v-avatar",{attrs:{size:"90%",color:"white"}},[n("v-img",{attrs:{src:a("cbb6")}})],1)],1)],1)],1),n("v-divider"),n("v-row",[n("v-col",{attrs:{cols:e.mobile?12:6}},[n("v-card-title",[e._v("Servicio "+e._s(e.selectedDocument.reportCode))]),n("v-card-subtitle",[n("v-icon",{attrs:{small:""}},[e._v("mdi-tools")]),e._v(" "+e._s(e.selectedDocument.itsSpecial?"Especial":"Correctivo")+" ")],1),n("v-card-text",[n("div",{staticClass:"my-1 text-subtitle-2"},[n("v-icon",{attrs:{small:""}},[e._v("mdi-calendar-outline")]),e._v(" Reporte: "+e._s(e._f("friendlyDate")(e.selectedDocument.reportedAt))+" ")],1),n("div",{staticClass:"my-1 text-subtitle-2"},[n("v-icon",{attrs:{small:""}},[e._v("mdi-timer-outline")]),e._v(" Expira: "),e.selectedDocument.itsSpecial?n("span",[e._v("S. L. A. No aplicado")]):n("span",[e._v(e._s(e._f("friendlyDate")(e.selectedDocument.expireDate)))])],1),n("div",{staticClass:"my-1 text-subtitle-2"},[n("v-icon",{attrs:{small:""}},[e._v("mdi-cog")]),e._v(" Piezas solicitadas: "+e._s(e.selectedDocument.pieces.length)+" ")],1),n("v-chip",{attrs:{color:e.colorsXStatus[e.selectedDocument.status],label:"",dark:"",small:""}},[e._v(" "+e._s(e.selectedDocument.status)+" ")])],1)],1),n("v-col",{attrs:{cols:e.mobile?12:6,align:"end"}},[n("v-card-title",{staticClass:"justify-end"},[e._v(" "+e._s(e.selectedDocument.clientName)+" ")]),n("v-card-subtitle",[e._v(" "+e._s(e.selectedDocument.officeName)+" "),n("v-icon",{attrs:{small:""}},[e._v("mdi-bank")])],1),n("v-card-text",[n("div",{staticClass:"my-1 text-subtitle-2"},[e._v(" "+e._s(e.selectedDocument.productName)+" "),n("v-icon",{attrs:{small:""}},[e._v("mdi-printer")])],1),n("div",{staticClass:"my-1 text-subtitle-2"},[e._v(" "+e._s(e.selectedDocument.serialCode)+" "),n("v-icon",{attrs:{small:""}},[e._v("mdi-barcode")])],1),n("div",{staticClass:"my-1 text-subtitle-2"},[e._v(" "+e._s(e.selectedDocument.description)+" "),n("v-icon",{attrs:{small:""}},[e._v("mdi-comment-text-outline")])],1),n("v-chip",{attrs:{color:"secondary",label:"",small:""}},[e._v(" "+e._s(e.selectedDocument.schedule.technician.fullName)+" ")])],1)],1)],1)],1),n("v-row",{staticClass:"mt-10"},[n("v-col",[n("v-alert",{attrs:{type:"info",icon:"mdi-information-outline",rounded:"pill",text:""}},[e._v(" Acciones registradas ")]),n("v-timeline",{attrs:{"align-top":"",reverse:"",dense:e.mobile}},e._l(e.selectedDocument.documentation,(function(t,a){return n("v-timeline-item",{key:a,attrs:{"fill-dot":"",color:e.colorsXStatus[t.status],small:""}},[n("v-card",{staticClass:"elevation-2 my-1",attrs:{outlined:"",color:"#eee"}},[n("v-card-title",{staticClass:"text-h6 text-no-wrap"},[e._v(" "+e._s(t.type)+" ")]),n("v-card-text",{staticClass:"white text--primary"},[n("p",[e._v(" "+e._s(t.observations)+" ")])]),t.serviceOrder?n("v-container",[t.serviceOrder.number?n("section",[n("small",{staticClass:"caption text--secondary"},[t.visit?n("v-chip",{attrs:{color:"info",label:"","x-small":""}},[e._v(" Visita técnica ")]):e._e(),n("br"),t.technician?["No asignado"!==t.technician.fullName?n("v-chip",{attrs:{color:"info",label:"","x-small":""}},[e._v(" "+e._s(t.technician.fullName)+" ")]):e._e()]:e._e(),n("br"),t.visit?n("span",[e._v(" "+e._s(e._f("friendlyDate")(t.date))+" ")]):e._e(),n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:e.mobile?7:2}},[n("v-text-field",{attrs:{"prepend-inner-icon":"mdi-card-bulleted",maxLength:"6",rules:e.rules.serviceOrderRules,"persistent-hint":"",hint:t.serviceOrder.validated?"Validado":"No validado"},model:{value:t.serviceOrder.number,callback:function(a){e.$set(t.serviceOrder,"number",a)},expression:"documentation.serviceOrder.number"}})],1),n("v-col",{attrs:{cols:"2"}},[n("v-tooltip",{attrs:{color:t.serviceOrder.validated?"warning":"primary",top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var r=i.on;return[n("v-btn",e._g({attrs:{outlined:!t.serviceOrder.validated,color:t.serviceOrder.validated?"primary":"warning",loading:e.loader,small:"",disabled:e.$store.state.session.user.userRole>2},on:{click:function(t){return e.validateOrder(e.selectedDocument,a)}}},r),[n("v-icon",[e._v(" "+e._s(t.serviceOrder.validated?"mdi-check":"mdi-exclamation")+" ")])],1)]}}],null,!0)},[e._v(" "+e._s(t.serviceOrder.validated?"Invalidar":"Validar")+" ")])],1)],1)],2)]):e._e()]):e._e()],1),n("small",{staticClass:"caption ml-4 text--secondary lighten-2 lighten-1"},[n("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(a){var i=a.on;return[n("v-avatar",e._g({attrs:{color:"secondary",size:"20"}},i),[n("span",{staticClass:"white--text"},[e._v(e._s(e._f("initials")(t.author.fullName)))])])]}}],null,!0)},[e._v(" "+e._s(t.author.fullName)+" ")]),e._v(" | "+e._s(e._f("friendlyDate")(t.updatedAt))+" "),t.status?n("v-chip",{staticClass:"ml-1",attrs:{dark:"",color:e.colorsXStatus[t.status],label:"","x-small":""}},[e._v(" "+e._s(t.status)+" ")]):e._e()],1)],1)})),1)],1)],1)],1)},_t=[];le.a.locale("es");var Dt=n["a"].extend({name:"CorrectiveInfo",components:{Header:ce},props:["selectedDocument","mobile"],data:function(){return{rules:Ie["rules"],loader:!1,selection:1}},filters:{friendlyDate:function(e){return le()(e).parseZone("America/Caracas").format("DD/MM/YYYY HH:mm")},initials:function(e){var t=e.split(" ");return t[0][0]+t[1][0]}},computed:{assignedTo:function(){var e=this.selectedDocument.documentation.filter((function(e){return e.technician}));return console.log(e),e.length?e.pop().technician.fullName:"No asignado"},colorsXStatus:function(){return{"Cerrado - Operativo":this.$vuetify.theme.currentTheme.success,"Cerrado - Reemplazado":this.$vuetify.theme.currentTheme.info,"Cerrado - Desincorporado":this.$vuetify.theme.currentTheme.secondary,"Pendiente - Por repuestos":this.$vuetify.theme.currentTheme.warning,"En programación":this.$vuetify.theme.currentTheme.error,"Atención programada":this.$vuetify.theme.currentTheme.accent}}},methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["updateDocument"])),{},{validateOrder:function(e,t){var a=this;this.loader=!0,e.documentation[t].serviceOrder.validated=!e.documentation[t].serviceOrder.validated,this.updateDocument({collection:e.status.includes("Cerrado")?"Closed":"Active",body:e}).finally((function(){return a.loader=!1}))}})}),wt=Dt,Ot=a("8414"),St=a("1e06"),Vt=Object(v["a"])(wt,xt,_t,!1,null,null,null),Ft=Vt.exports;b()(Vt,{VAlert:ne["a"],VAvatar:F["a"],VBtn:j["a"],VCard:N["a"],VCardSubtitle:pe["b"],VCardText:pe["c"],VCardTitle:pe["d"],VChip:Je["a"],VCol:I["a"],VContainer:h["a"],VDivider:M["a"],VIcon:g["a"],VImg:$["a"],VRow:T["a"],VTextField:Re["a"],VTimeline:Ot["a"],VTimelineItem:St["a"],VTooltip:Fe["a"]});var jt={props:["result","xlsFormat","mobile"],name:"QueryResult",components:{CorrectiveSchedule:qe,CorrectiveUpdate:kt,CorrectiveInfo:Ft,MaintenanceUpdate:at,MaintenanceForm:Ue},data:function(){return{scheduleInterface:!1,scheduleMaintenanceInterface:!1,updateMaintenanceInterface:!1,updateInterface:!1,detailsInterface:!1,tableFilter:"",headers:[{text:"Cliente",value:"clientName"},{text:"Oficina",value:"officeName"},{text:"Servicio",value:"serviceType"},{text:"Técnico",value:"schedule.technician.fullName"},{text:"Status",value:"status"},{text:"Acciones",value:"actions"}],reportsMenu:[{action:"details",title:"Detalles",icon:"mdi-information-outline"},{action:"schedule",title:"Re-asignar",icon:"mdi-account-arrow-left"},{action:"update",title:"Actualizar",icon:"mdi-file-refresh-outline"}],maintenanceMenu:[{action:"scheduleMaintenance",title:"Re-asignar",icon:"mdi-account-arrow-left"},{action:"updateMaintenance",title:"Actualizar",icon:"mdi-file-refresh-outline"}],dialog:!1,selectedDocument:{}}},computed:Object(o["a"])({},Object(l["e"])(["collections"])),filters:{friendlyDate:function(e){return le()(e).parseZone("America/Caracas").format("DD [de] MMMM, HH:mm")},serviceType:function(e){var t="Preventivo";switch(e.itsSpecial){case!0:t="Especial";break;case!1:t=e.reportCode;break;default:break}return t}},methods:{hideInterface:function(e){this.selectedDocument={},this.dialog=!1,this["".concat(e,"Interface")]=!1},showDialog:function(e,t){this.selectedDocument=Object.assign({},t),this.dialog=!0,this["".concat(e,"Interface")]=!0}}},Nt=jt,It=a("8fea"),Mt=a("169a"),$t=a("1baa"),Pt=Object(v["a"])(Nt,Ce,ke,!1,null,null,null),Tt=Pt.exports;b()(Pt,{VBtn:j["a"],VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDataTable:It["a"],VDialog:Mt["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemContent:k["a"],VListItemGroup:$t["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VMenu:P["a"],VRow:T["a"],VTextField:Re["a"]});var Rt={name:"DashboardCard",components:{QueryResult:Tt,Header:ce},props:["cardInfo","mobile"],data:function(){return{bottomSheet:!1}},methods:{showBottomSheet:function(){this.bottomSheet=!0}}},At=Rt,qt=a("288c"),Et=Object(v["a"])(At,ge,ye,!1,null,null,null),Lt=Et.exports;b()(Et,{VBottomSheet:qt["a"],VBtn:j["a"],VCard:N["a"],VCardSubtitle:pe["b"],VCardText:pe["c"],VCardTitle:pe["d"],VCol:I["a"],VContainer:h["a"],VIcon:g["a"],VImg:$["a"],VRow:T["a"]});var Ht={name:"Dashboard",components:{Header:ce,DashboardCard:Lt,QueryResult:Tt,Graph:he},data:function(){return{showTodays:!0}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections","loading"])),Object(l["c"])(["formOptions"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},cards:function(){return[{data:this.nextToExpire,title:"Próximos a vencer",icon:a("fd1c")},{data:this.collections.Closed,title:"Cerrados - ".concat(le()(new Date).format("MMMM")),icon:a("fe3c")},{data:this.expiredServices,title:"Fuera del acuerdo",icon:a("c7d4")}]},today:function(){return le()(new Date).format("dddd")},nextWorkingDay:function(){var e=1;return"viernes"===this.today&&(e=3),"sábado"===this.today&&(e=2),le()(new Date).add(e,"days").format("dddd")},todaySchedule:function(){var e=function(e){return le()(e.schedule.scheduledDate).parseZone("America/Caracas").format("D-M-yy")===le()(new Date).format("D-M-yy")},t=[].concat(Object(J["a"])(this.collections.Active),Object(J["a"])(this.collections.Closed),Object(J["a"])(this.collections.Maintenance)),a=t.filter(e);return a},nextDaySchedule:function(){var e=1;"viernes"===this.today&&(e=3),"sábado"===this.today&&(e=2);var t=function(t){return le()(t.schedule.scheduledDate).parseZone("America/Caracas").format("D-M-yy")===le()(new Date).add(e,"days").format("D-M-yy")},a=[].concat(Object(J["a"])(this.collections.Active),Object(J["a"])(this.collections.Closed),Object(J["a"])(this.collections.Maintenance)),n=a.filter(t);return n},nextToExpire:function(){var e=this.collections.Active.filter((function(e){return!e.itsSpecial})),t=e.filter((function(e){return le()(e.expireDate).diff(new Date,"hours")<15&&le()(e.expireDate).diff(new Date,"hours")>-1}));return t},expiredServices:function(){return this.collections.Closed.filter((function(e){return e.expired}))},thisMonth:function(){return le()(new Date).format("MMMM")},corrective:function(){return[].concat(Object(J["a"])(this.collections.Active),Object(J["a"])(this.collections.Closed))},servicesXClient:function(){var e,t=this,a="bar",n={},i={labels:this.formOptions.clients.map((function(e){return e.clientName})),datasets:[{label:"Correctivo",data:[],backgroundColor:this.$vuetify.theme.currentTheme.primary},{label:"Preventivo",data:[],backgroundColor:this.$vuetify.theme.currentTheme.accent}]},r=Object(Z["a"])(this.formOptions.clients);try{var o=function(){var a=e.value,n=function(e){return e.clientName===a.clientName};i.datasets[0].data.push(t.corrective.filter(n).length)};for(r.s();!(e=r.n()).done;)o()}catch(u){r.e(u)}finally{r.f()}var c,s=Object(Z["a"])(this.formOptions.clients);try{var l=function(){var e=c.value,a=function(t){return t.clientName===e.clientName};i.datasets[1].data.push(t.finishedMaint.filter(a).length)};for(s.s();!(c=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}return{type:a,data:i,options:n}},servicesXTechnician:function(){var e,t=this,a="line",n={},i={labels:this.formOptions.technicians.map((function(e){return e.text})),datasets:[{label:"Correctivo",data:[],backgroundColor:this.$vuetify.theme.currentTheme.primary},{label:"Preventivo",data:[],backgroundColor:this.$vuetify.theme.currentTheme.accent}]},r=Object(Z["a"])(this.formOptions.technicians);try{var o=function(){var a=e.value,n=function(e){return e.schedule.technician.fullName===a.text};i.datasets[0].data.push(t.corrective.filter(n).length)};for(r.s();!(e=r.n()).done;)o()}catch(u){r.e(u)}finally{r.f()}var c,s=Object(Z["a"])(this.formOptions.technicians);try{var l=function(){var e=c.value,a=function(t){return t.inventory.filter((function(t){return t.schedule.technician.fullName===e.text})).length};i.datasets[1].data.push(t.finishedMaint.filter(a).length)};for(s.s();!(c=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}return{type:a,data:i,options:n}},finishedMaint:function(){var e=new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),t=new Date((new Date).getFullYear(),(new Date).getMonth(),1),a=function(t){return le()(t.lastMaintenance).parseZone("America/Caracas").isAfter(e)},n=function(e){return le()(e.lastMaintenance).parseZone("America/Caracas").isBefore(t)},i=this.collections.Office.filter((function(e){return a(e)&&n(e)}));return i}})},Bt=Ht,Yt=a("8dd9"),zt=Object(v["a"])(Bt,X,W,!1,null,null,null),Gt=zt.exports;b()(zt,{VAlert:ne["a"],VCard:N["a"],VCardTitle:pe["d"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VIcon:g["a"],VRow:T["a"],VSheet:Yt["a"],VSkeletonLoader:ie["a"]});var Ut=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Mantenimiento correctivo",subtitle:"Bandeja de servicios activos"}}),a("v-row",{attrs:{justify:"space-between"}},[a("v-col",{attrs:{cols:e.mobile?12:8}},[e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):e._e(),e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):a("CorrectivePanels",{attrs:{mobile:e.mobile,collections:e.collections,orderedServices:e.orderedServices},on:{searchRelated:function(t){return e.searchRelated(t,e.notifyAnyway=!0)}}})],1),a("v-col",{attrs:{cols:e.mobile?12:4}},[e.loading?a("v-sheet",{staticClass:"pa-3"},[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{"max-width":"300",type:"card"}})],1):a("Graph",{attrs:{id:"correctiveGraph1",loading:e.loading,chartData:e.servicesXStatus,title:"Estatus de servicios",subtitle:"Mantenimiento correctivo - "+e.thisMonth}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[e.loading?a("v-sheet",{staticClass:"pa-3"},[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{"max-width":"300",type:"card"}})],1):a("Graph",{attrs:{id:"correctiveGraph2",loading:e.loading,chartData:e.servicesXClient,title:"Servicios por cliente",subtitle:"Mantenimiento correctivo - "+e.thisMonth}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[e.loading?a("v-sheet",{staticClass:"pa-3"},[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{"max-width":"300",type:"card"}})],1):a("Graph",{attrs:{id:"correctiveGraph3",loading:e.loading,chartData:e.servicesXTechnician,title:"Servicios por técnico",subtitle:"Mantenimiento correctivo - "+e.thisMonth}})],1)],1),a("MainButton",{attrs:{loading:e.loading},on:{showForm:function(t){e.dialog=!0}}}),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.dialog?a("CorrectiveForm",{attrs:{mobile:e.mobile,collections:e.collections},on:{hideInterface:function(t){e.dialog=!1},searchRelated:e.searchRelated}}):e._e()],1)],1),a("v-snackbar",{attrs:{dark:"",outlined:"",timeout:2e3,rounded:"pill",centered:"",transition:"fab-transition"},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",[a("span",{staticClass:"white--text"},[e._v(" "+e._s(e.snackbarMessage)+" ")])]),a("v-col",{attrs:{cols:"2"}},[a("v-btn",{attrs:{color:e.snackbarIconColor,fab:"",outlined:"",small:""},nativeOn:{click:function(t){e.snackbar=!1}}},[a("v-icon",[e._v(" "+e._s(e.snackbarIcon)+" ")])],1)],1)],1)],1)],1)},Qt=[],Xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tooltip",{attrs:{left:"",color:"primary"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"mb-15 mr-10 gradients",attrs:{disabled:e.disabled,loading:e.loading,absolute:"",dark:"",bottom:"",fixed:"",right:"",fab:""},on:{click:function(t){return e.$emit("showForm")}}},n),[a("v-icon",[e._v("mdi-plus")])],1)]}}])},[e._v(" Agregar ")])],1)},Wt=[],Zt={name:"MainButton",props:["loading","disabled"]},Jt=Zt,Kt=Object(v["a"])(Jt,Xt,Wt,!1,null,null,null),ea=Kt.exports;b()(Kt,{VBtn:j["a"],VContainer:h["a"],VIcon:g["a"],VTooltip:Fe["a"]});var ta=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información del servicio"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-stepper",{attrs:{vertical:""},model:{value:e.activeStep,callback:function(t){e.activeStep=t},expression:"activeStep"}},[a("v-stepper-step",{attrs:{step:"1",editable:"",complete:e.step1Completed}},[e._v(" Origen del servicio ")]),a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{ref:"step1Completed",on:{submit:function(e){e.preventDefault()}},model:{value:e.step1Completed,callback:function(t){e.step1Completed=t},expression:"step1Completed"}},[a("v-switch",{staticClass:"ml-4",attrs:{label:"Servicio especial"},model:{value:e.serviceForm.itsSpecial,callback:function(t){e.$set(e.serviceForm,"itsSpecial",t)},expression:"serviceForm.itsSpecial"}}),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-switch",{staticClass:"ml-4",attrs:{label:"Sin código"},model:{value:e.requiresCorrelate,callback:function(t){e.requiresCorrelate=t},expression:"requiresCorrelate"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{label:"Código",rules:e.requiresCorrelate?[]:e.rules.noSpaces,disabled:e.requiresCorrelate,maxlength:20},model:{value:e.serviceForm.reportCode,callback:function(t){e.$set(e.serviceForm,"reportCode",t)},expression:"serviceForm.reportCode"}})],1)],1),a("v-btn",{staticClass:"mb-3",attrs:{disabled:!e.step1Completed,color:"primary",text:"",block:""},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")])],1)],1),a("v-stepper-step",{attrs:{step:"2",editable:e.step1Completed,complete:e.step2Completed}},[e._v(" Información específica ")]),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"step2Completed",model:{value:e.step2Completed,callback:function(t){e.step2Completed=t},expression:"step2Completed"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-switch",{staticClass:"ml-4",attrs:{label:"Sin serial"},model:{value:e.serialNotSubmitted,callback:function(t){e.serialNotSubmitted=t},expression:"serialNotSubmitted"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{readonly:e.serialNotSubmitted,rules:e.rules.required,maxlength:30,label:"#Serial"},model:{value:e.serviceForm.serialCode,callback:function(t){e.$set(e.serviceForm,"serialCode",t)},expression:"serviceForm.serialCode"}})],1)],1),a("v-row",[a("v-col",[a("v-textarea",{attrs:{rules:e.rules.required,maxlength:150,label:"Descripción",outlined:"",counter:""},model:{value:e.serviceForm.description,callback:function(t){e.$set(e.serviceForm,"description",t)},expression:"serviceForm.description"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:e.mobile?6:3}},[a("DateMenu",{on:{setDate:function(t){return e.dateSubmitted=t}}})],1),a("v-col",{attrs:{cols:e.mobile?6:3}},[a("TimeMenu",{on:{setTime:function(t){return e.timeSubmitted=t}}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{"error-messages":e.itIsWeekend(e.dateSubmitted)?"Seleccione un día de la semana":"",rules:e.rules.required,label:"Fecha de reporte",readonly:""},model:{value:e.friendlyDate,callback:function(t){e.friendlyDate=t},expression:"friendlyDate"}}),a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{rules:e.rules.required},model:{value:e.timeSubmitted,callback:function(t){e.timeSubmitted=t},expression:"timeSubmitted"}})],1)],1),a("v-btn",{staticClass:"mb-3",attrs:{disabled:!e.step2Completed,color:"primary",text:"",block:""},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")])],1)],1),a("v-stepper-step",{attrs:{step:"3",editable:e.step2Completed}},[e._v(" Información general ")]),a("v-stepper-content",{attrs:{step:"3"}},[a("v-chip-group",{attrs:{multiple:"",row:""}},e._l(e.suggestions,(function(t,n){return a("span",{key:n},[t.value?a("v-chip",{attrs:{color:t.value===e.serviceForm[t.key]?"accent":"light",disabled:!e.formListings[t.key].find((function(e){return e===t.value})),small:""},on:{click:function(a){return e.acceptSuggestion(t)}}},[e._v(" "+e._s(t.value)+" ")]):e._e()],1)})),0),a("v-form",{ref:"step3Completed",model:{value:e.step3Completed,callback:function(t){e.step3Completed=t},expression:"step3Completed"}},[a("v-row",[a("v-col",[a("v-autocomplete",{attrs:{items:e.formListings.clientName,rules:e.rules.required,label:"Cliente"},on:{"&change":function(t){e.serviceForm.productName=""}},model:{value:e.serviceForm.clientName,callback:function(t){e.$set(e.serviceForm,"clientName",t)},expression:"serviceForm.clientName"}})],1)],1),a("v-row",[a("v-col",[a("v-autocomplete",{attrs:{items:e.formListings.officeName,disabled:!e.serviceForm.clientName,rules:e.rules.required,label:"Oficina"},model:{value:e.serviceForm.officeName,callback:function(t){e.$set(e.serviceForm,"officeName",t)},expression:"serviceForm.officeName"}})],1)],1),a("v-row",{attrs:{align:"center",justify:"space-between"}},[a("v-col",[a("v-autocomplete",{attrs:{items:e.formListings.productName,disabled:!e.serviceForm.clientName,rules:e.rules.required,label:"Producto"},model:{value:e.serviceForm.productName,callback:function(t){e.$set(e.serviceForm,"productName",t)},expression:"serviceForm.productName"}})],1)],1),a("v-row",[a("v-col",[a("v-autocomplete",{attrs:{items:e.formListings.category,disabled:!e.serviceForm.productName,rules:e.rules.required,label:"Categoria"},model:{value:e.serviceForm.category,callback:function(t){e.$set(e.serviceForm,"category",t)},expression:"serviceForm.category"}})],1)],1),a("v-btn",{staticClass:"mb-3",attrs:{disabled:!e.step1Completed||!e.step2Completed||!e.step3Completed,loading:e.loader,color:"primary",block:""},on:{click:function(t){return e.save(e.serviceForm)}}},[e._v(" Registrar ")])],1)],1)],1)],1)},aa=[],na=(a("a4d3"),a("e01a"),a("bc3a")),ia=a.n(na);le.a.locale("es");var ra=n["a"].extend({name:"CorrectiveForm",components:{Header:ce,DateMenu:Ne,TimeMenu:dt},props:["collections","mobile","editing"],data:function(){return{serviceForm:{clientName:"",productName:"",officeName:"",category:"",reportCode:"",description:"",itsSpecial:!1},rules:Ie["rules"],friendlyDate:"",timeSubmitted:"",requiresCorrelate:!1,serialNotSubmitted:!1,dateSubmitted:(new Date).toISOString().substr(0,10),activeStep:1,datePicker:!1,timePicker:!1,step1Completed:!1,step2Completed:!1,step3Completed:!1,suggestions:[{key:"clientName",value:""},{key:"officeName",value:""},{key:"productName",value:""},{key:"category",value:""}],loader:!1}},created:function(){this.editing&&(this.serviceForm=Object.assign({},this.editing),this.serialNotSubmitted="SIN SERIAL"===this.serviceForm.serialCode,this.dateSubmitted=le()(this.editing.reportedAt).parseZone("America/Caracas").format("YYYY-MM-D"),this.timeSubmitted=le()(this.editing.reportedAt).parseZone("America/Caracas").format("HH:mm"))},computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),{},{formListings:function(){var e=this.collections,t=this.serviceForm,a=t.itsSpecial?this.formOptions.clientNames:this.formOptions.clientsWithContract.map((function(e){return e.clientName})),n=t.clientName?e.Office.filter((function(e){return e.clientName===t.clientName})).map((function(e){return e.officeName})):[],i=[];t.itsSpecial?i=e.Product.map((function(e){return e.productName})):this.clientContract&&(i=this.clientContract.products.map((function(e){return e.productName})));var r=t.productName?e.Product.find((function(e){return e.productName===t.productName})).categories:this.formOptions.categories;return{category:r,clientName:a,officeName:n,productName:i}},clientContract:function(){var e=this,t=this.collections.Client.find((function(t){return t.clientName===e.serviceForm.clientName}));return t?t.contracts.find((function(e){return e.active})):void 0},officeInfo:function(){var e=this;return this.serviceForm.officeName?this.collections.Office.find((function(t){return t.officeName===e.serviceForm.officeName})):{}}}),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","updateDocument","findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{itIsWeekend:function(e){return"sábado"===le()(e).format("dddd")||"domingo"===le()(e).format("dddd")},findSuggestions:function(e){this.findSuggestion("reportCode",e.reportCode,"clientName",[].concat(Object(J["a"])(this.collections.Active),Object(J["a"])(this.collections.Closed))),this.findSuggestion("serialCode",e.serialCode,"productName",[].concat(Object(J["a"])(this.collections.Active),Object(J["a"])(this.collections.Closed))),this.findFromLongString(e.description,"category",this.formListings.category)},findOffice:function(e){var t=this.suggestions.find((function(e){return"officeName"===e.key})),a=function(t){return t.serialCode===e},n=function(t){return t.inventory.find((function(t){return t.serialCode===e}))},i=this.collections.Office.find(n);if(i)return t.value=i.officeName;var r=this.collections.Closed.find(a);if(r)return t.value=r.officeName;t.value=""},findSpecificSerial:function(e){var t=this.suggestions.find((function(e){return"productName"===e.key})),a=function(t){return t.serialCode===e},n=function(t){return t.inventory.find((function(t){return t.serialCode===e}))},i=this.collections.Office.find(n);if(i)t.value=i.inventory.find((function(t){return t.serialCode===e})).productName;else{var r=this.collections.Closed.find(a);if(r)return t.value=r.productName;t.value=""}},findSuggestion:function(e,t,a,n){if(t&&!(t.length<3)&&("reportCode"!==e||!this.requiresCorrelate)&&("serialCode"!==e||!this.serialNotSubmitted)){var i=this.suggestions.find((function(e){return e.key===a})),r=n.find((function(a){return a[e].substr(0,3)===t.substr(0,3)}));i.value=r?r[a]:"","serialCode"===e&&this.findOffice(this.serviceForm.serialCode);var o=this.suggestions.find((function(e){return"productName"===e.key})).value;"serialCode"===e&&""===o&&this.findSpecificSerial(this.serviceForm.serialCode)}},findFromLongString:function(e,t,a){if(e&&!(e.length<3)){var n=e.split(" ");n=n.filter((function(e){return e.length>3}));var i,r=this.suggestions.find((function(e){return e.key===t})),o=Object(Z["a"])(a);try{for(o.s();!(i=o.n()).done;){var c,s=i.value,l=Object(Z["a"])(n);try{for(l.s();!(c=l.n()).done;){var u=c.value,d=s.toLowerCase().match(u.toLowerCase());if(d)return r.value=s;r.value=""}}catch(m){l.e(m)}finally{l.f()}}}catch(m){o.e(m)}finally{o.f()}}},acceptSuggestion:function(e){this.serviceForm[e.key]=e.value},getExpireDate:function(){var e,t=this.getSLAInfo();while(void 0===e)t.openingDayMinutes>=60*t.hoursPerSLA?e=le()(t.startingDate).add(t.hoursPerSLA,"hour").format():t.minutesCount<=540?e=le()(t.nextDayworking).add(t.minutesCount,"minutes").format():(t.minutesCount=t.minutesCount-540,t.nextDayworking=this.getNextDayworking(t.nextDayworking));return le()(e).format("YYYY-MM-DD[T]HH:mm[:00.000+00:00]")},getSLAInfo:function(){var e=this.clientContract,t=this.officeInfo.isLocal?e.sla.local:e.sla.foreign,a=this.officeInfo.openingHour,n="".concat(this.dateSubmitted," ").concat(this.timeSubmitted),i=le()(n).diff("".concat(this.dateSubmitted," 14:30"),"minutes")<0,r=i?this.dateSubmitted:this.getNextDayworking(le()(this.dateSubmitted));r=le()(r).format("yyyy-MM-DD");var o=i?this.timeSubmitted:a,c=le()("".concat(r," ").concat(o)).format();o="08:30"===a?"8:00":a;var s=le()("".concat(r," 17:00")).format(),l=le()("".concat(r," ").concat(o)).format();l=this.getNextDayworking(l);var u=le()(s).diff(c,"minutes"),d=60*t-u;return{minutesCount:d,openingDayMinutes:u,hoursPerSLA:t,nextDayworking:l,startingDate:c}},getNextDayworking:function(e){var t;return t=le()(e).add(1,"days").format(),"sábado"===le()(t).format("dddd")&&(t=le.a.utc(e).add(3,"days").format()),t},preventDuplicity:function(e){var t=this;return new Promise((function(a,n){var i=e.clientName,r=t.requiresCorrelate?null:e.reportCode,o=t.serialNotSubmitted?null:e.serialCode,c=t.editing?e._id:null,s={$or:[{$and:[{reportCode:r},{clientName:i}]},{serialCode:o}],_id:{$ne:c}},l={$and:[{reportCode:r},{clientName:i}],_id:{$ne:c}};Promise.all([t.findDocuments({collection:"Active",filter:s}),t.findDocuments({collection:"Closed",filter:l})]).then((function(e){var n=[].concat(Object(J["a"])(e[0]),Object(J["a"])(e[1]));n.length?(t.showSnackbar({error:"Registrado anteriormente, verique el código de reporte y serial"}),a(!0)):a(!1)})).catch((function(){return n(!1)}))}))},save:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.loader=!0,t.requiresCorrelate&&t.serialNotSubmitted){a.next=7;break}return a.next=4,t.preventDuplicity(e);case 4:a.t0=a.sent,a.next=8;break;case 7:a.t0=!1;case 8:if(n=a.t0,!n){a.next=11;break}return a.abrupt("return",t.loader=!1);case 11:return a.next=13,t.completeBody(e);case 13:if(i=a.sent,!i.throwsError){a.next=16;break}return a.abrupt("return",(t.showSnackbar({error:i.throwsError}),t.loader=!1));case 16:if(!t.editing){a.next=20;break}return a.abrupt("return",t.update({collection:"Active",body:i}));case 20:t.create({collection:"Active",body:i});case 21:case"end":return a.stop()}}),a)})))()},update:function(e){var t=this;this.updateDocument(e).then((function(){return t.finish()})).catch((function(){return t.loader=!1}))},create:function(e){var t=this;this.createDocument(e).then((function(){return t.finish()})).catch((function(){return t.loader=!1}))},finish:function(){this.serialNotSubmitted||this.$emit("searchRelated",Object.assign({},this.serviceForm)),this.$emit("hideInterface")},getCorrelative:function(){var e=this;return new Promise((function(t,a){ia.a.put("/Correlative",null,{headers:{"auth-token":e.formOptions.token}}).then((function(e){var a=e.data;if(a.error)return t({throwsError:a.error,val:null});t({throwsError:!1,val:a.val})})).catch((function(){return a(e.showSnackbar({error:"Error inesperado. Verifique la conexión, recargue la página e intente nuevamente"}))}))}))},completeBody:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.requiresCorrelate){a.next=9;break}return a.next=3,t.getCorrelative();case 3:if(n=a.sent,!n.throwsError){a.next=8;break}return a.abrupt("return",{throwsError:n.throwsError});case 8:e.reportCode=n.val;case 9:return i=t.setDocumentation(""),t.editing?e.documentation.push(i):e.documentation=t.setDocumentation(""),t.serviceForm.itsSpecial?(e.expireDate=new Date,e.expired=!1):(e.expireDate=t.getExpireDate(),r=le()(e.expireDate).diff(new Date,"minutes"),e.expired=r<0),a.abrupt("return",e);case 13:case"end":return a.stop()}}),a)})))()},setDocumentation:function(e){return{type:this.editing?"Editado":"Registrado",observations:e,status:this.editing?this.editing.status:"En programación",date:this.serviceForm.reportedAt,author:this.formOptions.user,updatedAt:le()(Date.now()).format()}}}),watch:{serialNotSubmitted:function(){this.serialNotSubmitted?this.serviceForm.serialCode="SIN SERIAL":this.serviceForm.serialCode=""},activeStep:function(){3===this.activeStep&&this.findSuggestions(this.serviceForm)},timeSubmitted:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM,")," ").concat(this.timeSubmitted),this.serviceForm.reportedAt=le()("".concat(this.dateSubmitted," ").concat(this.timeSubmitted)).format("YYYY-MM-DD[T]HH:mm[:00.000+00:00]")},dateSubmitted:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM,")," ").concat(this.timeSubmitted),this.serviceForm.reportedAt=le()("".concat(this.dateSubmitted," ").concat(this.timeSubmitted)).format("YYYY-MM-DD[T]HH:mm[:00.000+00:00]")},"serviceForm.productName":function(){var e=this;this.serviceForm.productType=this.serviceForm.productName?this.collections.Product.find((function(t){return t.productName===e.serviceForm.productName})).productType:""},"serviceForm.officeName":function(){this.serviceForm.officeRegion=this.officeInfo.region,this.serviceForm.officeState=this.officeInfo.officeState,this.serviceForm.isLocal=this.officeInfo.isLocal}}}),oa=ra,ca=Object(v["a"])(oa,ta,aa,!1,null,null,null),sa=ca.exports;b()(ca,{VAutocomplete:Pe["a"],VBtn:j["a"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VRow:T["a"],VStepper:bt["a"],VStepperContent:ht["a"],VStepperStep:gt["a"],VSwitch:ze["a"],VTextField:Re["a"],VTextarea:yt["a"]});var la=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-expansion-panels",e._l(e.orderedServices,(function(t,n){return a("v-expansion-panel",{key:n,attrs:{disabled:!t.services.length}},[a("v-expansion-panel-header",[e._v(" "+e._s(t.clientName)+" ")]),e._l(t.services,(function(t,n){return a("v-expansion-panel-content",{key:n,staticClass:"mt-2"},[a("CorrectivePanel",{attrs:{service:t,mobile:e.mobile},on:{searchRelated:function(a){return e.$emit("searchRelated",t)}}})],1)}))],2)})),1)],1)},ua=[],da=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-list",{attrs:{dense:""}},[a("v-list-item",[a("v-list-item-avatar",{directives:[{name:"show",rawName:"v-show",value:!e.mobile,expression:"!mobile"}]},[a("v-icon",{class:e.$vuetify.theme.dark?"dark":"gradients",attrs:{dark:""}},[e._v(" mdi-label ")])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[a("v-badge",{staticClass:"subtitle-1 font-weight-bold",attrs:{value:e.service.itsSpecial,bordered:"",color:"accent",icon:"mdi-medal-outline"}},[a("span",[e._v(e._s(e.service.reportCode))])])],1),a("v-list-item-subtitle",{staticClass:"subtitle-1 text-wrap"},[e._v(" "+e._s(e.service.officeName)+" ")]),a("v-list-item-subtitle",{staticClass:"subtitle-2 text-wrap"},[e._v(" "+e._s(e.service.productType)+" ")]),a("v-list-item-subtitle",{staticClass:"subtitle-2"},[e._v(" "+e._s(e.service.serialCode)+" "),e.service.relatedDocuments?a("v-tooltip",{attrs:{right:"",small:"",color:"accent"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{icon:"",small:"",color:"accent"},on:{click:function(t){return e.showHistory(e.service)}}},n),[a("v-icon",{attrs:{small:"",color:"accent"}},[e._v(" mdi-check ")])],1)]}}],null,!1,903365508)},[e._v(" Ver historial ")]):a("v-tooltip",{attrs:{right:"",small:"",color:"accent"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return["SIN SERIAL"!==e.service.serialCode?a("v-btn",e._g({attrs:{icon:"",small:""},on:{click:function(t){return e.$emit("searchRelated",e.service)}}},n),[a("v-icon",{attrs:{small:"",color:"error"}},[e._v(" mdi-magnify ")])],1):e._e()]}}])},[e._v(" Buscar historial ")])],1)],1),a("v-list-item-action",[a("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.showInterface("details",e.service)}}},[a("v-icon",{attrs:{color:"primary"}},[e._v("mdi-information-outline")])],1),a("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{icon:"",small:""}},n),[a("v-icon",{attrs:{color:"primary"}},[e._v("mdi-dots-vertical")])],1)]}}])},[a("v-list",{attrs:{color:"primary",dark:"",dense:""}},[a("v-list-item-group",e._l(e.actionsMenu,(function(t,n){return a("v-list-item",{key:n,attrs:{disabled:t.minRole<e.$store.state.session.user.userRole},on:{click:function(a){return e.showInterface(t.action,e.service)}}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" "+e._s(t.title)+" ")])],1)],1)})),1)],1)],1)],1)],1)],1),a("v-dialog",{attrs:{fullscreen:e.detailsInterface,width:e.mobile?"90%":"60%",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.editInterface?a("CorrectiveForm",{attrs:{mobile:e.mobile,collections:e.collections,editing:e.selectedDocument},on:{hideInterface:function(t){return e.hideInterface("edit")}}}):e._e(),e.detailsInterface?a("CorrectiveInfo",{attrs:{mobile:e.mobile,selectedDocument:e.selectedDocument},on:{hideInterface:function(t){return e.hideInterface("details")}}}):e._e(),e.inventoryInterface?a("MaintenanceInfo",{attrs:{selectedDocument:e.selectedDocument},on:{hideInterface:function(t){return e.hideInterface("inventory")}}}):e._e(),e.scheduleInterface?a("CorrectiveSchedule",{attrs:{mobile:e.mobile,selectedDocument:e.selectedDocument},on:{hideInterface:function(t){return e.hideInterface("schedule")}}}):e._e(),e.updateInterface?a("CorrectiveUpdate",{attrs:{mobile:e.mobile,selectedDocument:e.selectedDocument},on:{hideInterface:function(t){return e.hideInterface("update")}}}):e._e(),e.deleteInterface?a("CorrectiveDelete",{attrs:{mobile:e.mobile,selectedDocument:e.selectedDocument},on:{hideInterface:function(t){return e.hideInterface("delete")}}}):e._e()],1)],1),a("v-bottom-sheet",{attrs:{scrollable:""},model:{value:e.bottomSheet,callback:function(t){e.bottomSheet=t},expression:"bottomSheet"}},[a("v-card",[a("v-card-text",[e.bottomSheet?a("ProductHistory",{attrs:{mobile:e.mobile,relatedServices:e.selectedServiceRelated},on:{showInterface:e.showInterface,hideInterface:function(t){e.bottomSheet=!1}}}):e._e()],1)],1)],1)],1)},ma=[],fa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Historial",subtitle:"Serial: "+e.relatedServices[0].serialCode},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-timeline",{attrs:{dense:e.mobile}},e._l(e.orderedServices,(function(t,n){return a("v-timeline-item",{key:n,attrs:{color:t.reportCode?"primary":"secondary",small:""},scopedSlots:e._u([{key:"opposite",fn:function(){return[a("span",{staticClass:"headline font-weight-bold"},[e._v(" "+e._s(t.officeName)+" ")])]},proxy:!0}],null,!0)},[a("div",{staticClass:"py-4"},[a("v-chip",{staticClass:"mb-4",attrs:{color:t.reportCode?"primary":"secondary",label:""}},[e._v(" "+e._s(t.reportCode?t.reportCode:"Mantenimiento")+" ")]),a("v-tooltip",{attrs:{top:"",small:"",color:"accent"},scopedSlots:e._u([{key:"activator",fn:function(n){var i=n.on;return[a("v-btn",e._g({staticClass:"ml-1",attrs:{icon:"",small:""},on:{click:function(a){return e.$emit("showInterface",t.reportCode?"details":"inventory",t)}}},i),[a("v-icon",{attrs:{small:"",color:"accent"}},[e._v(" mdi-eye-settings-outline ")])],1)]}}],null,!0)},[a("span",[e._v("Ver detalle")])]),a("br"),e.mobile?a("p",[e._v(" "+e._s(t.clientName)+" "+e._s(t.officeName)+" ")]):e._e(),a("span",{staticClass:"font-weight-bold"},[e._v(" "+e._s(t.status)+" ")]),a("v-divider"),a("div",[a("small",[e._v(" "+e._s(e._f("dateNoTime")(t.serviceDate?t.serviceDate:t.schedule.scheduledDate))+" ")]),a("v-chip",{staticClass:"ma-1",attrs:{small:"",label:""}},[e._v(" "+e._s(t.reportCode?t.schedule.technician.fullName:t.technician.fullName)+" ")])],1)],1)])})),1)],1)},va=[];le.a.locale("es");var pa={name:"ProductHistory",components:{Header:ce},props:["relatedServices","mobile"],data:function(){return{orderedServices:[]}},created:function(){this.sortServices()},methods:{sortServices:function(){function e(e,t){var a=e.serviceDate?e.serviceDate:e.schedule.scheduledDate,n=t.serviceDate?t.serviceDate:t.schedule.scheduledDate;return a>n?1:-1}this.orderedServices=this.relatedServices.sort(e)}},filters:{dateNoTime:function(e){return le()(e).parseZone("America/Caracas").format("LL")}}},ba=pa,ha=Object(v["a"])(ba,fa,va,!1,null,null,null),ga=ha.exports;b()(ha,{VBtn:j["a"],VChip:Je["a"],VContainer:h["a"],VDivider:M["a"],VIcon:g["a"],VTimeline:Ot["a"],VTimelineItem:St["a"],VTooltip:Fe["a"]});var ya=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("Header",{attrs:{closable:"1",title:"Documentación",subtitle:"Serial: "+e.selectedDocument.serialCode},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),n("v-row",{staticClass:"mt-5"},[n("v-col",{attrs:{cols:e.mobile?12:6}},[n("v-row",[n("v-col",[n("v-card",{staticClass:"my-2 px-2"},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"3"}},[n("v-img",{attrs:{src:a("f625"),width:"70"}})],1),n("v-col",{attrs:{cols:"9"}},[n("v-card-title",[e._v(" Mantenimiento ")]),n("v-card-subtitle",[e._v(e._s(e._f("dateNoTime")(e.selectedDocument.serviceDate)))])],1)],1)],1)],1)],1),n("v-row",[n("v-col",[n("v-card",{staticClass:"my-2 px-2"},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"3"}},[n("v-img",{attrs:{src:a("ccc1"),width:"70"}})],1),n("v-col",{attrs:{cols:"9"}},[n("v-card-title",[e._v(e._s(e.selectedDocument.clientName))]),n("v-card-subtitle",[e._v(e._s(e.selectedDocument.officeName))])],1)],1)],1)],1)],1),n("v-row",[n("v-col",[n("v-card",{staticClass:"my-2 px-2"},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"3"}},[n("v-img",{attrs:{src:a("7e7c"),width:"70"}})],1),n("v-col",{attrs:{cols:"9"}},[n("v-card-title",[e._v(" "+e._s(e.selectedDocument.serialCode)+" ")]),n("v-card-subtitle",[e._v(e._s(e.selectedDocument.productName))])],1)],1)],1)],1)],1)],1),n("v-col",[n("v-row",[n("v-col",[n("v-card",{staticClass:"my-2 px-2"},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"3"}},[n("v-img",{attrs:{src:a("7a62"),width:"70"}})],1),n("v-col",{attrs:{cols:"9"}},[n("v-card-title",[e._v(e._s(e.selectedDocument.status))]),n("v-card-subtitle",[e._v("Status del producto")])],1)],1)],1)],1)],1),n("v-row",[n("v-col",[n("v-card",{staticClass:"my-2 px-2"},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"3"}},[n("v-img",{attrs:{src:a("221b"),width:"70"}})],1),n("v-col",{attrs:{cols:"9"}},[n("v-card-title",{staticClass:"text-no-wrap"},[e._v(e._s(e.selectedDocument.technician.fullName))]),n("v-card-subtitle",[e._v("Personal asignado")])],1)],1)],1)],1)],1),n("v-row",[n("v-col",[n("v-card",{staticClass:"my-2 px-2"},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"3"}},[n("v-img",{attrs:{src:a("64c3"),width:"70"}})],1),n("v-col",{attrs:{cols:"9"}},[n("v-card-title",[e._v("Orden "+e._s(e.selectedDocument.serviceOrder))]),n("v-card-subtitle",[e._v(e._s(e.selectedDocument.observations))])],1)],1)],1)],1)],1)],1)],1)],1)},Ca=[];le.a.locale("es");var ka=n["a"].extend({name:"MaintenanceInfo",props:["selectedDocument"],components:{Header:ce},filters:{dateNoTime:function(e){return le()(e).parseZone("America/Caracas").format("LL")}},computed:{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}}}),xa=ka,_a=Object(v["a"])(xa,ya,Ca,!1,null,null,null),Da=_a.exports;b()(_a,{VCard:N["a"],VCardSubtitle:pe["b"],VCardTitle:pe["d"],VCol:I["a"],VContainer:h["a"],VImg:$["a"],VRow:T["a"]});var wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Eliminar servicio",subtitle:"Código: "+e.selectedDocument.reportCode},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-alert",{attrs:{type:"error",dense:"",text:""}},[e._v("Esta acción es irreversible")]),a("v-form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.deleteService(e.selectedDocument)}},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{rules:e.codesMatch,label:"Código del servicio",hint:"Confirme el código del servicio"},model:{value:e.reportCode,callback:function(t){e.reportCode=t},expression:"reportCode"}})],1)],1),a("v-row",{staticClass:"pb-2",attrs:{align:"center"}},[a("v-col",{attrs:{align:"center"}},[a("v-btn",{attrs:{disabled:!e.form,loading:e.loader,color:"error"},on:{click:function(t){return e.deleteService(e.selectedDocument)}}},[e._v(" Eliminar ")])],1)],1)],1)],1)},Oa=[],Sa=n["a"].extend({name:"CorrectiveDelete",components:{Header:ce},props:["mobile","selectedDocument"],data:function(){return{form:!1,reportCode:"",loader:!1}},computed:{codesMatch:function(){var e=this;return[function(t){return t===e.selectedDocument.reportCode||"Confirme el código del servicio"}]}},methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["deleteDocument"])),{},{deleteService:function(e){var t=this;this.loader=!0,this.deleteDocument({collection:"Active",body:e}).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))}})}),Va=Sa,Fa=Object(v["a"])(Va,wa,Oa,!1,null,null,null),ja=Fa.exports;b()(Fa,{VAlert:ne["a"],VBtn:j["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VRow:T["a"],VTextField:Re["a"]});var Na={name:"CorrectivePanel",props:["service","mobile"],components:{CorrectiveInfo:Ft,CorrectiveSchedule:qe,CorrectiveUpdate:kt,CorrectiveForm:sa,ProductHistory:ga,CorrectiveDelete:ja,MaintenanceInfo:Da},data:function(){return{inventoryInterface:!1,scheduleInterface:!1,detailsInterface:!1,updateInterface:!1,deleteInterface:!1,editInterface:!1,bottomSheet:!1,searching:!1,dialog:!1,actionsMenu:[{action:"schedule",title:"Asignar",icon:"mdi-account-arrow-left",minRole:2},{action:"update",title:"Actualizar",icon:"mdi-file-refresh-outline",minRole:2},{action:"edit",title:"Editar",icon:"mdi-file-document-edit-outline",minRole:2},{action:"delete",title:"Eliminar",icon:"mdi-delete",minRole:1}],selectedDocument:{},selectedServiceRelated:[]}},computed:Object(o["a"])({},Object(l["e"])(["collections"])),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["d"])(["setRelatedDocuments"])),Object(l["b"])(["findDocuments"])),{},{hideInterface:function(e){this.dialog=!1,this.selectedDocument={},this["".concat(e,"Interface")]=!1},showInterface:function(e,t){this.dialog=!0,this.selectedDocument=Object.assign({},t),this["".concat(e,"Interface")]=!0},showHistory:function(e){this.selectedServiceRelated=e.relatedDocuments,this.bottomSheet=!0}})},Ia=Na,Ma=a("4ca6"),$a=a("1800"),Pa=a("8270"),Ta=Object(v["a"])(Ia,da,ma,!1,null,null,null),Ra=Ta.exports;b()(Ta,{VBadge:Ma["a"],VBottomSheet:qt["a"],VBtn:j["a"],VCard:N["a"],VCardText:pe["c"],VContainer:h["a"],VDialog:Mt["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemAction:$a["a"],VListItemAvatar:Pa["a"],VListItemContent:k["a"],VListItemGroup:$t["a"],VListItemIcon:x["a"],VListItemSubtitle:k["b"],VListItemTitle:k["c"],VMenu:P["a"],VTooltip:Fe["a"]});var Aa={name:"CorrectivesPanels",props:["collections","orderedServices","mobile"],components:{CorrectivePanel:Ra}},qa=Aa,Ea=a("cd55"),La=a("49e2"),Ha=a("c865"),Ba=a("0393"),Ya=Object(v["a"])(qa,la,ua,!1,null,null,null),za=Ya.exports;b()(Ya,{VContainer:h["a"],VExpansionPanel:Ea["a"],VExpansionPanelContent:La["a"],VExpansionPanelHeader:Ha["a"],VExpansionPanels:Ba["a"]});var Ga={name:"Corrective",components:{CorrectivePanels:za,Graph:he,Header:ce,MainButton:ea,CorrectiveForm:sa},data:function(){return{dialog:!1,snackbar:!1,snackbarMessage:"",snackbarIcon:"",snackbarIconColor:""}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections","loading"])),Object(l["c"])(["formOptions"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},orderedServices:function(){var e,t=this,a=[],n=Object(Z["a"])(this.formOptions.clientNames);try{var i=function(){var n=e.value;a.push({clientName:n,services:t.collections.Active.filter((function(e){return e.clientName===n}))})};for(n.s();!(e=n.n()).done;)i()}catch(r){n.e(r)}finally{n.f()}return a},cards:function(){return[{data:this.collections.Active,title:"Activos",icon:a("6f9f")},{data:this.pendingXParts,title:"Por repuestos",icon:a("179c")}]},pendingXParts:function(){return this.collections.Active.filter((function(e){return"Pendiente - Por repuestos"===e.status}))},corrective:function(){return[].concat(Object(J["a"])(this.collections.Active),Object(J["a"])(this.collections.Closed))},thisMonth:function(){return le()(new Date).format("MMMM")},servicesXStatus:function(){var e=this,t="polarArea",a={plugins:{legend:{}}},n=this.corrective.map((function(e){return e.status}));n=Object(J["a"])(new Set(n));var i,r={labels:n,datasets:[{label:"Correctivo",data:[],backgroundColor:[]}]},o=Object(Z["a"])(n);try{var c=function(){var t=i.value;r.datasets[0].backgroundColor.push(e.colorsXStatus[t]),r.datasets[0].data.push(e.corrective.filter((function(e){return e.status===t})).length)};for(o.s();!(i=o.n()).done;)c()}catch(s){o.e(s)}finally{o.f()}return{type:t,data:r,options:a}},colorsXStatus:function(){return{"Cerrado - Operativo":this.$vuetify.theme.currentTheme.success,"Cerrado - Reemplazado":this.$vuetify.theme.currentTheme.info,"Cerrado - Desincorporado":this.$vuetify.theme.currentTheme.secondary,"Pendiente - Por repuestos":this.$vuetify.theme.currentTheme.warning,"En programación":this.$vuetify.theme.currentTheme.error,"Atención programada":this.$vuetify.theme.currentTheme.accent}},servicesXClient:function(){var e,t=this,a="bar",n={},i={labels:this.formOptions.clients.map((function(e){return e.clientName})),datasets:[{label:"Servicios por correctivo",data:[],backgroundColor:this.$vuetify.theme.currentTheme.primary}]},r=Object(Z["a"])(this.formOptions.clients);try{var o=function(){var a=e.value,n=function(e){return e.clientName===a.clientName};i.datasets[0].data.push(t.corrective.filter(n).length)};for(r.s();!(e=r.n()).done;)o()}catch(c){r.e(c)}finally{r.f()}return{type:a,data:i,options:n}},servicesXTechnician:function(){var e,t=this,a="line",n={},i={labels:this.formOptions.technicians.map((function(e){return e.text})),datasets:[{label:"Servicios por correctivo",data:[],borderColor:this.$vuetify.theme.currentTheme.primary}]},r=Object(Z["a"])(this.formOptions.technicians);try{var o=function(){var a=e.value,n=function(e){return e.schedule.technician.fullName===a.text};i.datasets[0].data.push(t.corrective.filter(n).length)};for(r.s();!(e=r.n()).done;)o()}catch(c){r.e(c)}finally{r.f()}return{type:a,data:i,options:n}}}),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["d"])(["setRelatedDocuments"])),Object(l["b"])(["findDocuments"])),{},{searchRelated:function(e,t){var a=this,n={$or:[{serialCode:e.serialCode},{"documentation.newSerial":e.serialCode}]},i=[this.findDocuments({collection:"Closed",filter:n}),this.findDocuments({collection:"Inventory",filter:{serialCode:e.serialCode}})];Promise.all(i).then((function(n){var i=[].concat(Object(J["a"])(n[0]),Object(J["a"])(n[1]));i.length?(a.setRelatedDocuments({serialCode:e.serialCode,data:i}),a.snackbarMessage="Encontramos servicios relacionados",a.snackbarIcon="mdi-check",a.snackbarIconColor="accent lighten-1",a.snackbar=!0):t&&(a.snackbarMessage="La búsqueda no arrojó resultados",a.snackbarIcon="mdi-alert",a.snackbarIconColor="error lighten-1",a.snackbar=!0)}))}})},Ua=Ga,Qa=Object(v["a"])(Ua,Ut,Qt,!1,null,null,null),Xa=Qa.exports;b()(Qa,{VBtn:j["a"],VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDialog:Mt["a"],VIcon:g["a"],VRow:T["a"],VSheet:Yt["a"],VSkeletonLoader:ie["a"],VSnackbar:Y["a"]});var Wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Mantenimiento preventivo",subtitle:"Servicios programados e inventario de clientes"}}),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):e._e(),e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):a("MaintenancePanels",{attrs:{collections:e.collections,mobile:e.mobile,finishedMaintenance:e.finishedMaintenance}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("MaintenanceTable",{attrs:{mobile:e.mobile,collections:e.collections,maintenances:e.collections.Maintenance}})],1)],1),a("MainButton",{attrs:{loading:e.loading},on:{showForm:function(t){e.dialog=!0}}}),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.dialog?a("MaintenanceForm",{attrs:{mobile:e.mobile,collections:e.collections},on:{hideInterface:function(t){e.dialog=!1}}}):e._e()],1)],1)],1)},Za=[],Ja=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"accent"}}),a("v-tab",[e._v(" Asignados ")]),a("v-tab",[e._v(" Por validar ")])],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("v-data-table",{attrs:{headers:e.headers,dense:"",items:e.scheduledMaintenances},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[a("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{color:"primary",small:""}},n),[a("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[a("v-list",{attrs:{color:"primary",dark:"",dense:""}},[a("v-list-item-group",e._l(e.serviceMenu,(function(t,i){return a("v-list-item",{key:i,attrs:{disabled:e.$store.state.session.user.userRole>t.minRole},on:{click:function(a){return e.showDialog(t.action,n)}}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" "+e._s(t.title)+" ")])],1)],1)})),1)],1)],1)]}}])})],1),a("v-tab-item",[a("v-data-table",{attrs:{headers:e.headers,dense:"",items:e.finishedMaintenances},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[a("v-btn",{attrs:{color:"primary",small:""},on:{click:function(t){return e.showDialog("validate",n)}}},[a("v-icon",[e._v("mdi-check")])],1)]}}])})],1)],1),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.editInterface?a("MaintenanceForm",{attrs:{editing:e.selectedService,collections:e.collections,mobile:e.mobile,pendingMaintenance:e.pendingMaintenance},on:{hideInterface:function(t){return e.hideInterface("edit")}}}):e._e(),e.updateInterface?a("MaintenanceUpdate",{attrs:{updating:e.selectedService,collections:e.collections,mobile:e.mobile},on:{hideInterface:function(t){return e.hideInterface("update")}}}):e._e(),e.validateInterface?a("MaintenanceValidation",{attrs:{updating:e.selectedService,collections:e.collections,mobile:e.mobile},on:{hideInterface:function(t){return e.hideInterface("validate")}}}):e._e()],1)],1)],1)},Ka=[],en=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de validación",subtitle:"Mantenimiento preventivo"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-card",[a("v-card-text",[a("v-card-title",[a("v-icon",{attrs:{left:""}},[e._v("mdi-account-tie")]),e._v(" "+e._s(e.updating.clientName)+" ")],1),a("v-card-subtitle",[e._v(" "+e._s(e.updating.officeName)+" ")]),a("section",[a("v-card-subtitle",[a("v-icon",[e._v("mdi-card-text-outline")]),e._v(" Órdenes de servicio ")],1),a("v-tabs",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"accent"}}),e._l(e.serviceOrders,(function(t,n){return a("v-tab",{key:n},[e._v(" "+e._s(t.orderNumber)+" ")])}))],2)],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},e._l(e.serviceOrders,(function(t,n){return a("v-tab-item",{key:n},[a("v-chip-group",[a("v-card-subtitle",[a("v-icon",{attrs:{left:""}},[e._v("mdi-barcode")]),e._v(" Seriales ")],1),e._l(t.inventory,(function(t,n){return a("v-chip",{key:n,staticClass:"mt-3",attrs:{small:"",close:"",color:t.serialCode?"secondary":"error lighten-1"},on:{click:function(a){return e.selectProduct(t)},"click:close":function(a){return e.removeProduct(t)}}},[e._v(" "+e._s(t.serialCode?t.serialCode:"Por validar")+" ")])})),a("v-chip",{staticClass:"mt-3",attrs:{small:"",color:"secondary lighten-1",outlined:""},on:{click:function(a){return e.addProduct(t)}}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" Agregar ")],1)],2)],1)})),1),a("v-stepper",{attrs:{vertical:""},model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[a("v-stepper-step",{attrs:{step:"1",editable:e.step>1}},[e._v(" Información general ")]),a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{ref:"step1Form",model:{value:e.step1Form,callback:function(t){e.step1Form=t},expression:"step1Form"}},[a("v-row",{attrs:{align:"center",justify:"space-between"}},[a("v-col",{attrs:{cols:e.mobile?7:3}},[a("v-text-field",{attrs:{rules:e.rules.serviceOrder,label:"#Orden",maxlength:6},model:{value:e.selectedProduct.serviceOrder,callback:function(t){e.$set(e.selectedProduct,"serviceOrder",t)},expression:"selectedProduct.serviceOrder"}})],1),a("v-col",{attrs:{cols:e.mobile?5:6,align:"end"}},[a("DateMenu",{on:{setDate:function(t){return e.dateSubmitted=t}}})],1)],1),a("v-row",{attrs:{justify:"space-between",align:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-autocomplete",{attrs:{items:e.formOptions.technicians,rules:e.rules.required,label:"Personal asignado",solo:""},model:{value:e.serviceForm.schedule.technician,callback:function(t){e.$set(e.serviceForm.schedule,"technician",t)},expression:"serviceForm.schedule.technician"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-select",{attrs:{items:e.formLists.productTypes,rules:e.rules.required,label:"Producto",solo:""},model:{value:e.selectedProduct.productType,callback:function(t){e.$set(e.selectedProduct,"productType",t)},expression:"selectedProduct.productType"}})],1)],1),a("v-btn",{attrs:{disabled:!e.step1Form,color:"primary",small:"",text:"",block:""},on:{click:function(t){e.step++}}},[e._v(" Siguiente ")])],1)],1),a("v-stepper-step",{attrs:{step:"2"}},[e._v(" Información específica ")]),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"step2Form",model:{value:e.step2Form,callback:function(t){e.step2Form=t},expression:"step2Form"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{readonly:e.serialNotSubmitted,rules:e.rules.required,label:"Serial"},model:{value:e.selectedProduct.serialCode,callback:function(t){e.$set(e.selectedProduct,"serialCode","string"===typeof t?t.trim():t)},expression:"selectedProduct.serialCode"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-switch",{attrs:{label:"Sin serial"},model:{value:e.serialNotSubmitted,callback:function(t){e.serialNotSubmitted=t},expression:"serialNotSubmitted"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-autocomplete",{attrs:{items:e.formLists.specificProducts,rules:e.rules.required,"auto-select-first":"",label:"Modelo"},model:{value:e.selectedProduct.productName,callback:function(t){e.$set(e.selectedProduct,"productName",t)},expression:"selectedProduct.productName"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:e.mobile?7:3}},[a("v-select",{attrs:{rules:e.rules.required,items:e.productLocations,label:"Ubicación"},model:{value:e.selectedProduct.location,callback:function(t){e.$set(e.selectedProduct,"location",t)},expression:"selectedProduct.location"}})],1),a("v-col",{attrs:{cols:e.mobile?5:3}},[a("v-select",{attrs:{items:[1,2,3,4,5,6,7,8,9,10],label:"#"},model:{value:e.selectedProduct.locationNumber,callback:function(t){e.$set(e.selectedProduct,"locationNumber",t)},expression:"selectedProduct.locationNumber"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-select",{attrs:{items:["Operativo","Inoperativo"],label:"Status",rules:e.rules.required},model:{value:e.selectedProduct.status,callback:function(t){e.$set(e.selectedProduct,"status",t)},expression:"selectedProduct.status"}})],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",[a("v-textarea",{attrs:{label:"Observaciones (opcional)",outlined:""},model:{value:e.selectedProduct.observations,callback:function(t){e.$set(e.selectedProduct,"observations",t)},expression:"selectedProduct.observations"}})],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",[a("v-btn",{attrs:{color:"success",disabled:!e.step1Form||!e.step2Form,loading:e.loader},on:{click:function(t){return e.productValidation(e.selectedIndex,e.selectedProduct)}}},[e._v(" Guardar ")])],1)],1)],1)],1)],1)],1),a("v-card-actions",[a("v-btn",{attrs:{color:"success",small:"",block:"",disabled:e.invalidStatus},on:{click:e.finishValidation}},[e._v(" Archivar ")])],1)],1)],1)},tn=[];a("a434"),a("c740");le.a.locale("es");var an=n["a"].extend({name:"MaintenanceValidation",components:{Header:ce,DateMenu:Ne},props:["collections","mobile","updating"],data:function(){return{tab:0,step:0,step1Form:!1,step2Form:!1,datePicker:!1,serviceForm:{},selectedProduct:{serviceOrder:"",quantity:0,productType:"",status:""},serialNotSubmitted:!1,productLocations:Ie["productLocations"],selectedIndex:0,status:Ie["maintenanceStatus"],dateSubmitted:(new Date).toISOString().substr(0,10),loader:!1,friendlyDate:"",rules:Ie["rules"]}},created:function(){this.serviceForm=Object.assign({},this.updating),this.dateSubmitted=this.serviceForm.schedule.scheduledDate,this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM"))},computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),{},{formLists:function(){var e=this,t=this.serviceForm.clientName?this.collections.Client.find((function(t){return t.clientName===e.serviceForm.clientName})):{},a=t.contracts.find((function(e){return e.active})),n=a?a.products.map((function(e){return e.productType})):this.collections.Product.map((function(e){return e.productType})),i=a?a.products.filter((function(t){return t.productType===e.selectedProduct.productType})):this.collections.Product.filter((function(t){return t.productType===e.selectedProduct.productType}));return i=i.map((function(e){return e.productName})),{clientInfo:t,productTypes:n,specificProducts:i}},serviceOrders:function(){var e=this,t=this.serviceForm.inventory.map((function(e){return e.serviceOrder}));t=new Set(Object(J["a"])(t));var a,n=[],i=Object(Z["a"])(t);try{var r=function(){var t=a.value;n.push({orderNumber:t,inventory:e.serviceForm.inventory.filter((function(e){return e.serviceOrder===t}))})};for(i.s();!(a=i.n()).done;)r()}catch(o){i.e(o)}finally{i.f()}return n},invalidStatus:function(){var e="Culminado"!==this.serviceForm.status,t=void 0!==this.serviceForm.inventory.find((function(e){return""===e.serialCode}));return e||t}}),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","updateDocument"])),{},{itIsWeekend:function(e){return"sábado"===le()(e).format("dddd")||"domingo"===le()(e).format("dddd")},removeOrder:function(e){this.serviceOrders.splice(e,1)},finishValidation:function(){this.createInventory(this.serviceForm.inventory).then(this.updateOfficeInventory()).then(this.serviceForm.fullValidated=!0),this.serviceForm.status="Validado",this.saveChanges(!0)},createInventory:function(e){var t,a=[],n=Object(Z["a"])(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;a.push(this.createDocument({collection:"Inventory",body:i}))}}catch(r){n.e(r)}finally{n.f()}return Promise.all(a)},updateOfficeInventory:function(){var e=this,t=this.serviceForm.schedule.scheduledDate,a=this.serviceForm.inventory,n=this.collections.Office.find((function(t){return t.officeName===e.updating.officeName&&t.clientName===e.updating.clientName})),i=n._id;return this.updateDocument({collection:"Office",body:{lastMaintenance:t,inventory:a,_id:i}})},selectProduct:function(e){this.selectedIndex=this.serviceForm.inventory.findIndex((function(t){return t===e})),this.selectedProduct=Object.assign({},e),1===this.formLists.specificProducts.length&&(this.selectedProduct.productName=this.formLists.specificProducts[0]),this.step=1},removeProduct:function(e){this.selectedIndex=this.serviceForm.inventory.findIndex((function(t){return t===e})),this.serviceForm.inventory.splice(this.selectedIndex,1),this.selectedIndex=-1},addProduct:function(e){var t=Object.assign({},e.inventory[0]);t.serialCode="",t.location="",this.serviceForm.inventory.push(t)},productValidation:function(e,t){t.serialCode=t.serialCode.toUpperCase(),t.location=t.location+t.locationNumber,t.clientName=this.updating.clientName,t.officeName=this.updating.officeName,this.serviceForm.inventory.splice(e,1,t),this.step=0,this.selectedIndex=-1,this.selectedProduct=Object.assign({},{}),this.saveChanges()},saveChanges:function(e){var t=this;this.loader=!0,this.updateDocument({collection:"Maintenance",body:this.serviceForm}).then((function(){e&&t.$emit("hideInterface")})).catch((function(e){return console.error(e)})).finally((function(){return t.loader=!1}))}}),watch:{dateSubmitted:function(){this.friendlyDate="".concat(le()(this.dateSubmitted).format("DD [de] MMMM")),this.serviceForm.schedule.scheduledDate=this.dateSubmitted},tab:function(){this.step=0},serialNotSubmitted:function(){this.serialNotSubmitted?this.selectedProduct.serialCode="SIN SERIAL":this.selectedProduct.serialCode=""}}}),nn=an,rn=a("71a3"),on=a("c671"),cn=a("fe57"),sn=a("aac8"),ln=a("9a96"),un=Object(v["a"])(nn,en,tn,!1,null,null,null),dn=un.exports;b()(un,{VAutocomplete:Pe["a"],VBtn:j["a"],VCard:N["a"],VCardActions:pe["a"],VCardSubtitle:pe["b"],VCardText:pe["c"],VCardTitle:pe["d"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VIcon:g["a"],VRow:T["a"],VSelect:et["a"],VStepper:bt["a"],VStepperContent:ht["a"],VStepperStep:gt["a"],VSwitch:ze["a"],VTab:rn["a"],VTabItem:on["a"],VTabs:cn["a"],VTabsItems:sn["a"],VTabsSlider:ln["a"],VTextField:Re["a"],VTextarea:yt["a"]});var mn={name:"ScheduledMaintenances",components:{MaintenanceForm:Ue,MaintenanceUpdate:at,MaintenanceValidation:dn},props:["maintenances","mobile","collections","pendingMaintenance"],data:function(){return{tab:0,editInterface:!1,inventoryInterface:!1,updateInterface:!1,validateInterface:!1,dialog:!1,headers:[{text:"Cliente",value:"clientName"},{text:"Oficina",value:"officeName"},{text:"Técnico",value:"schedule.technician.fullName"},{text:"Acciones",value:"actions"}],serviceMenu:[{action:"edit",title:"Reasignar",icon:"mdi-account-arrow-left",minRole:2},{action:"update",title:"Actualizar",icon:"mdi-file-refresh-outline",minRole:2},{action:"delete",title:"Eliminar",icon:"mdi-delete",minRole:1}],selectedService:{}}},computed:{scheduledMaintenances:function(){return this.maintenances.filter((function(e){return!e.finished}))},finishedMaintenances:function(){return this.maintenances.filter((function(e){return"Culminado"===e.status||"Por culminar"===e.status}))}},methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["deleteDocument"])),{},{hideInterface:function(e){this.dialog=!1,this["".concat(e,"Interface")]=!1},confirmDelete:function(e){confirm("Esta acción es irreversible, por favor confirme")&&this.deleteDocument({collection:"Maintenance",body:e})},showDialog:function(e,t){if("delete"===e)return this.confirmDelete(t);this.selectedService=Object.assign({},t),this["".concat(e,"Interface")]=!0,this.dialog=!0}})},fn=mn,vn=Object(v["a"])(fn,Ja,Ka,!1,null,null,null),pn=vn.exports;b()(vn,{VBtn:j["a"],VCard:N["a"],VContainer:h["a"],VDataTable:It["a"],VDialog:Mt["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemContent:k["a"],VListItemGroup:$t["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VMenu:P["a"],VTab:rn["a"],VTabItem:on["a"],VTabs:cn["a"],VTabsItems:sn["a"],VTabsSlider:ln["a"]});var bn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-data-table",{attrs:{items:e.formOptions.clients,headers:e.table1Headers},scopedSlots:e._u([{key:"item.offices",fn:function(t){var n=t.item;return[a("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{icon:"",color:"primary"}},n),[a("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[a("v-list",{attrs:{color:"primary",dark:"",dense:""}},[a("v-list-item-group",e._l(e.serviceMenu,(function(t,i){return a("v-list-item",{key:i,on:{click:function(a){return e.showBottomSheet(n.clientName,t.action,t.title)}}},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" "+e._s(t.title)+" ")])],1)],1)})),1)],1)],1)]}}])}),a("v-bottom-sheet",{attrs:{scrollable:""},model:{value:e.bottomSheet,callback:function(t){e.bottomSheet=t},expression:"bottomSheet"}},[a("v-card",[a("Header",{attrs:{closable:"1",title:e.bottomSheetTitle,subtitle:e.bottomSheetSubtitle},on:{hideInterface:function(t){e.bottomSheet=!1}}}),a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:e.mobile?6:2}},[a("v-text-field",{attrs:{"prepend-inner-icon":"mdi-magnify"},model:{value:e.tableFilter,callback:function(t){e.tableFilter=t},expression:"tableFilter"}})],1)],1),a("v-data-table",{attrs:{items:e.maintenanceData,search:e.tableFilter,headers:e.table2Headers},scopedSlots:e._u([{key:"item.lastMaintenance",fn:function(t){var n=t.item;return[n.lastMaintenance?a("span",[e._v(e._s(e._f("friendlyDate")(n.lastMaintenance)))]):a("span",[e._v("No registrado")])]}},{key:"item.actions",fn:function(t){var n=t.item;return[a("v-btn",{attrs:{small:"",icon:"",color:"primary"},on:{click:function(t){return e.showInventory(n)}}},[a("v-icon",[e._v("mdi-magnify")])],1),"Por atender"===e.bottomSheetSubtitle?a("v-btn",{attrs:{small:"",icon:"",color:"primary"},on:{click:function(t){return e.assignMaintenance(n)}}},[a("v-icon",[e._v("mdi-account-arrow-left")])],1):e._e()]}}])})],1)],1)],1),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.inventoryInterface?a("OfficeInventory",{attrs:{mobile:e.mobile,inventory:e.selectedInventory},on:{hideInterface:function(t){return e.hideInterface("inventory")}}}):e._e(),e.assignInterface?a("MaintenanceForm",{attrs:{startTemplate:e.startTemplate,collections:e.collections,mobile:e.mobile,pendingMaintenance:e.formOptions.pendingMaintenance},on:{hideInterface:function(t){return e.hideInterface("assign")}}}):e._e()],1)],1)],1)},hn=[],gn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Inventario",subtitle:"Último mantenimiento"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-card",[a("v-card-text",[a("v-tabs",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"accent"}}),e._l(e.productTypes,(function(t,n){return a("v-tab",{key:n},[e._v(" "+e._s(t.productType)+" ")])}))],2),e.productTypes.length?a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},e._l(e.productTypes,(function(t,n){return a("v-tab-item",{key:n},[a("v-data-table",{attrs:{items:t.registeredProducts,headers:e.headers}})],1)})),1):a("v-card-title",[e._v("Información no registrada")])],1)],1)],1)},yn=[],Cn={name:"OfficeInventory",components:{Header:ce},props:["inventory","mobile"],data:function(){return{tab:0,headers:[{text:"Producto",value:"productName"},{text:"Serial",value:"serialCode"}]}},computed:{productTypes:function(){var e=this,t=this.inventory.map((function(e){return e.productType}));t=new Set(Object(J["a"])(t));var a,n=[],i=Object(Z["a"])(t);try{var r=function(){var t=a.value,i=e.inventory.filter((function(e){return e.productType===t}));n.push({productType:t,registeredProducts:i})};for(i.s();!(a=i.n()).done;)r()}catch(o){i.e(o)}finally{i.f()}return n}}},kn=Cn,xn=Object(v["a"])(kn,gn,yn,!1,null,null,null),_n=xn.exports;b()(xn,{VCard:N["a"],VCardText:pe["c"],VCardTitle:pe["d"],VContainer:h["a"],VDataTable:It["a"],VTab:rn["a"],VTabItem:on["a"],VTabs:cn["a"],VTabsItems:sn["a"],VTabsSlider:ln["a"]});var Dn={name:"PreventivePanels",components:{Header:ce,OfficeInventory:_n,MaintenanceForm:Ue},props:["collections","mobile","finishedMaintenance"],data:function(){return{inventoryInterface:!1,assignInterface:!1,bottomSheet:!1,bottomSheetTitle:"",bottomSheetSubtitle:"",tableFilter:"",serviceMenu:[{action:"finished",title:"Atendidas",icon:"mdi-check"},{action:"pending",title:"Por atender",icon:"mdi-exclamation"}],table1Headers:[{text:"Cliente",value:"clientName"},{text:"Oficinas",value:"offices"}],table2Headers:[{text:"Oficina",value:"officeName"},{text:"Último mantenimiento",value:"lastMaintenance"},{text:"Acciones",value:"actions"}],startTemplate:{},maintenanceData:[],dialog:!1,selectedInventory:[]}},filters:{friendlyDate:function(e){return le()(e).parseZone("America/Caracas").format("DD [de] MMMM [de] YYYY")}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["selectedDocument"])),Object(l["c"])(["formOptions"])),methods:Object(o["a"])(Object(o["a"])({},Object(l["d"])(["showSnackbar"])),{},{activeContract:function(e){return e.contracts.find((function(e){return e.active}))},showBottomSheet:function(e,t,a){this.maintenanceData="finished"===t?this.finishedMaintenance.filter((function(t){return t.clientName===e})):this.formOptions.pendingMaintenance.filter((function(t){return t.clientName===e})),this.bottomSheetTitle=e,this.bottomSheetSubtitle=a,this.bottomSheet=!0},showInventory:function(e){if(this.selectedInventory=this.collections.Office.find((function(t){return t.officeName===e.officeName})).inventory,!this.selectedInventory.length)return this.showSnackbar({message:"El inventario no se ha registrado aún"});this.dialog=!0,this.inventoryInterface=!0},assignMaintenance:function(e){var t=this.collections.Maintenance.find((function(t){return t.officeName===e.officeName}));if(t)return this.showSnackbar({message:"Registrado actualmente"});this.assignInterface=!0,this.startTemplate={clientName:e.clientName,officeName:e.officeName},this.dialog=!0},hideInterface:function(e){this["".concat(e,"Interface")]=!1,this.dialog=!1}})},wn=Dn,On=Object(v["a"])(wn,bn,hn,!1,null,null,null),Sn=On.exports;b()(On,{VBottomSheet:qt["a"],VBtn:j["a"],VCard:N["a"],VCardText:pe["c"],VCol:I["a"],VDataTable:It["a"],VDialog:Mt["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemContent:k["a"],VListItemGroup:$t["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VMenu:P["a"],VRow:T["a"],VTextField:Re["a"]});var Vn={name:"Preventive",components:{Header:ce,MainButton:ea,MaintenancePanels:Sn,MaintenanceForm:Ue,MaintenanceTable:pn},data:function(){return{dialog:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections","loading"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},thisYearFirst:function(){return"".concat(le()(new Date).format("yyyy"),"-01-01")},finishedMaintenance:function(){var e="".concat(le()(new Date).format("yyyy"),"-01-01"),t=le()(e).add(1,"y").format();return this.collections.Office.filter((function(a){return a.lastMaintenance>e&&a.lastMaintenance<t}))}})},Fn=Vn,jn=Object(v["a"])(Fn,Wa,Za,!1,null,null,null),Nn=jn.exports;b()(jn,{VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDialog:Mt["a"],VRow:T["a"],VSkeletonLoader:ie["a"]});var In=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Consultas",subtitle:"Especifique los valores para realizar una consulta"}}),a("v-sheet",{staticClass:"px-3"},[a("v-row",{attrs:{align:"center"}},[a("v-col",[a("v-tabs",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"accent"}}),a("v-tab",[e._v("Filtro")]),a("v-tab",{attrs:{disabled:!e.result.length}},[e._v("Resultado")])],1)],1),a("v-col",[a("QueryChips",{directives:[{name:"show",rawName:"v-show",value:!e.tab,expression:"!tab"}],on:{submitQuery:e.searchCorrective}})],1)],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("v-form",{ref:"form"},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:6}},[a("v-radio-group",{attrs:{row:""},model:{value:e.serviceType,callback:function(t){e.serviceType=t},expression:"serviceType"}},e._l(["Correctivo","Preventivo"],(function(e,t){return a("v-radio",{key:t,staticClass:"ml-2",attrs:{label:e,value:e}})})),1)],1),a("v-col",{attrs:{align:"end"}},[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.tab,expression:"!tab"}],staticClass:"my-1",attrs:{block:e.mobile,color:"accent",small:""},on:{click:e.clearFilter}},[a("v-icon",[e._v("mdi-broom")])],1)],1)],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-autocomplete",{attrs:{label:"Cliente",items:e.formOptions.clientNames},model:{value:e.filter.clientName,callback:function(t){e.$set(e.filter,"clientName",t)},expression:"filter.clientName"}})],1)],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-select",{attrs:{items:["Dentro del acuerdo","Fuera del acuerdo"],disabled:"Preventivo"===e.serviceType,label:"S. L. A.",solo:""},model:{value:e.sla,callback:function(t){e.sla=t},expression:"sla"}})],1),a("v-col",[a("v-select",{attrs:{items:e.statusOptions,disabled:"Preventivo"===e.serviceType,label:"Status",solo:""},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}})],1)],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-select",{attrs:{items:e.formOptions.productTypes,label:"Producto",solo:""},model:{value:e.filter.productType,callback:function(t){e.$set(e.filter,"productType",t)},expression:"filter.productType"}})],1)],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-autocomplete",{attrs:{items:e.formOptions.technicians,label:"Personal asignado"},model:{value:e.technician,callback:function(t){e.technician=t},expression:"technician"}})],1)],1)],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-row",{staticClass:"mt-4"},[a("v-col",[a("v-date-picker",{attrs:{color:"primary",range:"","full-width":"","no-title":"",min:e.minDate},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1)],1),a("small",{staticClass:"font-weight-bold"},[e._v("Filtrar por fecha de:")]),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-radio-group",{attrs:{row:"",disabled:"Preventivo"===e.serviceType},model:{value:e.dateFilter,callback:function(t){e.dateFilter=t},expression:"dateFilter"}},e._l(["reportedAt","schedule.scheduledDate"],(function(e,t){return a("v-radio",{key:t,attrs:{label:"reportedAt"===e?"Reporte":"Atención",value:e}})})),1)],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-chip-group",{attrs:{color:"accent"}},[a("v-icon",[e._v("mdi-filter")]),a("v-chip",{attrs:{small:""},on:{click:function(t){return e.dateQuickFilter("thisYear")}}},[e._v(e._s(e.thisYear))]),a("v-chip",{attrs:{small:""},on:{click:function(t){return e.dateQuickFilter("thisMonth")}}},[e._v(e._s(e.thisMonth))]),a("v-chip",{attrs:{small:""},on:{click:function(t){return e.dateQuickFilter("lastMonth")}}},[e._v(e._s(e.lastMonth))])],1)],1)],1),a("v-btn",{staticClass:"mb-15 mr-10",attrs:{fixed:"",absolute:"",bottom:"",right:"",disabled:2!==e.dates.length,color:"primary",fab:"",loading:e.loader},on:{click:function(t){"Preventivo"===e.serviceType?e.searchInventory(e.filter):e.searchCorrective(e.filter)}}},[a("v-icon",[e._v("mdi-magnify")])],1)],1)],1)],1)],1),a("v-tab-item",[a("v-sheet",[a("QueryResult",{attrs:{xlsFormat:e.xlsFormat,result:e.result}})],1)],1)],1)],1)],1)},Mn=[],$n=a("ade3"),Pn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-chip-group",{attrs:{color:"secondary"}},[a("v-icon",[e._v("mdi-filter")]),a("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-chip",e._g({attrs:{small:""}},n),[e._v("Serial")])]}}])},[a("v-card",{staticClass:"px-7",attrs:{height:"95"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Serial",maxlength:"20",counter:"20"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("submitQuery",{serialCode:e.serialCode})}},model:{value:e.serialCode,callback:function(t){e.serialCode=t},expression:"serialCode"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-btn",{attrs:{fab:"","x-small":"",color:"primary"},on:{click:function(t){return e.$emit("submitQuery",{serialCode:e.serialCode})}}},[a("v-icon",[e._v("mdi-magnify")])],1)],1)],1)],1)],1),a("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-chip",e._g({attrs:{small:""}},n),[e._v("Código")])]}}])},[a("v-card",{staticClass:"px-7",attrs:{height:"95"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Código",maxlength:"20",counter:"20"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("submitQuery",{reportCode:e.reportCode})}},model:{value:e.reportCode,callback:function(t){e.reportCode=t},expression:"reportCode"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-btn",{attrs:{fab:"","x-small":"",color:"primary"},on:{click:function(t){return e.$emit("submitQuery",{reportCode:e.reportCode})}}},[a("v-icon",[e._v("mdi-magnify")])],1)],1)],1)],1)],1),a("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-chip",e._g({attrs:{small:""}},n),[e._v("#Orden")])]}}])},[a("v-card",{staticClass:"px-7",attrs:{height:"95"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"#Orden",maxlength:"20",counter:"20"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("submitQuery",{"documentation.serviceOrder":e.serviceOrder})}},model:{value:e.serviceOrder,callback:function(t){e.serviceOrder=t},expression:"serviceOrder"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-btn",{attrs:{fab:"","x-small":"",color:"primary"},on:{click:function(t){return e.$emit("submitQuery",{"documentation.serviceOrder.number":e.serviceOrder})}}},[a("v-icon",[e._v("mdi-magnify")])],1)],1)],1)],1)],1),a("v-chip",{attrs:{small:""},on:{click:function(t){return e.$emit("submitQuery",{"documentation.serviceOrder.validated":!1})}}},[e._v(" Por validar ")])],1)],1)},Tn=[],Rn={name:"QueryChips",data:function(){return{serviceOrder:"",serialCode:"",reportCode:"",loader:!1}}},An=Rn,qn=Object(v["a"])(An,Pn,Tn,!1,null,null,null),En=qn.exports;b()(qn,{VBtn:j["a"],VCard:N["a"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VIcon:g["a"],VMenu:P["a"],VRow:T["a"],VTextField:Re["a"]});var Ln={name:"Consultation",components:{Header:ce,QueryChips:En,QueryResult:Tt},data:function(){return{filter:{},dateFilter:"schedule.scheduledDate",technician:"",serviceType:"Correctivo",dates:[],sla:"",result:[],tab:0,xlsFormat:[],loader:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},thisYear:function(){return le()(new Date).format("yyyy")},thisMonth:function(){return le()(new Date).format("MMMM")},lastMonth:function(){return le()(new Date).subtract(1,"month").format("MMMM")},minDate:function(){return this.dates[0]&&!this.dates[1]?this.dates[0]:""},statusOptions:function(){return["Cerrado - Operativo","Cerrado - Reemplazado","Cerrado - Desincorporado"]}}),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{dateQuickFilter:function(e){this.dates=[];var t="".concat(le()(new Date).format("yyyy-MM-"),"01"),a=le()(t).add(1,"M").format("YYYY-MM-DD");switch(e){case"thisMonth":a=le()(a).subtract(1,"days").format("YYYY-MM-DD"),this.dates.push(t),this.dates.push(a);break;case"lastMonth":a=t,t=le()(t).subtract(1,"M").format("YYYY-MM-DD"),a=le()(a).subtract(1,"days").format("YYYY-MM-DD"),this.dates.push(t),this.dates.push(a);break;case"thisYear":t="".concat(le()(new Date).format("yyyy"),"-01-01"),a=le()(t).add(1,"Y").format("yyyy-MM-DD"),a=le()(a).subtract(1,"days").format("YYYY-MM-DD"),this.dates.push(t),this.dates.push(a);break;default:break}},clearFilter:function(){this.filter={},this.dates=[],this.technician="",this.sla=""},searchCorrective:function(e){var t=this;this.loader=!0,Promise.all([this.findDocuments({collection:"Closed",filter:e}),this.findDocuments({collection:"Active",filter:e})]).then((function(e){t.result=[].concat(Object(J["a"])(e[0]),Object(J["a"])(e[1])),t.showSnackbar({message:"Resultados de su búsqueda: ".concat(t.result.length)}),t.result.length>0&&t.reportXlsFormat(t.result),t.loader=!1})).catch((function(){return t.loader=!1}))},discardProps:function(e){return delete e.expired,delete e.status,e},searchInventory:function(e){var t=this;this.loader=!0,e=this.discardProps(e),console.log(e),this.findDocuments({collection:"Inventory",filter:e}).then((function(e){t.result=e,console.log(e),t.result.length&&t.inventoryXlsFormat(t.result),t.showSnackbar({message:"Resultados de su búsqueda: ".concat(t.result.length)}),t.loader=!1})).catch((function(){return t.loader=!1}))},reportXlsFormat:function(e){var t=[];for(var a in e){var n,i=e[a].documentation.filter((function(e){return e.visit})),r=i.length,o=r?i[r-1]:null,c=o?o.observations:e[a].documentation[e[a].documentation.length-1].observations,s=o?le()(o.date).parseZone("America/Caracas").format("L LT"):le()(e[a].schedule.scheduledDate).parseZone("America/Caracas").format("L LT"),l=[],u=Object(Z["a"])(e[a].pieces);try{for(u.s();!(n=u.n()).done;){var d=n.value;l.push("".concat(d.pieceName," (").concat(d.quantity,")"))}}catch(m){u.e(m)}finally{u.f()}t.push({Fecha_reporte:le()(e[a].reportedAt).parseZone("America/Caracas").format("L LT"),Fecha_atencion:s,Cliente:e[a].clientName,Oficina:e[a].officeName,Estado:e[a].officeState,Region:e[a].officeRegion,Reporte:e[a].reportCode,Producto:e[a].productName,Serial:e[a].serialCode,Falla:e[a].description,Documentacion:c,Status:e[a].status,SLA:e[a].expired?"Fuera del acuerdo":"Dentro del acuerdo",Tecnico:o?o.technician.fullName:e[a].schedule.technician.fullName,Categoria:e[a].category,Repuestos:l,Visitas:r,Zona:e[a].isLocal?"Local":"Foránea"})}this.xlsFormat=t,this.tab=1},inventoryXlsFormat:function(e){var t=[];for(var a in e)t.push({Cliente:e[a].clientName,Oficina:e[a].officeName,Estado:e[a].officeState,Region:e[a].officeRegion,Producto:e[a].productName,Serial:e[a].serialCode,"Ubicación":e[a].location,Status:e[a].status,"Técnico":e[a].schedule.technician.fullName,Fecha_atencion:e[a].schedule.scheduledDate,Orden_servicio:e[a].serviceOrder,Observaciones:e[a].observations});this.xlsFormat=t,this.tab=1},assembleFilter:function(){var e="Preventivo"===this.serviceType?"schedule.scheduledDate":this.dateFilter;this.filter["$and"]=[Object($n["a"])({},e,{$gte:this.dates[0]}),Object($n["a"])({},e,{$lte:this.dates[1]}),{"schedule.technician.fullName":this.technician.fullName}]}}),watch:{sla:function(){this.filter.expired="Fuera del acuerdo"===this.sla},technician:function(){this.assembleFilter()},serviceType:function(){this.assembleFilter()},dates:function(){this.assembleFilter()},dateFilter:function(){this.assembleFilter()}}},Hn=Ln,Bn=Object(v["a"])(Hn,In,Mn,!1,null,null,null),Yn=Bn.exports;b()(Bn,{VAutocomplete:Pe["a"],VBtn:j["a"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VDatePicker:Ve["a"],VForm:Te["a"],VIcon:g["a"],VRadio:vt["a"],VRadioGroup:pt["a"],VRow:T["a"],VSelect:et["a"],VSheet:Yt["a"],VTab:rn["a"],VTabItem:on["a"],VTabs:cn["a"],VTabsItems:sn["a"],VTabsSlider:ln["a"]});var zn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Artículos",subtitle:"Administre las piezas registradas"}}),a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{md:"3"}},[a("v-text-field",{attrs:{"prepend-inner-icon":"mdi-magnify",label:"Filtrar"},model:{value:e.tableFilter,callback:function(t){e.tableFilter=t},expression:"tableFilter"}})],1)],1),a("v-data-table",{attrs:{headers:e.headers,items:e.collections.Piece,search:e.tableFilter},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-btn",{staticClass:"ma-1",attrs:{small:"",color:"secondary"},on:{click:function(t){return e.showPieceForm(null)}}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" Agregar ")],1)]},proxy:!0},{key:"item.actions",fn:function(t){var n=t.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.showPieceForm(n)}}},[e._v(" mdi-pencil ")]),a("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(n)}}},[e._v(" mdi-delete ")])]}}])}),a("v-dialog",{attrs:{"max-width":"500px",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.dialog?a("PieceForm",{attrs:{editing:e.selectedDocument,collections:e.collections,mobile:e.mobile},on:{hideInterface:e.hideInterface}}):e._e()],1)],1)],1)},Gn=[],Un=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información del formulario"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-card-text",[a("v-form",{ref:"form",model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("v-row",[a("v-text-field",{staticClass:"mx-1",attrs:{rules:e.rules.required,maxlength:"30",counter:"30",label:"Código"},model:{value:e.pieceForm.code,callback:function(t){e.$set(e.pieceForm,"code",t)},expression:"pieceForm.code"}})],1),a("v-row",[a("v-text-field",{staticClass:"mx-1",attrs:{rules:e.rules.required,label:"Nombre",counter:"140",maxlength:"140",hint:"Nombre para mostrar al usuario"},model:{value:e.pieceForm.pieceName,callback:function(t){e.$set(e.pieceForm,"pieceName",t)},expression:"pieceForm.pieceName"}})],1),a("v-row",[a("v-textarea",{staticClass:"mx-1",attrs:{label:"Descripción",counter:"140",maxlength:"140",rows:"1","auto-grow":"",rules:e.rules.required},model:{value:e.pieceForm.description,callback:function(t){e.$set(e.pieceForm,"description",t)},expression:"pieceForm.description"}})],1),a("v-row",[a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{label:"Stock",type:"number"},model:{value:e.pieceForm.stock,callback:function(t){e.$set(e.pieceForm,"stock",t)},expression:"pieceForm.stock"}})],1),a("v-col",{attrs:{cols:"9"}},[a("v-select",{attrs:{label:"Categoria",items:e.collections.Product.map((function(e){return e.productType}))},model:{value:e.pieceForm.pieceCategory,callback:function(t){e.$set(e.pieceForm,"pieceCategory",t)},expression:"pieceForm.pieceCategory"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-autocomplete",{attrs:{"allow-overflow":"","deletable-chips":"",multiple:"","small-chips":"",items:e.filteredItems.map((function(e){return e.productName})),label:"Productos asociados"},model:{value:e.pieceForm.asociatedProducts,callback:function(t){e.$set(e.pieceForm,"asociatedProducts",t)},expression:"pieceForm.asociatedProducts"}})],1)],1)],1)],1),a("v-card-actions",[a("v-btn",{staticClass:"mx-auto",attrs:{disabled:!e.form,loading:e.loader,color:"primary",block:""},on:{click:function(t){return e.save(e.pieceForm)}}},[e._v(" Guardar ")])],1)],1)},Qn=[],Xn={name:"PieceForm",components:{Header:ce},props:["collections","mobile","editing"],data:function(){return{form:!1,loader:!1,pieceForm:{asociatedProducts:[],pieceName:"",stock:"",pieceCategory:"",code:"",description:""},defaultItem:{asociatedProducts:[],pieceName:"",stock:99,pieceCategory:"",code:"",description:""},rules:Ie["rules"]}},created:function(){if(this.editing)return this.pieceForm=Object.assign({},this.editing);this.pieceForm=Object.assign({},this.defaultItem)},computed:{filteredItems:function(){var e=this,t=this.collections.Product.filter((function(t){return t.productType===e.pieceForm.pieceCategory}));return t},requiresMassiveUpdate:function(){return this.editing?this.editing.pieceName!==this.pieceForm.pieceName:void 0}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["d"])(["showSnackbar"])),Object(l["b"])(["createDocument","updateDocument","updateDocuments","findDocuments"])),{},{preventDuplicity:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.code,i=e._id,r={code:n,_id:{$ne:i||null}},a.next=4,t.findDocuments({collection:"Piece",filter:r});case 4:if(o=a.sent,!o.length){a.next=9;break}return a.abrupt("return",(t.showSnackbar({message:"Registrado anteriormente, verifique el código"}),!0));case 9:return a.abrupt("return",!1);case 10:case"end":return a.stop()}}),a)})))()},save:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loader=!0,a.next=3,t.preventDuplicity(e);case 3:if(n=a.sent,!n){a.next=6;break}return a.abrupt("return",t.loader=!1);case 6:if(!t.editing){a.next=10;break}return a.abrupt("return",t.update({collection:"Piece",body:e}));case 10:t.create({collection:"Piece",body:e});case 11:case"end":return a.stop()}}),a)})))()},update:function(e){var t=this;this.updateDocument(e).then((function(){t.requiresMassiveUpdate&&t.updateDependencies(e)})).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},updateDependencies:function(e){var t,a=e.body,n=[],i={pieceName:this.editing.pieceName},r={pieceName:a.pieceName},o=this.dependencies(i,r),c=Object(Z["a"])(o);try{for(c.s();!(t=c.n()).done;){var s=t.value;n.push(this.updateDocuments(s))}}catch(l){c.e(l)}finally{c.f()}Promise.all(n)},dependencies:function(e,t){return[{collection:"Active",query:{"pieces.pieceName":e.pieceName},update:{$set:{"pieces.$[piece].pieceName":t.pieceName}},options:{arrayFilters:[{"piece.pieceName":e.pieceName}]}},{collection:"Closed",query:{"pieces.pieceName":e.pieceName},update:{$set:{"pieces.$[piece].pieceName":t.pieceName}},options:{arrayFilters:[{"piece.pieceName":e.pieceName}]}},{collection:"Request",query:e,update:t,options:{}},{collection:"Dispatch",query:e,update:t,options:{}}]},create:function(e){var t=this;this.createDocument(e).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))}})},Wn=Xn,Zn=Object(v["a"])(Wn,Un,Qn,!1,null,null,null),Jn=Zn.exports;b()(Zn,{VAutocomplete:Pe["a"],VBtn:j["a"],VCardActions:pe["a"],VCardText:pe["c"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VRow:T["a"],VSelect:et["a"],VTextField:Re["a"],VTextarea:yt["a"]});var Kn={name:"Pieces",components:{Header:ce,PieceForm:Jn},data:function(){return{tableFilter:"",headers:[{text:"Descripción",align:"start",value:"description"},{text:"Código",value:"code"},{text:"Categoria",value:"pieceCategory"},{text:"Acciones",value:"actions",sortable:!1}],dialog:!1,selectedDocument:{}}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}}),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["deleteDocument"])),{},{showPieceForm:function(e){this.selectedDocument=e?Object.assign({},e):null,this.dialog=!0},hideInterface:function(){this.dialog=!1,this.selectedDocument=Object.assign({},{})},deleteItem:function(e){confirm("Por favor confirme que desea eliminar este artículo")&&this.deleteDocument({collection:"Piece",body:e})}})},ei=Kn,ti=Object(v["a"])(ei,zn,Gn,!1,null,null,null),ai=ti.exports;b()(ti,{VBtn:j["a"],VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDataTable:It["a"],VDialog:Mt["a"],VIcon:g["a"],VRow:T["a"],VTextField:Re["a"]});var ni=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Solicitudes",subtitle:"Gestione la reposición del stock de repuestos"}}),a("v-sheet",[a("v-row",{attrs:{align:"center"}},[a("v-col",{staticClass:"ml-2",attrs:{md:"3"}},[a("v-text-field",{attrs:{"prepend-inner-icon":"mdi-magnify",label:"Filtrar"},model:{value:e.tableFilter,callback:function(t){e.tableFilter=t},expression:"tableFilter"}})],1)],1),a("v-data-table",{staticClass:"elevation-2",attrs:{headers:e.headers,items:e.requestPerService,search:e.tableFilter},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-dialog",{attrs:{fullscreen:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.dialog?a("RequestDetails",{attrs:{originalItem:e.originalItem,selectedDocument:e.selectedDocument},on:{hideInterface:function(t){e.dialog=!1}}}):e._e()],1)],1)]},proxy:!0},{key:"item.actions",fn:function(t){var n=t.item;return[a("v-btn",{attrs:{color:"primary",small:""},on:{click:function(t){return e.editItem(n)}}},[a("v-icon",[e._v(" mdi-magnify ")])],1)]}}])})],1)],1)},ii=[],ri=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Información de solicitud",subtitle:"Servicio: "+e.selectedDocument.reportCode},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-form",{ref:"form",model:{value:e.formStatus,callback:function(t){e.formStatus=t},expression:"formStatus"}},[a("v-tabs",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"accent"}}),a("v-tab",[e._v("Detalles")]),a("v-tab",[e._v("Despacho")])],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("v-card",{attrs:{"min-height":"500",flat:""}},[a("v-row",{attrs:{justify:"space-around"}},[a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-list",[a("v-list-item-group",{attrs:{color:"primary"}},e._l(e.listItems,(function(t,n){return a("v-list-item",{key:n},[a("v-list-item-icon",[a("v-icon",[e._v(e._s(t.icon))])],1),a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.title)}})],1)],1)})),1)],1)],1),a("v-col",{attrs:{cols:e.mobile?12:6}},e._l(e.selectedDocument.requests,(function(t,n){return a("v-row",{key:n,attrs:{align:"center"}},[a("v-col",{attrs:{cols:"9"}},[a("v-select",{attrs:{items:e.filteredListOfPieces,rules:e.rules.required,hint:t.replacementCause,"persistent-hint":""},model:{value:t.pieceName,callback:function(a){e.$set(t,"pieceName",a)},expression:"item.pieceName"}})],1),a("v-col",{attrs:{cols:"3"}},[a("v-btn",{attrs:{disabled:e.userNotAuthorized,small:"",color:"error"},on:{click:function(a){return e.deleteItem(t)}}},[a("v-icon",[e._v("mdi-delete")])],1)],1)],1)})),1)],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{"min-height":"500",flat:""}},[a("v-row",{attrs:{justify:"space-around"}},[a("v-col",{staticClass:"mt-1",attrs:{cols:e.mobile?12:4}},[a("v-row",[a("v-col",[a("v-select",{attrs:{items:e.formOptions.technicians,"prepend-inner-icon":"mdi-account-arrow-left",label:"Destinatario"},on:{change:function(t){e.content=[]}},model:{value:e.technician,callback:function(t){e.technician=t},expression:"technician"}})],1)],1),a("v-row",[a("v-col",[a("v-menu",{attrs:{transition:"scale-transition","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{readonly:"",label:"Fecha de despacho",rules:e.rules.required,"prepend-inner-icon":"mdi-calendar-question"},model:{value:e.dispatch.date,callback:function(t){e.$set(e.dispatch,"date",t)},expression:"dispatch.date"}},"v-text-field",i,!1),n))]}}]),model:{value:e.menu1,callback:function(t){e.menu1=t},expression:"menu1"}},[a("v-date-picker",{attrs:{"first-day-of-week":"1",locale:"es","no-title":""},on:{input:function(t){e.menu1=!1}},model:{value:e.dispatch.date,callback:function(t){e.$set(e.dispatch,"date",t)},expression:"dispatch.date"}})],1)],1)],1),a("v-row",[a("v-col",[a("v-select",{attrs:{items:["MRW","Entrega personal"],label:"Método","prepend-inner-icon":"mdi-truck-fast-outline"},model:{value:e.dispatch.method,callback:function(t){e.$set(e.dispatch,"method",t)},expression:"dispatch.method"}})],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"Oficina destino",rules:"Entrega personal"===e.dispatch.method?[]:e.rules.required,"prepend-inner-icon":"mdi-store",readonly:"Entrega personal"===e.dispatch.method},model:{value:e.dispatch.destiny,callback:function(t){e.$set(e.dispatch,"destiny",t)},expression:"dispatch.destiny"}})],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:"Referencia",rules:"Entrega personal"===e.dispatch.method?[]:e.rules.required,"prepend-inner-icon":"mdi-barcode",readonly:"Entrega personal"===e.dispatch.method},model:{value:e.dispatch.reference,callback:function(t){e.$set(e.dispatch,"reference",t)},expression:"dispatch.reference"}})],1),a("v-col",[a("v-text-field",{attrs:{label:"Costo",rules:"Entrega personal"===e.dispatch.method?[]:e.rules.required,"prepend-inner-icon":"mdi-cash",hint:e._f("formatNumberAsUSD")(e.dispatch.cost),readonly:"Entrega personal"===e.dispatch.method},model:{value:e.dispatch.cost,callback:function(t){e.$set(e.dispatch,"cost",t)},expression:"dispatch.cost"}})],1)],1)],1),a("v-col",{staticClass:"mt-6",attrs:{cols:e.mobile?12:6}},e._l(e.selectedDocument.requests,(function(t,n){return a("v-row",{key:n,attrs:{justify:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:8}},[a("v-checkbox",{staticClass:"my-0",attrs:{value:t,label:t.pieceName},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)],1)})),1)],1)],1)],1),a("v-app-bar",{attrs:{dense:"",bottom:""}},[a("v-row",[a("v-col",{attrs:{align:"center"}},[a("v-btn",{attrs:{color:"primary",disabled:!e.formStatus||!e.content.length||e.userNotAuthorized,loading:e.loading},on:{click:function(t){return e.save(e.dispatch)}}},[e._v(" Despachar selección ")])],1)],1)],1)],1)],1)],1)},oi=[],ci={name:"RequestDetails",components:{Header:ce},props:["originalItem","selectedDocument"],data:function(){return{rules:Ie["rules"],tab:0,formStatus:!1,loading:!1,menu1:!1,courierCompany:"",courierOffice:"",content:[],technician:"",dispatch:{destiny:"",cost:"",date:"",method:"",reference:""}}},filters:{formatNumberAsUSD:function(e){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"USD"}).format(e)}},created:function(){this.technician=this.selectedDocument.technician},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections"])),Object(l["c"])(["formOptions"])),{},{userNotAuthorized:function(){return"Almacén"!==this.$store.state.session.user.department},listItems:function(){return[{icon:"mdi-email-newsletter",title:"#Reporte: ".concat(this.selectedDocument.reportCode)},{icon:"mdi-account-tie",title:"Cliente: ".concat(this.selectedDocument.clientName)},{icon:"mdi-bank",title:"Oficina: ".concat(this.selectedDocument.officeName)},{icon:"mdi-printer",title:"Producto: ".concat(this.selectedDocument.productName)},{icon:"mdi-calendar",title:"Fecha de solicitud: ".concat(this.selectedDocument.requestDate)},{icon:"mdi-phone",title:"Cliente: ".concat(this.selectedDocument.requestedBy)}]},mobile:function(){return this.$vuetify.breakpoint.sm||this.$vuetify.breakpoint.xs},filteredListOfPieces:function(){var e,t=this,a=[];for(var n in this.collections.Piece)e=this.collections.Piece[n].asociatedProducts.find((function(e){return e===t.selectedDocument.productName})),void 0!==e&&a.push(this.collections.Piece[n]);return a=a.map((function(e){return e.pieceName})),a}}),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","deleteDocument"])),{},{deleteItem:function(e){confirm("Esta acción es irreversible")&&this.confirmDelete(e)},confirmDelete:function(e){var t=this;this.deleteDocument({collection:"Request",body:e}).then((function(){return t.$emit("hideInterface")}))},save:function(e){this.loading=!0;var t,a=[],n=[],i=Object(Z["a"])(this.content);try{for(i.s();!(t=i.n()).done;){var r=t.value;r.dispatch=e,r.technician=this.technician,a.push(this.createDocument({collection:"Dispatch",body:r})),n.push(this.deleteDocument({collection:"Request",body:r}))}}catch(o){i.e(o)}finally{i.f()}this.createDispatch(a,n)},createDispatch:function(e,t){var a=this;Promise.all(e).then((function(){return a.deleteRequest(t)})).catch((function(){return a.loading=!0}))},deleteRequest:function(e){var t=this;Promise.all(e).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loading=!0}))}})},si=ci,li=a("ac7c"),ui=Object(v["a"])(si,ri,oi,!1,null,null,null),di=ui.exports;b()(ui,{VAppBar:S["a"],VBtn:j["a"],VCard:N["a"],VCheckbox:li["a"],VCol:I["a"],VContainer:h["a"],VDatePicker:Ve["a"],VForm:Te["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemContent:k["a"],VListItemGroup:$t["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VMenu:P["a"],VRow:T["a"],VSelect:et["a"],VTab:rn["a"],VTabItem:on["a"],VTabs:cn["a"],VTabsItems:sn["a"],VTabsSlider:ln["a"],VTextField:Re["a"]});var mi={name:"Requests",components:{Header:ce,RequestDetails:di},data:function(){return{tableFilter:"",headers:[{text:"F. Solicitud",value:"requestDate"},{text:"Reporte",value:"reportCode"},{text:"Técnico",value:"technician.fullName"},{text:"Cliente",value:"clientName"},{text:"Oficina",value:"officeName"},{text:"Acciones",value:"actions"}],dialog:!1,selectedDocument:{},originalItem:{},timeout:4e3}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections"])),{},{requestPerService:function(){var e=this,t=this.collections.Request.map((function(e){return e.reportCode}));t=Object(J["a"])(new Set(t));var a=[],n=function(n){var i=e.collections.Request.filter((function(e){return e.reportCode===t[n]}));a.push({reportCode:i[0].reportCode,technician:i[0].technician,clientName:i[0].clientName,officeName:i[0].officeName,productName:i[0].productName,courierCompany:"",courierOffice:"",dispatchDate:le()(new Date).format("YYYY-MM-DD"),requestDate:le()(i[0].requestDate).format("DD [de] MMMM"),requestedBy:i[0].requestedBy,requests:i})};for(var i in t)n(i);return a}}),methods:{editItem:function(e){this.selectedDocument=Object.assign({},e),this.originalItem=JSON.parse(JSON.stringify(e)),this.dialog=!0}}},fi=mi,vi=Object(v["a"])(fi,ni,ii,!1,null,null,null),pi=vi.exports;b()(vi,{VBtn:j["a"],VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDataTable:It["a"],VDialog:Mt["a"],VIcon:g["a"],VRow:T["a"],VSheet:Yt["a"],VTextField:Re["a"]});var bi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Despachos",subtitle:"Especifique los parámetros y realice una consulta"}}),a("v-sheet",{staticClass:"px-3"},[a("v-tabs",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"accent"}}),a("v-tab",[e._v("Filtro")]),a("v-tab",{attrs:{disabled:!e.result.length}},[e._v("Resultado")])],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("v-form",{ref:"form"},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("QueryChips",{on:{submitQuery:e.search}}),a("v-btn",{staticClass:"my-1",attrs:{block:"",small:""},on:{click:e.clearFilter}},[a("v-icon",{attrs:{color:"accent"}},[e._v("mdi-broom")])],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-autocomplete",{attrs:{items:e.formOptions.technicians,label:"Personal asignado"},model:{value:e.filter.technician,callback:function(t){e.$set(e.filter,"technician",t)},expression:"filter.technician"}})],1)],1),e._v(" "),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-autocomplete",{attrs:{label:"Cliente",items:e.formOptions.clientNames},model:{value:e.filter.clientName,callback:function(t){e.$set(e.filter,"clientName",t)},expression:"filter.clientName"}})],1)],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-select",{attrs:{items:e.formOptions.productTypes,label:"Categoria",solo:""},model:{value:e.filter.productType,callback:function(t){e.$set(e.filter,"productType",t)},expression:"filter.productType"}})],1)],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-select",{attrs:{items:e.productsByCategory,label:"Producto",solo:""},model:{value:e.filter.productName,callback:function(t){e.$set(e.filter,"productName",t)},expression:"filter.productName"}})],1)],1)],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-chip-group",{attrs:{color:"accent"}},[a("v-icon",[e._v("mdi-filter")]),a("v-chip",{attrs:{small:""},on:{click:function(t){return e.dateQuickFilter("thisYear")}}},[e._v(e._s(e.thisYear))]),a("v-chip",{attrs:{small:""},on:{click:function(t){return e.dateQuickFilter("thisMonth")}}},[e._v(e._s(e.thisMonth))]),a("v-chip",{attrs:{small:""},on:{click:function(t){return e.dateQuickFilter("lastMonth")}}},[e._v(e._s(e.lastMonth))])],1),a("v-row",{staticClass:"mt-4"},[a("v-col",[a("v-date-picker",{attrs:{color:"primary",range:"","full-width":"","no-title":"",min:e.minDate},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}}),a("v-text-field",{staticClass:"mt-5",attrs:{label:"Rango",readonly:""},model:{value:e.dateRangeText,callback:function(t){e.dateRangeText=t},expression:"dateRangeText"}})],1)],1),a("v-btn",{staticClass:"mb-15 mr-10",attrs:{fixed:"",absolute:"",bottom:"",right:"",disabled:2!==e.dates.length,color:"primary",fab:"",loading:e.loader},on:{click:function(t){return e.search(e.filter)}}},[a("v-icon",[e._v("mdi-magnify")])],1)],1)],1)],1)],1),a("v-tab-item",[a("v-sheet",[a("QueryResult",{attrs:{excelFormat:e.excelFormat,result:e.result}})],1)],1)],1)],1)],1)},hi=[],gi=(a("a15b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-chip-group",{attrs:{color:"secondary"}},[a("v-icon",[e._v("mdi-filter")]),a("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-chip",e._g({attrs:{small:""}},n),[e._v("#Guía")])]}}])},[a("v-card",{staticClass:"px-7",attrs:{height:"95"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"#Guía",maxlength:"20",counter:"20"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("submitQuery",{"dispatch.reference":e.reference})}},model:{value:e.reference,callback:function(t){e.reference=t},expression:"reference"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-btn",{attrs:{fab:"","x-small":"",color:"primary"},on:{click:function(t){return e.$emit("submitQuery",{"dispatch.reference":e.reference})}}},[a("v-icon",[e._v("mdi-magnify")])],1)],1)],1)],1)],1),a("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-chip",e._g({attrs:{small:""}},n),[e._v("#Reporte")])]}}])},[a("v-card",{staticClass:"px-7",attrs:{height:"95"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Código",maxlength:"20",counter:"20"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("submitQuery",{reportCode:e.reportCode})}},model:{value:e.reportCode,callback:function(t){e.reportCode=t},expression:"reportCode"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-btn",{attrs:{fab:"","x-small":"",color:"primary"},on:{click:function(t){return e.$emit("submitQuery",{reportCode:e.reportCode})}}},[a("v-icon",[e._v("mdi-magnify")])],1)],1)],1)],1)],1)],1)],1)}),yi=[],Ci={name:"QueryChips",data:function(){return{reference:"",reportCode:"",loader:!1}}},ki=Ci,xi=Object(v["a"])(ki,gi,yi,!1,null,null,null),_i=xi.exports;b()(xi,{VBtn:j["a"],VCard:N["a"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VIcon:g["a"],VMenu:P["a"],VRow:T["a"],VTextField:Re["a"]});var Di=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{md:"3"}},[a("v-text-field",{attrs:{"prepend-inner-icon":"mdi-magnify",label:"Filtrar"},model:{value:e.tableFilter,callback:function(t){e.tableFilter=t},expression:"tableFilter"}})],1),a("v-col",{attrs:{align:"end"}},[e.excelFormat?a("export-excel",{attrs:{data:e.excelFormat}},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({attrs:{dark:"",disabled:!e.result.length,color:"#2a5"}},"v-btn",i,!1),n),[a("v-icon",{attrs:{large:""}},[e._v("mdi-microsoft-excel")])],1)]}}],null,!1,3404444959)},[e._v(" Exportar ")])],1):e._e()],1)],1),a("v-data-table",{staticClass:"elevation-2",attrs:{dense:"","items-per-page":5,headers:e.headers,items:e.result,search:e.tableFilter},scopedSlots:e._u([{key:"item.reportedAt",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("friendlyDate")(a.reportedAt))+" ")]}}])})],1)},wi=[],Oi={props:["result","excelFormat"],name:"QueryResult",data:function(){return{tableFilter:"",headers:[{text:"Despachado",value:"dispatch.date"},{text:"Técnico",value:"technician.fullName"},{text:"Pieza",value:"pieceName"},{text:"Cliente",value:"clientName"},{text:"Oficina",value:"officeName"},{text:"#Reporte",value:"reportCode"},{text:"Referencia",value:"dispatch.reference"}],dialog:!1}},filters:{friendlyDate:function(e){return le()(e).parseZone("America/Caracas").format("DD [de] MMMM, HH:mm")}}},Si=Oi,Vi=Object(v["a"])(Si,Di,wi,!1,null,null,null),Fi=Vi.exports;b()(Vi,{VBtn:j["a"],VCol:I["a"],VContainer:h["a"],VDataTable:It["a"],VIcon:g["a"],VRow:T["a"],VTextField:Re["a"],VTooltip:Fe["a"]});var ji={name:"Consultation",components:{Header:ce,QueryChips:_i,QueryResult:Fi},data:function(){return{tab:null,filter:{},dates:[],dispatch:{method:"",reference:""},excelFormat:[],result:[],loader:!1}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),Object(l["e"])(["collections"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},thisYear:function(){return le()(new Date).format("yyyy")},thisMonth:function(){return le()(new Date).format("MMMM")},lastMonth:function(){return le()(new Date).subtract(1,"month").format("MMMM")},dateRangeText:function(){return this.dates.join(" ~ ")},minDate:function(){return this.dates[0]&&!this.dates[1]?this.dates[0]:""},productsByCategory:function(){var e=this;if(this.filter.productType){var t=this.collections.Product.filter((function(t){return t.productType===e.filter.productType}));return t=t.map((function(e){return e.productName})),t}return this.collections.Product.map((function(e){return e.productName}))}}),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{dateQuickFilter:function(e){this.dates=[];var t="".concat(le()(new Date).format("yyyy-MM-"),"01"),a=le()(t).add(1,"M").format("YYYY-MM-DD");switch(e){case"thisMonth":a=le()(a).subtract(1,"days").format("YYYY-MM-DD"),this.dates.push(t),this.dates.push(a);break;case"lastMonth":a=t,t=le()(t).subtract(1,"M").format("YYYY-MM-DD"),a=le()(a).subtract(1,"days").format("YYYY-MM-DD"),this.dates.push(t),this.dates.push(a);break;case"thisYear":t="".concat(le()(new Date).format("yyyy"),"-01-01"),a=le()(t).add(1,"Y").format("yyyy-MM-DD"),a=le()(a).subtract(1,"days").format("YYYY-MM-DD"),this.dates.push(t),this.dates.push(a);break;default:break}},clearFilter:function(){this.filter={},this.dates=[]},search:function(e){var t=this;this.loader=!0,this.findDocuments({collection:"Dispatch",filter:e}).then((function(e){t.result=e,e.length&&t.xlsFormat(t.result),t.showSnackbar({message:"Registros encontrados: ".concat(e.length)}),t.loader=!1})).catch((function(){return t.loader=!1}))},xlsFormat:function(e){var t=[];for(var a in e)t.push({Despachado:e[a].dispatch.date,"Técnico":e[a].technician.fullName,Producto:e[a].productName,Pieza:e[a].pieceName,Cliente:e[a].clientName,Oficina:e[a].officeName,Reporte:e[a].reportCode,"Método":"".concat(e[a].dispatch.method," ").concat(e[a].dispatch.destiny),Referencia:e[a].dispatch.reference,Costo:e[a].dispatch.cost});this.excelFormat=t,this.loader=!1,this.tab=1}})},Ni=ji,Ii=Object(v["a"])(Ni,bi,hi,!1,null,null,null),Mi=Ii.exports;b()(Ii,{VAutocomplete:Pe["a"],VBtn:j["a"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VDatePicker:Ve["a"],VForm:Te["a"],VIcon:g["a"],VRow:T["a"],VSelect:et["a"],VSheet:Yt["a"],VTab:rn["a"],VTabItem:on["a"],VTabs:cn["a"],VTabsItems:sn["a"],VTabsSlider:ln["a"],VTextField:Re["a"]});var $i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Clientes",subtitle:"Administre la información de los clientes"}}),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):e._e(),e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):a("ClientPanels",{attrs:{mobile:e.mobile,collections:e.collections}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("ClientsCards",{attrs:{mobile:e.mobile}})],1)],1),a("MainButton",{attrs:{disabled:e.$store.state.session.user.userRole>1,loading:e.loading},on:{showForm:function(t){e.dialog=!0}}}),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.dialog?a("ClientForm",{attrs:{collections:e.collections,mobile:e.mobile},on:{hideInterface:function(t){e.dialog=!1}}}):e._e()],1)],1)],1)},Pi=[],Ti=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información del cliente"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-stepper",{attrs:{vertical:""},model:{value:e.activeStep,callback:function(t){e.activeStep=t},expression:"activeStep"}},[a("v-stepper-step",{attrs:{editable:"",complete:e.activeStep>1,step:"1"}},[e._v(" Información general ")]),a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{ref:"step1Completed",model:{value:e.step1Completed,callback:function(t){e.step1Completed=t},expression:"step1Completed"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?"12":"6"}},[a("v-text-field",{attrs:{label:"Nombre del cliente",rules:e.rules.required,maxlength:50},model:{value:e.client.clientName,callback:function(t){e.$set(e.client,"clientName",t)},expression:"client.clientName"}})],1)],1),e._v(" Regiones "),a("v-tooltip",{attrs:{color:"accent",right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-icon",e._g({staticClass:"ml-2 mb-1",attrs:{color:"accent"}},n),[e._v(" mdi-information-outline ")])]}}])},[e._v(" Distribución geográfica de oficinas ")]),a("v-row",{attrs:{align:"center"}},[a("v-col",[a("v-text-field",{attrs:{label:"Región"},model:{value:e.region,callback:function(t){e.region=t},expression:"region"}})],1),a("v-col",[a("v-btn",{attrs:{color:"accent",small:"",text:"",disabled:!e.region},on:{click:function(t){return e.addItem("client","region",e.region)}}},[e._v(" Agregar ")])],1)],1),a("v-chip-group",e._l(e.client.regions,(function(t,n){return a("v-chip",{key:n,attrs:{close:""},on:{"click:close":function(t){return e.removeProperty("regions",n)}}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("v-btn",{attrs:{color:"primary",disabled:!e.step1Completed,text:"",block:""},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")])],1),a("v-stepper-step",{attrs:{step:"2",editable:e.contactForm,complete:e.activeStep>2}},[e._v(" Contactos ")]),a("v-stepper-content",{attrs:{step:"2"}},[a("v-card",{staticClass:"pa-2",attrs:{outlined:"",flat:""}},[a("v-form",{ref:"contactForm",model:{value:e.contactForm,callback:function(t){e.contactForm=t},expression:"contactForm"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-text-field",{attrs:{label:"Nombre y apellido",rules:e.rules.required},model:{value:e.contact.fullName,callback:function(t){e.$set(e.contact,"fullName",t)},expression:"contact.fullName"}})],1),a("v-col",{attrs:{cols:e.mobile?12:5}},[a("v-text-field",{attrs:{label:"Cargo"},model:{value:e.contact.position,callback:function(t){e.$set(e.contact,"position",t)},expression:"contact.position"}})],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-text-field",{attrs:{label:"Dirección de correo",rules:e.rules.emailRules},model:{value:e.contact.email,callback:function(t){e.$set(e.contact,"email",t)},expression:"contact.email"}})],1),a("v-col",{attrs:{align:"center",cols:e.mobile?6:5}},[a("v-switch",{attrs:{label:"Accesos"},model:{value:e.contact.includeForAccessEmail,callback:function(t){e.$set(e.contact,"includeForAccessEmail",t)},expression:"contact.includeForAccessEmail"}})],1),a("v-col",{attrs:{align:"center",cols:e.mobile?6:3}},[a("v-tooltip",{attrs:{color:"accent",top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-icon",e._g({staticClass:"ml-2 mb-1",attrs:{color:"accent"}},n),[e._v(" mdi-information-outline ")])]}}])},[e._v(" Incluir en solicitudes de acceso ")])],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?8:3}},[a("v-text-field",{attrs:{rules:e.phoneNumber?e.rules.phoneRules:[],label:"Teléfono",maxlength:"11"},model:{value:e.phoneNumber,callback:function(t){e.phoneNumber=t},expression:"phoneNumber"}})],1),a("v-col",[a("v-btn",{attrs:{small:"",icon:"",color:"accent",disabled:!e.contactForm||!e.phoneNumber},on:{click:function(t){return e.addItem("contact","phoneNumber",e.phoneNumber)}}},[a("v-icon",[e._v("mdi-phone-plus")])],1)],1),a("v-col",[a("v-chip-group",e._l(e.contact.phoneNumbers,(function(t,n){return a("v-chip",{key:n,attrs:{close:""},on:{"click:close":function(t){return e.removeProperty("phoneNumbers",n)}}},[e._v(" "+e._s(t)+" ")])})),1)],1)],1),a("v-btn",{attrs:{disabled:!e.contactForm,block:"",small:"",outlined:"",color:"accent"},on:{click:function(t){return e.addItem("client","contact",e.contact)}}},[a("v-icon",[e._v("mdi-account-plus")])],1)],1)],1),a("v-row",[a("v-col",[a("v-chip-group",e._l(e.client.contacts,(function(t,n){return a("v-chip",{key:n,attrs:{close:""},on:{click:function(a){return e.editContact(t)},"click:close":function(t){return e.removeProperty("contacts",n)}}},[e._v(" "+e._s(t.fullName)+" ")])})),1)],1)],1),a("v-btn",{staticClass:"mb-1",attrs:{color:"primary",text:"",block:""},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")])],1),a("v-stepper-step",{attrs:{complete:e.activeStep>3,step:"2",editable:e.step2Completed}},[e._v(" Contrato activo o más reciente ")]),a("v-stepper-content",{attrs:{step:"3"}},[a("v-form",{ref:"step2Completed",model:{value:e.step2Completed,callback:function(t){e.step2Completed=t},expression:"step2Completed"}},[a("v-row",[a("v-col",[a("v-radio-group",{attrs:{row:""},model:{value:e.contract.active,callback:function(t){e.$set(e.contract,"active",t)},expression:"contract.active"}},[e._l([!0,!1],(function(e,t){return a("v-radio",{key:t,staticClass:"ml-3",attrs:{label:e?"Activo":"Inactivo",value:e}})})),a("v-tooltip",{attrs:{color:"accent",right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-icon",e._g({staticClass:"ml-2 mb-1",attrs:{color:"accent"}},n),[e._v(" mdi-information-outline ")])]}}])},[e._v(" Status de contrato (Información referencial) ")])],2)],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",[a("v-text-field",{attrs:{label:"Inicio de contrato",hint:"Valor referencial",rules:e.rules.required,readonly:""},model:{value:e.contract.startingDate,callback:function(t){e.$set(e.contract,"startingDate",t)},expression:"contract.startingDate"}})],1),a("v-col",[a("v-menu",{ref:"datemenu",attrs:{"close-on-content-click":!1,"return-value":e.contract.startingDate,transition:"scale-transition","nudge-left":"150","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.contract,"startingDate",t)},"update:return-value":function(t){return e.$set(e.contract,"startingDate",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrss;return[a("v-btn",e._g(e._b({attrs:{small:""}},"v-btn",i,!1),n),[a("v-icon",[e._v("mdi-calendar")])],1)]}}]),model:{value:e.datePicker,callback:function(t){e.datePicker=t},expression:"datePicker"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:e.contract.startingDate,callback:function(t){e.$set(e.contract,"startingDate",t)},expression:"contract.startingDate"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.datePicker=!1}}},[e._v(" Cancelar ")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.datemenu.save(e.contract.startingDate)}}},[e._v(" OK ")])],1)],1)],1)],1),a("v-row",[a("v-card-subtitle",[e._v(" Tiempos de solución acordados ")]),a("v-col",{attrs:{cols:e.mobile?6:2}},[a("v-select",{attrs:{label:"Local",items:[8,16,24,48],rules:e.rules.required},model:{value:e.contract.sla.local,callback:function(t){e.$set(e.contract.sla,"local",t)},expression:"contract.sla.local"}})],1),a("v-col",{attrs:{cols:e.mobile?6:2}},[a("v-select",{attrs:{label:"Foráneo",items:[8,16,24,48],rules:e.rules.required},model:{value:e.contract.sla.foreign,callback:function(t){e.$set(e.contract.sla,"foreign",t)},expression:"contract.sla.foreign"}})],1)],1),a("v-btn",{staticClass:"mb-1",attrs:{color:"primary",text:"",block:"",disabled:!e.step2Completed},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")])],1)],1),a("v-stepper-step",{attrs:{step:"4",editable:e.step3Completed}},[e._v(" Productos contratados ")]),a("v-stepper-content",{attrs:{step:"4"}},[a("v-form",{ref:"step3Completed",model:{value:e.step3Completed,callback:function(t){e.step3Completed=t},expression:"step3Completed"}},[a("v-data-table",{attrs:{headers:e.headers,items:e.collections.Product,"item-key":"_id","show-select":"",search:e.tableFilter},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-row",{staticClass:"ml-1"},[a("v-col",{attrs:{cols:e.mobile?8:4}},[a("v-text-field",{attrs:{label:"Filtro","prepend-inner-icon":"mdi-filter-outline"},model:{value:e.tableFilter,callback:function(t){e.tableFilter=t},expression:"tableFilter"}})],1)],1)]},proxy:!0}]),model:{value:e.contract.products,callback:function(t){e.$set(e.contract,"products",t)},expression:"contract.products"}}),a("v-btn",{staticClass:"mt-2",attrs:{color:"success",block:"",loading:e.loader},on:{click:function(t){return e.createClient(e.client)}}},[e._v(" Registrar ")])],1)],1)],1)],1)},Ri=[];le.a.locale("es");var Ai=n["a"].extend({name:"ClientForm",components:{Header:ce},props:["mobile"],data:function(){return{client:{clientName:"",regions:[],contacts:[],contracts:[]},contract:{active:!0,sla:{local:0,foreign:0},products:[],startingDate:"",finishDate:""},contact:{email:"",fullName:"",phoneNumbers:[],position:"",includeForAccessEmail:!1},region:"",phoneNumber:"",rules:Ie["rules"],activeStep:1,step1Completed:!1,step2Completed:!1,step3Completed:!1,contactForm:!1,datePicker:!1,tableFilter:"",headers:[{text:"Tipo",value:"productType"},{text:"Marca",value:"brand"},{text:"Modelo",value:"model"}],loader:!1}},computed:Object(o["a"])({},Object(l["e"])(["collections"])),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{addItem:function(e,t,a){this[e]["".concat(t,"s")].push(a),this[t]="","contact"===t&&(this.contact={email:"",fullName:"",phoneNumbers:[],position:"",includeForAccessEmail:!1},this.$refs["".concat(t,"Form")].resetValidation())},editContact:function(e){this.contact=Object.assign({},e)},removeProperty:function(e,t){"phoneNumbers"===e?this.contact.phoneNumbers.splice(t,1):this.client[e].splice(t,1)},preventDuplicity:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={clientName:e},a.next=3,t.findDocuments({collection:"Client",filter:n});case 3:return i=a.sent,a.abrupt("return",{throwsMatch:i.length});case 5:case"end":return a.stop()}}),a)})))()},createClient:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loader=!0,e.contracts.push(t.contract),a.next=4,t.preventDuplicity(e.clientName);case 4:if(n=a.sent,!n.throwsMatch){a.next=7;break}return a.abrupt("return",(t.showSnackbar({error:"El nombre se ha registrado antes"}),t.loader=!1));case 7:t.createDocument({collection:"Client",body:e}).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}));case 8:case"end":return a.stop()}}),a)})))()}})}),qi=Ai,Ei=Object(v["a"])(qi,Ti,Ri,!1,null,null,null),Li=Ei.exports;b()(Ei,{VBtn:j["a"],VCard:N["a"],VCardSubtitle:pe["b"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VDataTable:It["a"],VDatePicker:Ve["a"],VForm:Te["a"],VIcon:g["a"],VMenu:P["a"],VRadio:vt["a"],VRadioGroup:pt["a"],VRow:T["a"],VSelect:et["a"],VSpacer:R["a"],VStepper:bt["a"],VStepperContent:ht["a"],VStepperStep:gt["a"],VSwitch:ze["a"],VTextField:Re["a"],VTooltip:Fe["a"]});var Hi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-expansion-panels",{attrs:{multiple:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},e._l(e.formOptions.clients,(function(t,n){return a("v-expansion-panel",{key:n},[a("v-expansion-panel-header",[e._v(e._s(t.clientName))]),a("v-expansion-panel-content",[a("v-sheet",[a("v-card-subtitle",{staticClass:"font-weight-bold"},[e._v("Contactos")]),e._l(t.contacts,(function(t,n){return a("section",{key:n,staticClass:"px-1 my-1"},[a("v-card-title",{staticClass:"caption font-weight-bold"},[a("v-list-item-avatar",{directives:[{name:"show",rawName:"v-show",value:!e.mobile,expression:"!mobile"}]},[a("v-icon",{staticClass:"grey lighten-1",attrs:{dark:""}},[e._v("mdi-account")])],1),e._v(" "+e._s(t.fullName)+" ")],1),a("v-card-subtitle",{staticClass:"caption"},[e._v(e._s(t.position))]),a("v-chip-group",e._l(t.phoneNumbers,(function(t,n){return a("v-chip",{key:n,attrs:{small:""}},[e._v(" "+e._s(t)+" ")])})),1)],1)})),a("v-divider",{staticClass:"my-4"}),e.activeContract(t)?a("section",[a("v-alert",{staticClass:"mt-2",attrs:{type:"success",text:"",dense:""}},[e._v(" Contrato activo ")]),a("v-row",[a("v-col",[a("v-card-subtitle",{staticClass:"font-weight-bold"},[e._v(" Fecha de inicio ")])],1),a("v-col",[a("v-text-field",{attrs:{value:e.activeContract(t).startingDate}})],1)],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-card-subtitle",{staticClass:"font-weight-bold"},[e._v(" S. L. A. ")])],1),a("v-col",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var i=n.on;return[a("v-chip",e._g({staticClass:"mr-1",attrs:{color:"primary"}},i),[e._v(" "+e._s(e.activeContract(t).sla.local)+" ")])]}}],null,!0)},[e._v(" local ")]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(n){var i=n.on;return[a("v-chip",e._g({attrs:{color:"accent"}},i),[e._v(" "+e._s(e.activeContract(t).sla.foreign)+" ")])]}}],null,!0)},[e._v(" foráneo ")])],1)],1),a("v-row",[a("v-col",[a("v-card-subtitle",{staticClass:"font-weight-bold"},[e._v(" Productos contratados ")]),a("v-chip-group",e._l(e.productTypes(e.activeContract(t)),(function(t,n){return a("v-chip",{key:n,attrs:{small:""}},[e._v(" "+e._s(t)+" ")])})),1)],1)],1)],1):a("v-alert",{attrs:{type:"error",dense:"",text:""}},[e._v(" Sin contrato activo ")]),a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-btn",{attrs:{disabled:e.$store.state.session.user.userRole>1,small:"",block:""},on:{click:function(a){return e.editClient(t)}}},[e._v(" Editar ")])],1),a("v-col",{attrs:{cols:"6"}},[a("v-btn",{attrs:{disabled:e.$store.state.session.user.userRole>1,small:"",block:""},on:{click:function(a){return e.showContracts(t)}}},[e._v(" Contratos ")])],1)],1)],2)],1)],1)})),1),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.editInterface,callback:function(t){e.editInterface=t},expression:"editInterface"}},[a("v-card",[e.editInterface?a("EditClientForm",{attrs:{collections:e.collections,mobile:e.mobile,editing:e.selectedDocument},on:{hideInterface:function(t){e.editInterface=!1}}}):e._e()],1)],1),a("v-bottom-sheet",{attrs:{scrollable:""},model:{value:e.bottomSheet,callback:function(t){e.bottomSheet=t},expression:"bottomSheet"}},[a("v-card",[a("Header",{attrs:{closable:"1",title:"Contratos registrados",subtitle:e.selectedClient.clientName},on:{hideInterface:function(t){e.bottomSheet=!1}}}),a("v-card-text",[a("v-btn",{staticClass:"ma-1",attrs:{disabled:e.$store.state.session.user.userRole>1,color:"secondary",small:""},on:{click:function(t){return e.addContract(e.selectedClient)}}},[e._v(" Agregar ")]),a("v-data-table",{staticClass:"elevation-2",attrs:{dense:"","items-per-page":5,headers:e.headers,items:e.selectedClient.contracts},scopedSlots:e._u([{key:"item.startingDate",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("friendlyDate")(a.startingDate))+" ")]}},{key:"item.active",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.active?"Activo":"Inactivo")+" ")]}},{key:"item.actions",fn:function(t){var n=t.item;return[a("v-btn",{staticClass:"mx-1",attrs:{disabled:e.$store.state.session.user.userRole>1,icon:"",small:"",color:"secondary lighten-1"},on:{click:function(t){return e.editContract(n)}}},[a("v-icon",[e._v("mdi-pencil")])],1),a("v-btn",{staticClass:"mx-1",attrs:{icon:"",small:"",color:"error lighten-1",disabled:e.selectedClient.contracts.length<2||e.$store.state.session.user.userRole>1},on:{click:function(t){return e.confirmDelete(n)}}},[a("v-icon",[e._v("mdi-delete")])],1)]}}])}),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%"},model:{value:e.contractInterface,callback:function(t){e.contractInterface=t},expression:"contractInterface"}},[a("v-card",[e.contractInterface?a("ContractForm",{attrs:{collections:e.collections,mobile:e.mobile,editingContract:e.editingContract,editingClient:e.selectedDocument,contractIndex:e.contractIndex},on:{hideInterface:function(t){e.contractInterface=!1}}}):e._e()],1)],1)],1)],1)],1)],1)},Bi=[],Yi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información del cliente"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-stepper",{attrs:{vertical:""},model:{value:e.activeStep,callback:function(t){e.activeStep=t},expression:"activeStep"}},[a("v-stepper-step",{attrs:{editable:"",complete:e.step1Completed,step:"1"}},[e._v(" Información general ")]),a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{ref:"step1Completed",model:{value:e.step1Completed,callback:function(t){e.step1Completed=t},expression:"step1Completed"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?"12":"6"}},[a("v-text-field",{attrs:{label:"Nombre del cliente",rules:e.rules.required},model:{value:e.client.clientName,callback:function(t){e.$set(e.client,"clientName",t)},expression:"client.clientName"}})],1)],1),e._v(" Regiones "),a("v-tooltip",{attrs:{color:"accent",right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-icon",e._g({staticClass:"ml-2 mb-1",attrs:{color:"accent"}},n),[e._v(" mdi-information-outline ")])]}}])},[e._v(" Distribución geográfica de oficinas ")]),a("v-row",{attrs:{align:"center"}},[a("v-col",[a("v-text-field",{attrs:{label:"Región"},model:{value:e.region,callback:function(t){e.region=t},expression:"region"}})],1),a("v-col",[a("v-btn",{attrs:{color:"accent",small:"",text:"",disabled:!e.region},on:{click:function(t){return e.addItem("client","region",e.region)}}},[e._v(" Agregar ")])],1)],1),a("v-chip-group",e._l(e.client.regions,(function(t,n){return a("v-chip",{key:n,attrs:{close:"",disabled:""},on:{"click:close":function(t){return e.removeProperty("regions",n)}}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("v-btn",{attrs:{color:"primary",disabled:!e.step1Completed,text:"",block:""},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")])],1),a("v-stepper-step",{attrs:{step:"2",editable:e.step1Completed,complete:e.contactForm}},[e._v(" Contactos ")]),a("v-stepper-content",{attrs:{step:"2"}},[a("v-card",{staticClass:"pa-2",attrs:{outlined:"",flat:""}},[a("v-form",{ref:"contactForm",model:{value:e.contactForm,callback:function(t){e.contactForm=t},expression:"contactForm"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-text-field",{attrs:{label:"Nombre y apellido",rules:e.rules.required},model:{value:e.contact.fullName,callback:function(t){e.$set(e.contact,"fullName",t)},expression:"contact.fullName"}})],1),a("v-col",{attrs:{cols:e.mobile?12:5}},[a("v-text-field",{attrs:{label:"Cargo"},model:{value:e.contact.position,callback:function(t){e.$set(e.contact,"position",t)},expression:"contact.position"}})],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-text-field",{attrs:{label:"Dirección de correo",rules:e.rules.emailRules},model:{value:e.contact.email,callback:function(t){e.$set(e.contact,"email",t)},expression:"contact.email"}})],1),a("v-col",{attrs:{align:"center",cols:e.mobile?6:5}},[a("v-switch",{attrs:{label:"Accesos"},model:{value:e.contact.includeForAccessEmail,callback:function(t){e.$set(e.contact,"includeForAccessEmail",t)},expression:"contact.includeForAccessEmail"}})],1),a("v-col",{attrs:{align:"center",cols:e.mobile?6:3}},[a("v-tooltip",{attrs:{color:"accent",top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-icon",e._g({staticClass:"ml-2 mb-1",attrs:{color:"accent"}},n),[e._v(" mdi-information-outline ")])]}}])},[e._v(" Incluir en solicitudes de acceso ")])],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?8:3}},[a("v-text-field",{attrs:{rules:e.phoneNumber?e.rules.phoneRules:[],label:"Teléfono",maxlength:"11"},model:{value:e.phoneNumber,callback:function(t){e.phoneNumber=t},expression:"phoneNumber"}})],1),a("v-col",[a("v-btn",{attrs:{disabled:!e.contactForm||!e.phoneNumber,small:"",icon:"",color:"accent"},on:{click:function(t){return e.addItem("contact","phoneNumber",e.phoneNumber)}}},[a("v-icon",[e._v("mdi-phone-plus")])],1)],1),a("v-col",[a("v-chip-group",e._l(e.contact.phoneNumbers,(function(t,n){return a("v-chip",{key:n,attrs:{close:""},on:{"click:close":function(t){return e.removeProperty("phoneNumbers",n)}}},[e._v(" "+e._s(t)+" ")])})),1)],1)],1),a("v-btn",{attrs:{disabled:!e.contactForm,block:"",small:"",outlined:"",color:"accent"},on:{click:function(t){return e.addItem("client","contact",e.contact)}}},[a("v-icon",[e._v("mdi-account-plus")])],1)],1)],1),a("v-row",[a("v-col",[a("v-chip-group",e._l(e.client.contacts,(function(t,n){return a("v-chip",{key:n,attrs:{close:""},on:{click:function(a){return e.editContact(t)},"click:close":function(t){return e.removeProperty("contacts",n)}}},[e._v(" "+e._s(t.fullName)+" ")])})),1)],1)],1),a("v-btn",{staticClass:"mt-2",attrs:{color:"success",block:"",loading:e.loader},on:{click:function(t){return e.save(e.client)}}},[e._v(" Guardar cambios ")])],1)],1)],1)},zi=[];le.a.locale("es");var Gi=n["a"].extend({name:"EditClientForm",components:{Header:ce},props:["mobile","editing"],created:function(){this.editing&&(this.client=JSON.parse(JSON.stringify(this.editing))),console.log(this.editing)},data:function(){return{client:{clientName:"",regions:[],contacts:[],contracts:[]},contact:{email:"",fullName:"",phoneNumbers:[],position:"",includeForAccessEmail:!1},region:"",phoneNumber:"",rules:Ie["rules"],activeStep:1,step1Completed:!1,contactForm:!1,datePicker:!1,loader:!1}},computed:Object(o["a"])({},Object(l["e"])(["collections"])),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["updateDocuments","updateDocument","findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{addItem:function(e,t,a){this[e]["".concat(t,"s")].push(a),this[t]="","contact"===t&&(this.contact={email:"",fullName:"",phoneNumbers:[],position:"",includeForAccessEmail:!1},this.$refs["".concat(t,"Form")].resetValidation())},editContact:function(e){this.contact=Object.assign({},e)},removeProperty:function(e,t){"phoneNumbers"===e?this.contact.phoneNumbers.splice(t,1):this.client[e].splice(t,1)},preventDuplicity:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.clientName,i=e._id,r={clientName:n,_id:{$ne:i}},a.next=4,t.findDocuments({collection:"Client",filter:r});case 4:return o=a.sent,a.abrupt("return",{throwsMatch:o.length});case 6:case"end":return a.stop()}}),a)})))()},save:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loader=!0,a.next=3,t.preventDuplicity(e);case 3:if(n=a.sent,!n.throwsMatch){a.next=6;break}return a.abrupt("return",(t.showSnackbar({error:"El nombre se ha registrado antes"}),t.loader=!1));case 6:t.update({collection:"Client",body:e});case 7:case"end":return a.stop()}}),a)})))()},update:function(e){var t=this;e.body._id=this.editing._id,this.updateDocument(e).then((function(){t.editing.clientName!==e.body.clientName&&t.updateDependencies(e)})).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},updateDependencies:function(e){var t,a=e.body,n=[],i={clientName:this.editing.clientName},r={clientName:a.clientName},o=this.dependencies(i,r),c=Object(Z["a"])(o);try{for(c.s();!(t=c.n()).done;){var s=t.value;n.push(this.updateDocuments(s))}}catch(l){c.e(l)}finally{c.f()}Promise.all(n)},dependencies:function(e,t){return[{collection:"Active",query:e,update:t,options:{}},{collection:"Closed",query:e,update:t,options:{}},{collection:"Maintenance",query:e,update:{$set:{clientName:t.clientName,"inventory.$[product].clientName":t.clientName}},options:{arrayFilters:[{"product.clientName":e.clientName}]}},{collection:"Inventory",query:e,update:t,options:{}},{collection:"Office",query:e,update:t},{collection:"Request",query:e,update:t,options:{}},{collection:"Dispatch",query:e,update:t,options:{}}]}})}),Ui=Gi,Qi=Object(v["a"])(Ui,Yi,zi,!1,null,null,null),Xi=Qi.exports;b()(Qi,{VBtn:j["a"],VCard:N["a"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VIcon:g["a"],VRow:T["a"],VStepper:bt["a"],VStepperContent:ht["a"],VStepperStep:gt["a"],VSwitch:ze["a"],VTextField:Re["a"],VTooltip:Fe["a"]});var Wi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información del contrato"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-stepper",{attrs:{vertical:""},model:{value:e.activeStep,callback:function(t){e.activeStep=t},expression:"activeStep"}},[a("v-stepper-step",{attrs:{complete:e.activeStep>1,step:"1",editable:e.step1Completed}},[e._v(" Acuerdos generales ")]),a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{ref:"step1Completed",model:{value:e.step1Completed,callback:function(t){e.step1Completed=t},expression:"step1Completed"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-card-subtitle",[e._v(" Status ")])],1),a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-radio-group",{attrs:{row:""},model:{value:e.contract.active,callback:function(t){e.$set(e.contract,"active",t)},expression:"contract.active"}},e._l([!0,!1],(function(e,t){return a("v-radio",{key:t,attrs:{label:e?"Activo":"Inactivo",value:e}})})),1)],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-card-subtitle",[e._v(" Periodo contratado ")])],1),a("v-col",{attrs:{cols:e.mobile?12:5}},[a("v-text-field",{attrs:{label:"Rango",rules:e.rules.required,readonly:""},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),a("v-col",{attrs:{cols:e.mobile?12:3}},[a("v-menu",{ref:"startingDateMenu",attrs:{"close-on-content-click":!1,"return-value":e.contract.startingDate,transition:"scale-transition","nudge-left":"150","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.contract,"startingDate",t)},"update:return-value":function(t){return e.$set(e.contract,"startingDate",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ma-1",attrs:{small:"",color:"primary"}},"v-btn",i,!1),n),[a("v-icon",[e._v("mdi-calendar-check")])],1)]}}]),model:{value:e.startingDatePicker,callback:function(t){e.startingDatePicker=t},expression:"startingDatePicker"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:""},on:{"&input":function(t){return e.setRange.apply(null,arguments)}},model:{value:e.contract.startingDate,callback:function(t){e.$set(e.contract,"startingDate",t)},expression:"contract.startingDate"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.startingDatePicker=!1}}},[e._v(" Cancelar ")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.startingDateMenu.save(e.contract.startingDate)}}},[e._v(" OK ")])],1)],1),a("v-menu",{ref:"finishDateMenu",attrs:{"close-on-content-click":!1,"return-value":e.contract.finishDate,transition:"scale-transition","nudge-left":"150","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.contract,"finishDate",t)},"update:return-value":function(t){return e.$set(e.contract,"finishDate",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ma-1",attrs:{small:"",color:"primary"}},"v-btn",i,!1),n),[a("v-icon",[e._v("mdi-calendar-remove")])],1)]}}]),model:{value:e.finishDatePicker,callback:function(t){e.finishDatePicker=t},expression:"finishDatePicker"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:e.contract.finishDate,callback:function(t){e.$set(e.contract,"finishDate",t)},expression:"contract.finishDate"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.finishDatePicker=!1}}},[e._v(" Cancelar ")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.finishDateMenu.save(e.contract.finishDate)}}},[e._v(" OK ")])],1)],1)],1)],1),a("v-row",{attrs:{align:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:4}},[a("v-card-subtitle",[e._v(" S. L. A. ")])],1),a("v-col",{attrs:{cols:e.mobile?6:3}},[a("v-select",{attrs:{label:"Local",items:[8,16,24,48],rules:e.rules.required},model:{value:e.contract.sla.local,callback:function(t){e.$set(e.contract.sla,"local",t)},expression:"contract.sla.local"}})],1),a("v-col",{attrs:{cols:e.mobile?6:3}},[a("v-select",{attrs:{label:"Foráneo",items:[8,16,24,48],rules:e.rules.required},model:{value:e.contract.sla.foreign,callback:function(t){e.$set(e.contract.sla,"foreign",t)},expression:"contract.sla.foreign"}})],1)],1),a("v-btn",{staticClass:"mb-1",attrs:{disabled:!e.step1Completed,color:"primary",text:"",block:""},on:{click:function(t){e.activeStep++}}},[e._v(" Continuar ")])],1)],1),a("v-stepper-step",{attrs:{complete:e.activeStep>1,step:"2",editable:e.step1Completed}},[e._v(" Productos contratados ")]),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"step2Completed",model:{value:e.step2Completed,callback:function(t){e.step2Completed=t},expression:"step2Completed"}},[a("v-data-table",{attrs:{headers:e.headers,items:e.collections.Product,"item-key":"_id","show-select":"",search:e.tableFilter},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-row",{staticClass:"ml-1"},[a("v-col",{attrs:{cols:e.mobile?8:4}},[a("v-text-field",{attrs:{label:"Filtro","prepend-inner-icon":"mdi-filter-outline"},model:{value:e.tableFilter,callback:function(t){e.tableFilter=t},expression:"tableFilter"}})],1)],1)]},proxy:!0}]),model:{value:e.contract.products,callback:function(t){e.$set(e.contract,"products",t)},expression:"contract.products"}}),a("v-btn",{staticClass:"mt-2",attrs:{loading:e.loader,color:"success",block:""},on:{click:function(t){return e.update(e.client)}}},[e._v(" Guardar ")])],1)],1)],1)],1)},Zi=[];le.a.locale("es");var Ji=n["a"].extend({name:"ContractForm",components:{Header:ce},props:["mobile","editingClient","editingContract","contractIndex"],created:function(){this.client=JSON.parse(JSON.stringify(this.editingClient)),this.editingContract&&(this.contract=JSON.parse(JSON.stringify(this.editingContract))),this.setRange()},data:function(){return{client:{clientName:"",regions:[],contacts:[],contracts:[]},contract:{active:!0,sla:{local:0,foreign:0},products:[],startingDate:"".concat(le()(new Date).format("yyyy"),"-01-01"),finishDate:"".concat(le()(new Date).format("yyyy"),"-12-31")},tableFilter:"",headers:[{text:"Tipo",value:"productType"},{text:"Marca",value:"brand"},{text:"Modelo",value:"model"}],activeStep:1,step1Completed:!1,step2Completed:!1,startingDatePicker:!1,finishDatePicker:!1,rules:Ie["rules"],dateRange:[],loader:!1}},computed:Object(o["a"])({},Object(l["e"])(["collections"])),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["updateDocument","findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{setRange:function(){var e=[this.contract.startingDate,this.contract.finishDate];this.dateRange=e.join(" ~ ")},deactivateCurrentContract:function(e){var t=e.contracts.find((function(e){return e.active}));return t&&(t.active=!1),e},update:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={filter:{clientName:e.clientName},collection:"Active"},i={filter:{clientName:e.clientName,$or:[{status:"Por culminar"},{status:"Asignado"}]},collection:"Maintenance"},a.t0=[],a.t1=J["a"],a.next=6,t.findDocuments(n);case 6:return a.t2=a.sent,a.t3=(0,a.t1)(a.t2),a.t4=J["a"],a.next=11,t.findDocuments(i);case 11:if(a.t5=a.sent,a.t6=(0,a.t4)(a.t5),r=a.t0.concat.call(a.t0,a.t3,a.t6).length,!r){a.next=16;break}return a.abrupt("return",t.showSnackbar({error:"La información de contratos no puede ser editada mientras existan servicios activos para el cliente"}));case 16:t.loader=!0,t.contract.active&&(e=t.deactivateCurrentContract(e)),t.editingContract?e.contracts.splice(t.contractIndex,1,t.contract):e.contracts.push(t.contract),t.updateDocument({collection:"Client",body:e}).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}));case 20:case"end":return a.stop()}}),a)})))()}}),watch:{"contract.startingDate":function(){this.setRange()},"contract.finishDate":function(){this.setRange()}}}),Ki=Ji,er=Object(v["a"])(Ki,Wi,Zi,!1,null,null,null),tr=er.exports;b()(er,{VBtn:j["a"],VCardSubtitle:pe["b"],VCol:I["a"],VContainer:h["a"],VDataTable:It["a"],VDatePicker:Ve["a"],VForm:Te["a"],VIcon:g["a"],VMenu:P["a"],VRadio:vt["a"],VRadioGroup:pt["a"],VRow:T["a"],VSelect:et["a"],VSpacer:R["a"],VStepper:bt["a"],VStepperContent:ht["a"],VStepperStep:gt["a"],VTextField:Re["a"]});var ar={name:"ClientPanels",components:{EditClientForm:Xi,ContractForm:tr,Header:ce},props:["collections","mobile"],data:function(){return{bottomSheet:!1,editInterface:!1,contractInterface:!1,contractIndex:0,selectedClient:{},editingContract:{},selectedDocument:{},panel:[],headers:[{text:"Status",value:"active"},{text:"Inicio",value:"startingDate"},{text:"Acciones",value:"actions"}]}},filters:{friendlyDate:function(e){return le()(e).parseZone("America/Caracas").format("DD [de] MMMM [de] YYYY")}},computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),{},{clientsCopy:function(){return Object(J["a"])(new Set(this.collections.Client))}}),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["updateDocument","findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{activeContract:function(e){return e.contracts.find((function(e){return e.active}))},productTypes:function(e){var t=e.products.map((function(e){return e.productType}));return t=Object(J["a"])(new Set(t)),t},editClient:function(e){this.selectedDocument=Object.assign({},e),this.editInterface=!0},showContracts:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={filter:{clientName:e.clientName},collection:"Active"},i={filter:{clientName:e.clientName,$or:[{status:"Por culminar"},{status:"Asignado"}]},collection:"Maintenance"},a.t0=[],a.t1=J["a"],a.next=6,t.findDocuments(n);case 6:return a.t2=a.sent,a.t3=(0,a.t1)(a.t2),a.t4=J["a"],a.next=11,t.findDocuments(i);case 11:if(a.t5=a.sent,a.t6=(0,a.t4)(a.t5),r=a.t0.concat.call(a.t0,a.t3,a.t6).length,console.log(r),!r){a.next=17;break}return a.abrupt("return",t.showSnackbar({error:"La información de contratos no puede ser editada mientras existan servicios activos para el cliente"}));case 17:t.selectedClient=e,t.bottomSheet=!0;case 19:case"end":return a.stop()}}),a)})))()},editContract:function(e){this.editingContract=Object.assign({},e),this.selectedDocument=Object.assign({},this.selectedClient),this.contractIndex=this.selectedClient.contracts.findIndex((function(t){return t===e})),this.contractInterface=!0},addContract:function(e){this.selectedDocument=Object.assign({},e),this.editingContract=null,this.contractInterface=!0},confirmDelete:function(e){this.contractIndex=this.selectedClient.contracts.findIndex((function(t){return t===e})),confirm("Por favor confirme, esta acción es irreversible")&&this.deleteContract()},deleteContract:function(){var e=this,t=JSON.parse(JSON.stringify(this.selectedClient));t.contracts.splice(this.contractIndex,1),this.updateDocument({body:t,collection:"Client"}).then((function(){return e.bottomSheet=!1})).catch((function(){return e.bottomSheet=!1}))}})},nr=ar,ir=Object(v["a"])(nr,Hi,Bi,!1,null,null,null),rr=ir.exports;b()(ir,{VAlert:ne["a"],VBottomSheet:qt["a"],VBtn:j["a"],VCard:N["a"],VCardSubtitle:pe["b"],VCardText:pe["c"],VCardTitle:pe["d"],VChip:Je["a"],VChipGroup:Ke["a"],VCol:I["a"],VDataTable:It["a"],VDialog:Mt["a"],VDivider:M["a"],VExpansionPanel:Ea["a"],VExpansionPanelContent:La["a"],VExpansionPanelHeader:Ha["a"],VExpansionPanels:Ba["a"],VIcon:g["a"],VListItemAvatar:Pa["a"],VRow:T["a"],VSheet:Yt["a"],VTextField:Re["a"],VTooltip:Fe["a"]});var or=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",[n("v-col",[n("v-card",{staticClass:"text-no-wrap my-2 px-2",attrs:{disabled:!e.collections.Client.length}},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"4"}},[n("v-img",{attrs:{src:a("0c6e"),width:"70"}})],1),n("v-col",[n("v-card-title",[e._v(" "+e._s(e.collections.Client.length)+" ")]),n("v-card-subtitle",[e._v(" Clientes registrados ")])],1)],1)],1)],1)],1),n("v-row",[n("v-col",[n("v-card",{staticClass:"text-no-wrap my-2 px-2",attrs:{disabled:!e.collections.Client.length}},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"4"}},[n("v-img",{attrs:{src:a("d9c9"),width:"70"}})],1),n("v-col",[n("v-card-title",[e._v(" "+e._s(e.activeClients.length)+" ")]),n("v-card-subtitle",[e._v(" Clientes activos ")])],1)],1)],1)],1)],1)],1)},cr=[],sr={name:"ClientsCards",props:["mobile"],data:function(){return{bottomSheet:!1,result:[],sheetTilte:""}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections"])),{},{activeClients:function(){return this.collections.Client.filter((function(e){return e.contracts.filter((function(e){return e.active})).length}))}}),methods:{showBottomSheet:function(e,t){this.result=e,this.sheetTilte=t,this.bottomSheet=!0}}},lr=sr,ur=Object(v["a"])(lr,or,cr,!1,null,null,null),dr=ur.exports;b()(ur,{VCard:N["a"],VCardSubtitle:pe["b"],VCardTitle:pe["d"],VCol:I["a"],VContainer:h["a"],VImg:$["a"],VRow:T["a"]});var mr={name:"Clients",components:{Header:ce,ClientPanels:rr,ClientsCards:dr,ClientForm:Li,MainButton:ea},data:function(){return{dialog:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections","loading"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},orderedServices:function(){var e=this,t=this.collections.Client.map((function(e){return e.clientName})).sort(),a=[],n=function(n){a.push({client:t[n],services:e.collections.Active.filter((function(e){return e.clientName===t[n]}))})};for(var i in this.collections.Client)n(i);return a}})},fr=mr,vr=Object(v["a"])(fr,$i,Pi,!1,null,null,null),pr=vr.exports;b()(vr,{VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDialog:Mt["a"],VRow:T["a"],VSkeletonLoader:ie["a"]});var br=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Productos",subtitle:"Administre la información de los productos"}}),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):e._e(),e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):a("ProductsPanels",{attrs:{mobile:e.mobile,collections:e.collections}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("ProductsCards",{attrs:{mobile:e.mobile}})],1)],1),a("MainButton",{attrs:{disabled:e.$store.state.session.user.userRole>1,loading:e.loading},on:{showForm:function(t){e.dialog=!0}}}),a("v-dialog",{attrs:{width:e.mobile?"90%":"45%",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.dialog?a("ProductForm",{attrs:{collections:e.collections,mobile:e.mobile},on:{hideInterface:function(t){e.dialog=!1}}}):e._e()],1)],1)],1)},hr=[],gr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información del producto"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-form",{ref:"form",model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-select",{attrs:{items:e.formOptions.productTypes,rules:e.rules.required,"persistent-hint":"",hint:"Tipo",solo:""},model:{value:e.productType,callback:function(t){e.productType=t},expression:"productType"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},["Agregar"===e.productType?a("v-text-field",{attrs:{rules:e.rules.required,label:"Nuevo tipo de producto"},model:{value:e.newProductType,callback:function(t){e.newProductType=t},expression:"newProductType"}}):e._e()],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-select",{attrs:{items:e.formOptions.brands,rules:e.rules.required,solo:"",hint:"Marca","persistent-hint":""},model:{value:e.brand,callback:function(t){e.brand=t},expression:"brand"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},["Agregar"===e.brand?a("v-text-field",{attrs:{rules:e.rules.required,label:"Nueva marca"},model:{value:e.newBrand,callback:function(t){e.newBrand=t},expression:"newBrand"}}):e._e()],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{rules:e.rules.required,label:"Modelo"},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:12}},[a("v-autocomplete",{attrs:{items:e.formOptions.categories,rules:e.rules.required,"deletable-chips":"",chips:"",outlined:"","small-chips":"",multiple:"",label:"Categorias"},model:{value:e.categories,callback:function(t){e.categories=t},expression:"categories"}})],1)],1),a("v-btn",{attrs:{disabled:!e.form,loading:e.loader,color:"success",block:""},on:{click:function(t){return e.save(e.product)}}},[e._v(" Guardar ")])],1)],1)},yr=[];le.a.locale("es");var Cr=n["a"].extend({name:"ProductForm",components:{Header:ce},props:["collections","mobile","editing"],data:function(){return{form:!1,brand:"",model:"",productType:"",newProductType:"",newBrand:"",categories:[],originalItem:{},loader:!1,rules:Ie["rules"]}},created:function(){this.editing&&(this.model=this.editing.model,this.brand=this.editing.brand,this.categories=this.editing.categories,this.productType=this.editing.productType,this.originalItem=JSON.parse(JSON.stringify(this.editing)),delete this.originalItem._id)},computed:{formOptions:function(){var e=this.collections.Product.map((function(e){return e.productType}));e.unshift("Agregar");var t=this.collections.Product.map((function(e){return e.brand}));t.unshift("Agregar");var a=this.collections.Product.map((function(e){return e.categories}));function n(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.reduce((function(e,t){return[].concat(Object(J["a"])(e),Object(J["a"])(new Set(t)))}),[])}return a=n(a)[0],{productTypes:e,categories:a,brands:t}},product:function(){var e=this.newBrand?this.newBrand:this.brand,t=this.newProductType?this.newProductType:this.productType,a=this.model,n="".concat(t," ").concat(e," ").concat(a),i=this.categories;return{brand:e,productType:t,model:a,productName:n,categories:i}},requiresMassiveUpdate:function(){return this.editing?this.editing.productName!==this.product.productName:void 0}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","updateDocument","findDocuments","updateDocuments"])),Object(l["d"])(["showSnackbar"])),{},{removeCategory:function(e){this.categories.splice(e,1)},preventDuplicity:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.productName,i=t.editing?t.editing._id:null,r={productName:n,_id:{$ne:i}},a.next=5,t.findDocuments({collection:"Product",filter:r});case 5:if(o=a.sent,o.length){a.next=10;break}return a.abrupt("return",!1);case 10:return a.abrupt("return",(t.showSnackbar({error:"Nombre del producto registrado anteriormente"}),!0));case 11:case"end":return a.stop()}}),a)})))()},save:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loader=!0,a.next=3,t.preventDuplicity(e);case 3:if(n=a.sent,!n){a.next=6;break}return a.abrupt("return",t.loader=!1);case 6:t.editing?t.update({collection:"Product",body:e}):t.create({collection:"Product",body:e});case 7:case"end":return a.stop()}}),a)})))()},update:function(e){var t=this;e.body._id=this.editing._id,this.updateDocument(e).then((function(){t.requiresMassiveUpdate&&t.updateDependencies(e)})).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},updateDependencies:function(e){var t,a=e.body,n=[],i={productName:this.originalItem.productName},r={productName:a.productName,productType:a.productType},o=this.dependencies(i,r),c=Object(Z["a"])(o);try{for(c.s();!(t=c.n()).done;){var s=t.value;n.push(this.updateDocuments(s))}}catch(l){c.e(l)}finally{c.f()}Promise.all(n)},dependencies:function(e,t){return[{collection:"Active",query:e,update:t,options:{}},{collection:"Closed",query:e,update:t,options:{}},{collection:"Maintenance",query:{"inventory.productName":e.productName},update:{$set:{"inventory.$[product].productType":t.productType,"inventory.$[product].productName":t.productName}},options:{arrayFilters:[{"product.productName":e.productName}]}},{collection:"Inventory",query:e,update:t,options:{}},{collection:"Client",query:{"contracts.products.productName":e.productName},update:{$set:{"contracts.$[contract].products.$[product].productType":t.productType,"contracts.$[contract].products.$[product].productName":t.productName}},options:{arrayFilters:[{"contract.products.productName":e.productName},{"product.productName":e.productName}]}},{collection:"Office",query:{"inventory.productName":e.productName},update:{$set:{"inventory.$[product].productType":t.productType,"inventory.$[product].productName":t.productName}},options:{arrayFilters:[{"product.productName":e.productName}]}},{collection:"Request",query:e,update:t,options:{}},{collection:"Dispatch",query:e,update:t,options:{}},{collection:"Piece",query:{asociatedProducts:e.productName},update:{$set:{"asociatedProducts.$[product]":t.productName,pieceCategory:t.productType}},options:{arrayFilters:[{product:e.productName}]}}]},create:function(e){var t=this;this.createDocument(e).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))}})}),kr=Cr,xr=Object(v["a"])(kr,gr,yr,!1,null,null,null),_r=xr.exports;b()(xr,{VAutocomplete:Pe["a"],VBtn:j["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VRow:T["a"],VSelect:et["a"],VTextField:Re["a"]});var Dr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-expansion-panels",{attrs:{multiple:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},e._l(e.categories,(function(t,n){return a("v-expansion-panel",{key:n},[a("v-expansion-panel-header",[e._v(e._s(t))]),a("v-expansion-panel-content",e._l(e.orderedProducts(t),(function(t,n){return a("v-sheet",{key:n},[a("v-list-item",[a("v-list-item-avatar",{directives:[{name:"show",rawName:"v-show",value:!e.mobile,expression:"!mobile"}]},[a("v-icon",{staticClass:"grey lighten-1",attrs:{dark:""}},[e._v("mdi-label")])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"mb-1 font-weight-bold overline"},[a("v-chip",{attrs:{outlined:"",label:""}},[e._v(e._s(t.brand))])],1),a("v-list-item-title",{staticClass:"subheader"},[e._v(" "+e._s(t.model)+" ")])],1),a("v-list-item-action",[a("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{icon:"",small:"",disabled:e.$store.state.session.user.userRole>1}},n),[a("v-icon",{attrs:{color:"accent"}},[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[a("v-list",{attrs:{dense:""}},[a("v-list-item-group",[a("v-list-item",{on:{click:function(a){return e.editProduct(t)}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-pencil")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" Editar ")])],1)],1),a("v-list-item",{on:{click:function(a){return e.confirmDelete(t)}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-delete")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" Eliminar ")])],1)],1)],1)],1)],1)],1)],1)],1)})),1)],1)})),1),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.editInterface,callback:function(t){e.editInterface=t},expression:"editInterface"}},[a("v-card",[e.editInterface?a("ProductForm",{attrs:{collections:e.collections,mobile:e.mobile,editing:e.selectedDocument},on:{hideInterface:function(t){e.editInterface=!1}}}):e._e()],1)],1)],1)},wr=[],Or={components:{ProductForm:_r},name:"ProductsPanels",props:["collections","mobile"],data:function(){return{panel:[],bottomSheet:!1,editInterface:!1,selectedDocument:{}}},filters:{friendlyDate:function(e){return le()(e).parseZone("America/Caracas").format("DD [de] MMMM [de] YYYY")}},computed:{categories:function(){var e=this.collections.Product.map((function(e){return e.productType}));return e=Object(J["a"])(new Set(e)),e}},methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["deleteDocument"])),{},{orderedProducts:function(e){var t=this.collections.Product.filter((function(t){return t.productType===e}));return t=t.sort((function(e,t){return e.brand>t.brand?1:e.brand<t.brand?-1:0})),t},editProduct:function(e){this.selectedDocument=Object.assign({},e),this.editInterface=!0},confirmDelete:function(e){confirm("Por favor confirme, esta acción es irreversible")&&this.deleteProduct(e)},deleteProduct:function(e){var t=this,a={collection:"Product",body:e};this.deleteDocument(a).then((function(){return t.panel=[]})).catch((function(){return t.panel=[]}))}})},Sr=Or,Vr=Object(v["a"])(Sr,Dr,wr,!1,null,null,null),Fr=Vr.exports;b()(Vr,{VBtn:j["a"],VCard:N["a"],VChip:Je["a"],VDialog:Mt["a"],VExpansionPanel:Ea["a"],VExpansionPanelContent:La["a"],VExpansionPanelHeader:Ha["a"],VExpansionPanels:Ba["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemAction:$a["a"],VListItemAvatar:Pa["a"],VListItemContent:k["a"],VListItemGroup:$t["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VMenu:P["a"],VSheet:Yt["a"]});var jr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",[n("v-col",[n("v-card",{staticClass:"text-no-wrap my-2 px-2"},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"4"}},[n("v-img",{attrs:{src:a("c88b"),width:"70"}})],1),n("v-col",[n("v-card-title",[e._v(" "+e._s(e.collections.Product.length)+" ")]),n("v-card-subtitle",[e._v(" Productos registrados ")])],1)],1)],1)],1)],1)],1)},Nr=[],Ir={name:"ProductsCards",props:["mobile"],computed:Object(o["a"])({},Object(l["e"])(["collections"]))},Mr=Ir,$r=Object(v["a"])(Mr,jr,Nr,!1,null,null,null),Pr=$r.exports;b()($r,{VCard:N["a"],VCardSubtitle:pe["b"],VCardTitle:pe["d"],VCol:I["a"],VContainer:h["a"],VImg:$["a"],VRow:T["a"]});var Tr={name:"Products",components:{Header:ce,ProductsPanels:Fr,ProductsCards:Pr,ProductForm:_r,MainButton:ea},data:function(){return{dialog:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections","loading"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}})},Rr=Tr,Ar=Object(v["a"])(Rr,br,hr,!1,null,null,null),qr=Ar.exports;b()(Ar,{VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDialog:Mt["a"],VRow:T["a"],VSkeletonLoader:ie["a"]});var Er=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Oficinas",subtitle:"Red de oficinas de clientes"}}),a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):e._e(),e.loading?a("v-skeleton-loader",{attrs:{type:"image",width:"100%"}}):a("OfficePanels",{attrs:{collections:e.collections,mobile:e.mobile},on:{editOffice:e.editOffice}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("OfficesCards",{attrs:{mobile:e.mobile}})],1)],1),a("MainButton",{attrs:{loading:e.loading},on:{showForm:e.createOffice}}),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[e.dialog?a("OfficeForm",{attrs:{mobile:e.mobile,editing:e.selectedOffice,collections:e.collections},on:{hideInterface:function(t){e.dialog=!1}}}):e._e()],1)],1)],1)},Lr=[],Hr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-data-table",{attrs:{items:e.formOptions.clients,headers:e.table1Headers},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[a("v-btn",{attrs:{icon:"",small:"",color:"primary"},on:{click:function(t){return e.showBottomSheet(n.clientName)}}},[a("v-icon",[e._v("mdi-magnify")])],1)]}}])}),a("v-bottom-sheet",{attrs:{scrollable:""},model:{value:e.bottomSheet,callback:function(t){e.bottomSheet=t},expression:"bottomSheet"}},[e.clientOffices?a("v-card",[a("Header",{attrs:{closable:"1",title:"Red de oficinas"},on:{hideInterface:function(t){e.bottomSheet=!1}}}),a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:e.mobile?6:2}},[a("v-text-field",{attrs:{"prepend-inner-icon":"mdi-magnify"},model:{value:e.tableFilter,callback:function(t){e.tableFilter=t},expression:"tableFilter"}})],1)],1),a("v-data-table",{attrs:{dense:"",items:e.clientOffices,search:e.tableFilter,headers:e.table2Headers},scopedSlots:e._u([{key:"item.lastMaintenance",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("friendlyDate")(a.lastMaintenance))+" ")]}},{key:"item.actions",fn:function(t){var n=t.item;return[a("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{icon:"",color:"primary"}},n),[a("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[a("v-list",{attrs:{color:"primary",dark:"",dense:""}},[a("v-list-item-group",[a("v-list-item",{on:{click:function(t){return e.editOffice(n)}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-pencil")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" Editar ")])],1)],1),a("v-list-item",{attrs:{disabled:e.$store.state.session.user.userRole>1},on:{click:function(t){return e.confirmDelete(n)}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-delete")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" Eliminar ")])],1)],1)],1)],1)],1)]}}],null,!1,875999493)})],1)],1):e._e()],1)],1)},Br=[],Yr={name:"OfficePanels",components:{Header:ce},props:["collections","mobile"],data:function(){return{panel:[],bottomSheet:!1,tableFilter:"",serviceMenu:[{action:"edit",title:"Editar",icon:"mdi-pencil"},{action:"delete",title:"Eliminar",icon:"mdi-delete"}],table1Headers:[{text:"Cliente",value:"clientName"},{text:"Oficinas",value:"actions"}],table2Headers:[{text:"Oficina",value:"officeName"},{text:"Estado",value:"officeState"},{text:"Región",value:"region"},{text:"Acciones",value:"actions"}],clientOffices:[],dialog:!1,selectedInventory:[]}},filters:{friendlyDate:function(e){return le()(e).parseZone("America/Caracas").format("DD [de] MMMM [de] YYYY")}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["selectedDocument"])),Object(l["c"])(["formOptions"])),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["updateDocument","deleteDocument"])),{},{activeContract:function(e){return e.contracts.find((function(e){return e.active}))},showBottomSheet:function(e){this.clientOffices=this.collections.Office.filter((function(t){return t.clientName===e})),this.bottomSheet=!0},editOffice:function(e){this.bottomSheet=!1,this.$emit("editOffice",e)},confirmDelete:function(e){confirm("Esta acción es irreversible, por favor confirme")&&this.deleteOffice(e)},deleteOffice:function(e){var t=this;this.deleteDocument({collection:"Office",body:e}).then((function(){return t.bottomSheet=!1})).catch((function(){return t.bottomSheet=!1})),this.tableFilter=""}})},zr=Yr,Gr=Object(v["a"])(zr,Hr,Br,!1,null,null,null),Ur=Gr.exports;b()(Gr,{VBottomSheet:qt["a"],VBtn:j["a"],VCard:N["a"],VCardText:pe["c"],VCol:I["a"],VDataTable:It["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemContent:k["a"],VListItemGroup:$t["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VMenu:P["a"],VRow:T["a"],VTextField:Re["a"]});var Qr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información de la oficina"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-stepper",{attrs:{vertical:""},model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[a("v-stepper-step",{attrs:{editable:"",complete:e.step>1,step:"1"}},[e._v(" Información básica ")]),a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{ref:"step1Completed",model:{value:e.step1Completed,callback:function(t){e.step1Completed=t},expression:"step1Completed"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-select",{attrs:{items:e.formOptions.clientNames,rules:e.rules.required,disabled:null!==e.editing,label:"Cliente",solo:""},model:{value:e.officeForm.clientName,callback:function(t){e.$set(e.officeForm,"clientName",t)},expression:"officeForm.clientName"}})],1),a("v-col",{attrs:{cols:e.mobile?6:3}},[a("v-text-field",{attrs:{rules:e.rules.officeCode,label:"Código",maxlength:"4"},model:{value:e.officeForm.code,callback:function(t){e.$set(e.officeForm,"code",t)},expression:"officeForm.code"}})],1)],1),a("v-row",{staticClass:"my-0"},[a("v-col",{attrs:{cols:e.mobile?12:9}},[a("v-text-field",{staticClass:"mb-1",attrs:{label:"Nombre de oficina",rules:e.rules.required},model:{value:e.officeForm.officeName,callback:function(t){e.$set(e.officeForm,"officeName","string"===typeof t?t.trim():t)},expression:"officeForm.officeName"}})],1)],1),a("v-btn",{staticClass:"my-1",attrs:{disabled:!e.step1Completed,color:"primary",block:"",text:""},on:{click:function(t){e.step++}}},[e._v(" Continuar ")])],1)],1),a("v-stepper-step",{attrs:{complete:e.step>3,step:"2",editable:""}},[e._v(" Ubicación ")]),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"step2Completed",model:{value:e.step2Completed,callback:function(t){e.step2Completed=t},expression:"step2Completed"}},[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-autocomplete",{attrs:{items:e.states,rules:e.rules.required,label:"Estado"},model:{value:e.officeForm.officeState,callback:function(t){e.$set(e.officeForm,"officeState",t)},expression:"officeForm.officeState"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-select",{attrs:{items:e.regions,label:"Región",rules:e.rules.required,disabled:!e.officeForm.clientName,solo:""},model:{value:e.officeForm.region,callback:function(t){e.$set(e.officeForm,"region",t)},expression:"officeForm.region"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:e.mobile?6:3}},[a("v-text-field",{attrs:{label:"Código postal",rules:e.rules.officeCode,maxlength:4},model:{value:e.officeForm.postalCode,callback:function(t){e.$set(e.officeForm,"postalCode",t)},expression:"officeForm.postalCode"}})],1),a("v-col",{attrs:{cols:e.mobile?6:3}},[a("v-switch",{attrs:{label:"Local"},model:{value:e.officeForm.isLocal,callback:function(t){e.$set(e.officeForm,"isLocal",t)},expression:"officeForm.isLocal"}})],1)],1),a("v-row",[a("v-col",[a("v-textarea",{attrs:{label:"Dirección",outlined:"",counter:""},model:{value:e.officeForm.address,callback:function(t){e.$set(e.officeForm,"address",t)},expression:"officeForm.address"}})],1)],1),a("v-btn",{staticClass:"mb-1",attrs:{disabled:!e.step2Completed,color:"primary",block:"",text:""},on:{click:function(t){e.step++}}},[e._v(" Continuar ")])],1)],1),a("v-stepper-step",{attrs:{step:"3",editable:"",complete:e.step>3}},[e._v(" Status ")]),a("v-stepper-content",{attrs:{step:"3"}},[a("v-form",{ref:"step3Completed",model:{value:e.step3Completed,callback:function(t){e.step3Completed=t},expression:"step3Completed"}},[a("v-row",[a("v-col",{attrs:{cols:6}},[a("v-switch",{staticClass:"ml-3",attrs:{label:"Activa"},model:{value:e.officeForm.isActive,callback:function(t){e.$set(e.officeForm,"isActive",t)},expression:"officeForm.isActive"}})],1)],1),a("v-row",{attrs:{justify:"start"}},[a("v-col",{attrs:{cols:e.mobile?4:2}},[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.officeForm.openingHour,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.officeForm,"openingHour",t)},"update:return-value":function(t){return e.$set(e.officeForm,"openingHour",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ma-1",attrs:{small:"",outlined:!e.officeForm.openingHour,color:e.officeForm.openingHour?"primary":"error"}},"v-btn",i,!1),n),[a("v-icon",[e._v("mdi-clock-time-four-outline")])],1)]}}]),model:{value:e.timePicker,callback:function(t){e.timePicker=t},expression:"timePicker"}},[e.timePicker?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menu.save(e.officeForm.openingHour)}},model:{value:e.officeForm.openingHour,callback:function(t){e.$set(e.officeForm,"openingHour",t)},expression:"officeForm.openingHour"}}):e._e()],1)],1),a("v-col",{attrs:{cols:e.mobile?8:3}},[a("v-text-field",{attrs:{readonly:"",label:"Apertura"},model:{value:e.officeForm.openingHour,callback:function(t){e.$set(e.officeForm,"openingHour",t)},expression:"officeForm.openingHour"}})],1)],1),a("v-row",{attrs:{justify:"start"}},[a("v-col",{attrs:{cols:e.mobile?4:2}},[a("v-menu",{ref:"menu2",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.officeForm.closingHour,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.officeForm,"closingHour",t)},"update:return-value":function(t){return e.$set(e.officeForm,"closingHour",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ma-1",attrs:{small:"",outlined:!e.officeForm.closingHour,color:e.officeForm.closingHour?"primary":"error"}},"v-btn",i,!1),n),[a("v-icon",[e._v("mdi-clock-time-four-outline")])],1)]}}]),model:{value:e.timePicker2,callback:function(t){e.timePicker2=t},expression:"timePicker2"}},[e.timePicker2?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menu2.save(e.officeForm.closingHour)}},model:{value:e.officeForm.closingHour,callback:function(t){e.$set(e.officeForm,"closingHour",t)},expression:"officeForm.closingHour"}}):e._e()],1)],1),a("v-col",{attrs:{cols:e.mobile?8:3}},[a("v-text-field",{attrs:{readonly:"",label:"Cierre"},model:{value:e.officeForm.closingHour,callback:function(t){e.$set(e.officeForm,"closingHour",t)},expression:"officeForm.closingHour"}})],1)],1),a("v-btn",{attrs:{color:"success",block:"",disabled:!e.step2Completed||!e.step3Completed,loading:e.loader},on:{click:function(t){return e.save(e.officeForm)}}},[e._v(" Registrar ")])],1)],1)],1)],1)},Xr=[],Wr={name:"OfficeForm",components:{Header:ce},props:["mobile","collections","editing"],data:function(){return{step:1,step1Completed:!1,step2Completed:!1,step3Completed:!1,officeForm:{code:"0000",openingHour:"",closingHour:"",isActive:!0,isLocal:!1},rules:Ie["rules"],states:Ie["states"],timePicker:"",timePicker2:"",loader:!1}},created:function(){this.editing&&(this.officeForm=Object.assign({},this.editing),this.officeForm.code<1e3&&(this.officeForm.code="0".concat(this.editing.code)))},computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["formOptions"])),{},{regions:function(){var e=this,t=this.officeForm.clientName?this.collections.Client.find((function(t){return t.clientName===e.officeForm.clientName})).regions:[];return t},requiresMassiveUpdate:function(){return this.editing?this.editing.officeName!==this.officeForm.officeName||this.editing.officeState!==this.officeForm.officeState||this.editing.officeRegion!==this.officeForm.officeRegion:void 0}}),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","updateDocument","updateDocuments","findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{preventDuplicity:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n,i,r,o,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.clientName,i=e.code,r=t.editing?t.editing._id:null,o={clientName:n,code:i,_id:{$ne:r}},a.next=5,t.findDocuments({collection:"Office",filter:o});case 5:if(c=a.sent,!c.length){a.next=10;break}return a.abrupt("return",t.showSnackbar({error:"Código de la oficina registrado anteriormente"}));case 10:return a.abrupt("return",!1);case 11:case"end":return a.stop()}}),a)})))()},save:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loader=!0,a.next=3,t.preventDuplicity(e);case 3:if(n=a.sent,!n){a.next=6;break}return a.abrupt("return",t.loader=!1);case 6:t.editing?t.update({collection:"Office",body:e}):t.create({collection:"Office",body:e});case 7:case"end":return a.stop()}}),a)})))()},create:function(e){var t=this;this.createDocument(e).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},update:function(e){var t=this;this.updateDocument(e).then((function(){t.requiresMassiveUpdate&&t.updateDependencies(e)})).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},updateDependencies:function(e){var t,a=e.body,n=[],i={clientName:this.editing.clientName,officeName:this.editing.officeName},r={officeName:a.officeName,officeRegion:a.region,officeState:a.officeState},o=this.dependencies(i,r),c=Object(Z["a"])(o);try{for(c.s();!(t=c.n()).done;){var s=t.value;n.push(this.updateDocuments(s))}}catch(l){c.e(l)}finally{c.f()}Promise.all(n)},dependencies:function(e,t){return[{collection:"Active",query:e,update:t,options:{}},{collection:"Closed",query:e,update:t,options:{}},{collection:"Maintenance",query:e,update:{$set:{officeName:t.officeName,officeRegion:t.officeRegion,officeState:t.officeState,"inventory.$[product].officeName":t.officeName,"inventory.$[product].officeRegion":t.officeRegion,"inventory.$[product].officeState":t.officeState}},options:{arrayFilters:[{"product.clientName":e.clientName,"product.officeName":e.officeName}]}},{collection:"Inventory",query:e,update:t,options:{}},{collection:"Request",query:e,update:t,options:{}},{collection:"Dispatch",query:e,update:t,options:{}}]}})},Zr=Wr,Jr=Object(v["a"])(Zr,Qr,Xr,!1,null,null,null),Kr=Jr.exports;b()(Jr,{VAutocomplete:Pe["a"],VBtn:j["a"],VCol:I["a"],VContainer:h["a"],VForm:Te["a"],VIcon:g["a"],VMenu:P["a"],VRow:T["a"],VSelect:et["a"],VStepper:bt["a"],VStepperContent:ht["a"],VStepperStep:gt["a"],VSwitch:ze["a"],VTextField:Re["a"],VTextarea:yt["a"],VTimePicker:lt["a"]});var eo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",[n("v-col",[n("v-card",{staticClass:"text-no-wrap my-2 px-2"},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"4"}},[n("v-img",{attrs:{src:a("05e6"),width:"70"}})],1),n("v-col",[n("v-card-title",[e._v(" "+e._s(e.collections.Office.length)+" ")]),n("v-card-subtitle",[e._v(" Oficinas registradas ")])],1)],1)],1)],1)],1)],1)},to=[],ao={name:"OfficesCards",props:["mobile"],computed:Object(o["a"])({},Object(l["e"])(["collections"]))},no=ao,io=Object(v["a"])(no,eo,to,!1,null,null,null),ro=io.exports;b()(io,{VCard:N["a"],VCardSubtitle:pe["b"],VCardTitle:pe["d"],VCol:I["a"],VContainer:h["a"],VImg:$["a"],VRow:T["a"]});var oo={name:"Maintenance",components:{Header:ce,OfficePanels:Ur,OfficeForm:Kr,MainButton:ea,OfficesCards:ro},data:function(){return{dialog:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections","loading"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}}),methods:{editOffice:function(e){this.selectedOffice=Object.assign({},e),this.dialog=!0},createOffice:function(){this.selectedOffice=null,this.dialog=!0}}},co=oo,so=Object(v["a"])(co,Er,Lr,!1,null,null,null),lo=so.exports;b()(so,{VCard:N["a"],VCol:I["a"],VContainer:h["a"],VDialog:Mt["a"],VRow:T["a"],VSkeletonLoader:ie["a"]});var uo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{title:"Usuarios",subtitle:"Gestione la información básica"}}),a("v-data-table",{attrs:{items:e.collections.User,headers:e.headers,loadin:e.loading},scopedSlots:e._u([{key:"item.role",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("roles")(a.userRole))+" ")]}},{key:"item.actions",fn:function(t){var n=t.item;return[a("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{icon:""}},n),[a("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[a("v-list",{attrs:{color:"primary",dark:"",dense:""}},[a("v-list-item-group",[a("v-list-item",{on:{click:function(t){return e.editUser(n)}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-pencil")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" Editar ")])],1)],1),a("v-list-item",{on:{click:function(t){return e.confirmDelete(n)}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-delete")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" Eliminar ")])],1)],1)],1)],1)],1)]}}])}),a("MainButton",{attrs:{loading:e.loading},on:{showForm:function(t){e.signInterface=!0}}}),a("v-dialog",{attrs:{width:e.mobile?"90%":"60%",persistent:""},model:{value:e.signInterface,callback:function(t){e.signInterface=t},expression:"signInterface"}},[a("v-card",[e.signInterface?a("SignForm",{attrs:{mobile:e.mobile,editing:e.editing},on:{hideInterface:e.hideInterface}}):e._e()],1)],1)],1)},mo=[],fo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("Header",{attrs:{closable:"1",title:"Formulario de registro",subtitle:"Complete la información de usuario"},on:{hideInterface:function(t){return e.$emit("hideInterface")}}}),a("v-stepper",{attrs:{vertical:""},model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[a("v-stepper-step",{attrs:{editable:"",complete:e.step>1,step:"1"}},[e._v(" Datos personales ")]),a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{ref:"step1Form",model:{value:e.step1Form,callback:function(t){e.step1Form=t},expression:"step1Form"}},[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{maxlength:"20",counter:"20",label:"Primer nombre",rules:e.rules.noSpaces},model:{value:e.userForm.firstName,callback:function(t){e.$set(e.userForm,"firstName",t)},expression:"userForm.firstName"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{maxlength:"20",counter:"20",label:"Primer apellido",rules:e.rules.required},model:{value:e.userForm.lastName,callback:function(t){e.$set(e.userForm,"lastName",t)},expression:"userForm.lastName"}})],1)],1),a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{label:"Documento de identidad",rules:e.rules.idRules,maxlength:8},model:{value:e.userForm.idDocument,callback:function(t){e.$set(e.userForm,"idDocument",t)},expression:"userForm.idDocument"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"F. Nacimiento",readonly:""},model:{value:e.userForm.birthday,callback:function(t){e.$set(e.userForm,"birthday",t)},expression:"userForm.birthday"}},"v-text-field",i,!1),n))]}}]),model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[a("v-date-picker",{on:{input:function(t){e.menu2=!1}},model:{value:e.userForm.birthday,callback:function(t){e.$set(e.userForm,"birthday",t)},expression:"userForm.birthday"}})],1)],1)],1)],1),a("v-btn",{attrs:{color:"primary",disabled:!e.step1Form,text:"",block:""},on:{click:function(t){e.step++}}},[e._v(" Continuar ")])],1),a("v-stepper-step",{attrs:{editable:"",complete:e.step2Form,step:"2"}},[e._v(" Información corporativa ")]),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"step2Form",model:{value:e.step2Form,callback:function(t){e.step2Form=t},expression:"step2Form"}},[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-select",{attrs:{items:e.departments,label:"Departamento",rules:e.rules.required},model:{value:e.userForm.department,callback:function(t){e.$set(e.userForm,"department",t)},expression:"userForm.department"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{label:"Cargo",rules:e.rules.required},model:{value:e.userForm.companyPosition,callback:function(t){e.$set(e.userForm,"companyPosition",t)},expression:"userForm.companyPosition"}})],1)],1),a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-select",{attrs:{label:"Rol",items:e.roles},model:{value:e.userForm.userRole,callback:function(t){e.$set(e.userForm,"userRole",t)},expression:"userForm.userRole"}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("v-text-field",{attrs:{maxlength:"50",counter:"50",label:"E-mail",rules:e.rules.corpEmail},model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1)],1),a("v-row",[a("v-col",[a("v-switch",{attrs:{label:"Asignable a servicios"},model:{value:e.userForm.assignable,callback:function(t){e.$set(e.userForm,"assignable",t)},expression:"userForm.assignable"}})],1)],1)],1),a("v-btn",{attrs:{color:"primary",disabled:!e.step2Form,text:"",block:""},on:{click:function(t){e.step++}}},[e._v(" Continuar ")])],1),a("v-stepper-step",{attrs:{editable:"",complete:e.step3Form,step:"3"}},[e._v(" Contraseña ")]),a("v-stepper-content",{attrs:{step:"3"}},[a("v-form",{ref:"step3Form",model:{value:e.step3Form,callback:function(t){e.step3Form=t},expression:"step3Form"}},[e.editing?a("v-switch",{attrs:{label:"Modificar contraseña"},model:{value:e.updatePassword,callback:function(t){e.updatePassword=t},expression:"updatePassword"}}):e._e(),!e.editing||e.updatePassword?a("v-row",{attrs:{justify:"center"}},[a("v-col",[a("v-text-field",{attrs:{type:"password",maxlength:"8",counter:"8",label:"Contraseña",rules:e.rules.passwordRules},model:{value:e.userForm.userPassword,callback:function(t){e.$set(e.userForm,"userPassword",t)},expression:"userForm.userPassword"}})],1),a("v-col",[a("v-text-field",{attrs:{type:"password",rules:e.rules.passwordRules,maxlength:"8",counter:"8",label:"Confirmar",error:!e.passwordComparison.match,"error-messages":e.confirmPassword?e.passwordComparison.message:""},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}})],1)],1):e._e(),a("v-row",[a("v-col",[a("v-switch",{attrs:{label:"Permitir acceso"},model:{value:e.userForm.allowLogin,callback:function(t){e.$set(e.userForm,"allowLogin",t)},expression:"userForm.allowLogin"}})],1)],1),a("v-btn",{staticClass:"mt-2",attrs:{disabled:!e.step1Form||!e.step2Form||!e.step3Form,loading:e.loader,color:"success",block:""},on:{click:function(t){return e.save(e.userForm)}}},[e._v(" Registrar ")])],1)],1)],1)],1)},vo=[],po={name:"SignForm",components:{Header:ce},props:["mobile","editing"],data:function(){return{step:1,userForm:{assignable:!1,allowLogin:!1},menu2:!1,loader:!1,step1Form:!1,step2Form:!1,step3Form:!1,confirmPassword:"",updatePassword:!1,rules:Ie["rules"],departments:Ie["departments"],roles:Ie["roles"]}},created:function(){this.editing&&(this.userForm=Object.assign({},this.editing))},computed:{passwordComparison:function(){var e=this.confirmPassword===this.userForm.userPassword;e=!this.userForm.userPassword||e;var t=e?"":"No coinciden";return{match:e,message:t}},requiresMassiveUpdate:function(){return this.editing?this.userForm.firstName!==this.editing.firstName||this.userForm.lastName!==this.editing.lastName:void 0}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["createDocument","updateDocument","updateDocuments","findDocuments"])),Object(l["d"])(["showSnackbar"])),{},{preventDuplicity:function(e){var t=this;return new Promise((function(a,n){var i=t.editing?t.editing._id:null,r={idDocument:e,_id:{$ne:i}};t.findDocuments({collection:"User",filter:r}).then((function(e){e.length?(t.showSnackbar({message:"Documento de identidad registrado anteriormente"}),t.loader=!1,a(!1)):a(!0)})).catch((function(){return n(!1)}))}))},save:function(e){var t=this;return Object(He["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loader=!0,a.next=3,t.preventDuplicity(e.idDocument);case 3:if(n=a.sent,n){a.next=6;break}return a.abrupt("return");case 6:t.editing?t.update({collection:"User",body:e}):t.create({collection:"User",body:e});case 7:case"end":return a.stop()}}),a)})))()},create:function(e){var t=this;this.createDocument(e).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},update:function(e){var t=this;this.updateDocument(e).then((function(){t.requiresMassiveUpdate&&t.updateDependencies(e)})).then((function(){return t.$emit("hideInterface")})).catch((function(){return t.loader=!1}))},updateDependencies:function(e){var t,a=e.body,n=[],i={_id:a._id},r={fullName:"".concat(a.firstName," ").concat(a.lastName)},o=this.dependencies(i,r),c=Object(Z["a"])(o);try{for(c.s();!(t=c.n()).done;){var s=t.value;n.push(this.updateDocuments(s))}}catch(l){c.e(l)}finally{c.f()}Promise.all(n)},dependencies:function(e,t){return[{collection:"Active",query:{"schedule.technician._id":e._id},update:{$set:{"schedule.technician.fullName":t.fullName}},options:{}},{collection:"Active",query:{$or:[{"documentation.author._id":e._id},{"documentation.technician._id":e._id}]},update:{$set:{"documentation.$[specificAuthor].author.fullName":t.fullName,"documentation.$[specificTechnician].technician.fullName":t.fullName}},options:{arrayFilters:[{"specificAuthor.author._id":e._id},{"specificTechnician.technician._id":e._id}]}},{collection:"Closed",query:{$or:[{"documentation.author._id":e._id},{"documentation.technician._id":e._id}]},update:{$set:{"documentation.$[specificAuthor].author.fullName":t.fullName,"documentation.$[specificTechnician].technician.fullName":t.fullName}},options:{arrayFilters:[{"specificAuthor.author._id":e._id},{"specificTechnician.technician._id":e._id}]}},{collection:"Maintenance",query:{"schedule.technician._id":e._id},update:{$set:{"schedule.technician.fullName":t.fullName}},options:{}},{collection:"Maintenance",query:{"inventory.technician._id":e._id},update:{$set:{"inventory.$[specific].technician.fullName":t.fullName}},options:{arrayFilters:[{"specific.technician._id":e._id}]}},{collection:"Inventory",query:{"technician._id":e._id},update:{$set:{"technician.fullName":t.fullName}},options:{}},{collection:"Request",query:{"technician._id":e._id},update:{$set:{"technician.fullName":t.fullName}},options:{}},{collection:"Request",query:{"requestedBy._id":e._id},update:{$set:{"requestedBy.fullName":t.fullName}},options:{}},{collection:"Dispatch",query:{"requestedBy._id":e._id},update:{$set:{"requestedBy.fullName":t.fullName}},options:{}},{collection:"Dispatch",query:{"technician._id":e._id},update:{$set:{"technician.fullName":t.fullName}},options:{}}]}})},bo=po,ho=Object(v["a"])(bo,fo,vo,!1,null,null,null),go=ho.exports;b()(ho,{VBtn:j["a"],VCol:I["a"],VContainer:h["a"],VDatePicker:Ve["a"],VForm:Te["a"],VMenu:P["a"],VRow:T["a"],VSelect:et["a"],VStepper:bt["a"],VStepperContent:ht["a"],VStepperStep:gt["a"],VSwitch:ze["a"],VTextField:Re["a"]});var yo={name:"Users",components:{Header:ce,MainButton:ea,SignForm:go},data:function(){return{signInterface:!1,editing:null,headers:[{text:"Nombre",value:"firstName"},{text:"Apellido",value:"lastName"},{text:"Departamento",value:"department"},{text:"Rol",value:"role"},{text:"Acciones",value:"actions"}]}},filters:{roles:function(e){return 0==e?"root":1==e?"Administrador":2==e?"Usuario":3==e?"Invitado":void 0}},computed:Object(o["a"])(Object(o["a"])({},Object(l["e"])(["loading","collections"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}}),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["deleteDocument"])),{},{editUser:function(e){this.editing=Object.assign({},e),this.signInterface=!0},confirmDelete:function(e){confirm("Esta acción es irreversible, por favor confirme")&&this.deleteUser(e)},deleteUser:function(e){this.deleteDocument({collection:"User",body:e}).then((function(){})).catch((function(){}))},hideInterface:function(){this.signInterface=!1,this.editing=null}})},Co=yo,ko=Object(v["a"])(Co,uo,mo,!1,null,null,null),xo=ko.exports;b()(ko,{VBtn:j["a"],VCard:N["a"],VContainer:h["a"],VDataTable:It["a"],VDialog:Mt["a"],VIcon:g["a"],VList:y["a"],VListItem:C["a"],VListItemContent:k["a"],VListItemGroup:$t["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VMenu:P["a"]});var _o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-img",{staticClass:"pb-5",staticStyle:{position:"fixed",top:"0",left:"0","min-height":"100%","min-width":"100%"},attrs:{app:"",src:a("ef5c")}},[n("v-alert",{attrs:{type:"info",color:"dark",icon:"mdi-information-outline",tile:""}},[e._v(" Elige un perfil de prueba para iniciar ")]),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:e.mobile?11:5}},[n("v-card",{staticStyle:{opacity:"80%"},attrs:{loading:e.loader}},[n("v-card-title",[e._v("Bienvenido a Mantra")]),n("v-card-subtitle",[e._v("Inicia sesión para continuar")]),n("v-row",[n("v-col",{attrs:{cols:4}},[n("v-row",[n("v-col",{attrs:{align:"center"}},[n("v-img",{attrs:{src:a("cbb6"),width:"70"}}),n("v-spacer"),n("v-btn",{attrs:{href:"https://instagram.com/microfilmscenter",target:"blank",color:"primary",icon:""}},[n("v-icon",[e._v("mdi-instagram")])],1),n("v-btn",{attrs:{href:"https://microfilmscenter.com",target:"blank",color:"primary",icon:""}},[n("v-icon",[e._v("mdi-web")])],1)],1)],1)],1),n("v-divider",{attrs:{vertical:""}}),n("v-col",{attrs:{cols:8}},[n("v-form",{attrs:{autocomplete:"off"}},[n("v-row",{attrs:{justify:"start"}},[n("v-col",{attrs:{cols:11,align:"start"}},[n("v-select",{attrs:{solo:"",items:e.users,"prepend-inner-icon":e.mobile?"":"mdi-account-circle",placeholder:"Usuario",dense:"",autofocus:""},model:{value:e.selectedUser,callback:function(t){e.selectedUser=t},expression:"selectedUser"}}),n("v-text-field",{attrs:{readonly:"","prepend-inner-icon":e.mobile?"":"mdi-key",type:"password",placeholder:"Contraseña"}}),n("v-btn",{attrs:{loading:e.loader,color:"primary",block:"",small:""},on:{click:function(t){return e.tryLog(e.selectedUser)}}},[e._v(" Iniciar ")])],1)],1)],1)],1)],1)],1)],1)],1),[n("v-footer",{staticClass:"mt-15",attrs:{fixed:"",bottom:"",dark:"",padless:""}},[n("v-card",{staticClass:"text-center",attrs:{"min-width":"100%",flat:"",tile:""}},[n("v-card-text",e._l(e.links,(function(t,a){return n("v-btn",{key:a,staticClass:"mx-4",attrs:{href:t.url,target:"blank",icon:""}},[n("v-icon",{attrs:{size:"24px"}},[e._v(" "+e._s(t.icon)+" ")])],1)})),1),n("v-card-text",{staticClass:"pt-0"},[e._v(" Mantra es una herramienta gestión de operaciones desarrollada para Microfilms Center. Eres libre de escribir datos en esta versión de pruebas. ")]),n("v-divider"),n("v-card-text",[e._v(" "+e._s((new Date).getFullYear())+" — Desarrollado por "),n("strong",[e._v("Edgar Parucho")])])],1)],1)]],2)],1)},Do=[],wo={name:"Login",data:function(){return{loader:!1,selectedUser:"",users:[{text:"Edgar Parucho (Admin)",value:{idDocument:"20926619",userPassword:"20926619"}},{text:"Samuel Vivas (Usuario - Almacén)",value:{idDocument:"15367598",userPassword:"15367598"}},{text:"Bryan Sanz (Usuario - Help Desk)",value:{idDocument:"20491189",userPassword:"20491189"}}],links:[{icon:"mdi-whatsapp",url:"https://wa.me/+584142861620"},{icon:"mdi-linkedin",url:"https://www.linkedin.com/in/edgar-parucho-045769211/?lipi=urn%3Ali%3Apage%3Aprofile_view_index_index%3BHCUWI1GSTqe%2F%2Fbiw922TzQ%3D%3D"},{icon:"mdi-email",url:"mailto:parucho.edgar@outlook.es"},{icon:"mdi-github",url:"https://github.com/parucho"}]}},computed:{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}},methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["logIn","getcollections"])),{},{tryLog:function(e){var t=this;this.loader=!0,this.logIn(e).then((function(e){t.$session.start(),t.$session.set("session",e),t.loader=!1,t.getcollections(),t.$router.push("/")})).catch((function(){return t.loader=!1}))}})},Oo=wo,So=a("553a"),Vo=Object(v["a"])(Oo,_o,Do,!1,null,null,null),Fo=Vo.exports;b()(Vo,{VAlert:ne["a"],VBtn:j["a"],VCard:N["a"],VCardSubtitle:pe["b"],VCardText:pe["c"],VCardTitle:pe["d"],VCol:I["a"],VContainer:h["a"],VDivider:M["a"],VFooter:So["a"],VForm:Te["a"],VIcon:g["a"],VImg:$["a"],VRow:T["a"],VSelect:et["a"],VSpacer:R["a"],VTextField:Re["a"]});var jo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:e.mobile?12:6}},[a("Graph",{attrs:{id:"dashboardGraph1",chartData:e.servicesXTechnician,title:"Servicios por técnico",subtitle:e.thisMonth}})],1),a("v-col",{attrs:{cols:e.mobile?12:6}},[a("Graph",{attrs:{id:"dashboardGraph2",chartData:e.servicesXClient,title:"Servicios por cliente",subtitle:e.thisMonth}})],1),a("v-row",[a("v-col",[a("v-alert",{attrs:{type:"info",color:"#15b",text:""}},[e._v(" Los indicadores de mantenimiento "),a("b",[e._v("correctivo")]),e._v(" se contabilizan por reporte o servicio especial. ")])],1)],1),a("v-row",[a("v-col",[a("v-alert",{attrs:{type:"info",color:"#b15",text:""}},[e._v(" Los indicadores de mantenimiento "),a("b",[e._v("preventivo")]),e._v(" se contabilizan por oficina y orden validada. ")])],1)],1)],1)],1)},No=[],Io={name:"Stats",components:{Graph:he},data:function(){return{}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["e"])(["collections"])),Object(l["c"])(["formOptions"])),{},{mobile:function(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},thisMonth:function(){return le()(new Date).format("MMMM")},corrective:function(){return[].concat(Object(J["a"])(this.collections.Active),Object(J["a"])(this.collections.Closed))},servicesXClient:function(){var e,t=this,a="bar",n={},i={labels:this.formOptions.clients.map((function(e){return e.clientName})),datasets:[{label:"Correctivo",data:[],backgroundColor:"#15b"},{label:"Preventivo",data:[],backgroundColor:"#b15"}]},r=Object(Z["a"])(this.formOptions.clients);try{var o=function(){var a=e.value,n=function(e){return e.clientName===a.clientName};i.datasets[0].data.push(t.corrective.filter(n).length)};for(r.s();!(e=r.n()).done;)o()}catch(u){r.e(u)}finally{r.f()}var c,s=Object(Z["a"])(this.formOptions.clients);try{var l=function(){var e=c.value,a=function(t){return t.clientName===e.clientName};i.datasets[1].data.push(t.finishedMaint.filter(a).length)};for(s.s();!(c=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}return{type:a,data:i,options:n}},servicesXTechnician:function(){var e,t=this,a="line",n={},i={labels:this.formOptions.technicians.map((function(e){return e.text})),datasets:[{label:"Correctivo",data:[],backgroundColor:"#15b"},{label:"Preventivo",data:[],backgroundColor:"#b15"}]},r=Object(Z["a"])(this.formOptions.technicians);try{var o=function(){var a=e.value,n=function(e){return e.schedule.technician.fullName===a.text};i.datasets[0].data.push(t.corrective.filter(n).length)};for(r.s();!(e=r.n()).done;)o()}catch(u){r.e(u)}finally{r.f()}var c,s=Object(Z["a"])(this.formOptions.technicians);try{var l=function(){var e=c.value,a=function(t){return t.inventory.filter((function(t){return t.schedule.technician.fullName===e.text})).length};i.datasets[1].data.push(t.finishedMaint.filter(a).length)};for(s.s();!(c=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}return{type:a,data:i,options:n}},finishedMaint:function(){var e=new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),t=new Date((new Date).getFullYear(),(new Date).getMonth(),1),a=function(t){return le()(t.lastMaintenance).parseZone("America/Caracas").isAfter(e)},n=function(e){return le()(e.lastMaintenance).parseZone("America/Caracas").isBefore(t)},i=this.collections.Office.filter((function(e){return a(e)&&n(e)}));return console.log(i),i}})},Mo=Io,$o=Object(v["a"])(Mo,jo,No,!1,null,null,null),Po=$o.exports;b()($o,{VAlert:ne["a"],VCol:I["a"],VContainer:h["a"],VRow:T["a"]}),n["a"].use(Q["a"]);var To=[{path:"/login",name:"Login",component:Fo},{path:"/",name:"Dashboard",component:Gt},{path:"/correctivo",name:"Corrective",component:Xa},{path:"/consultas",name:"Consultation",component:Yn},{path:"/piezas",name:"Pieces",component:ai,meta:{adminOnly:!0}},{path:"/solicitudes",name:"Requests",component:pi},{path:"/despachos",name:"Dispatches",component:Mi},{path:"/clientes",name:"Clients",component:pr},{path:"/productos",name:"Products",component:qr,meta:{adminOnly:!0}},{path:"/preventivo",name:"Preventive",component:Nn},{path:"/oficinas",name:"Offices",component:lo},{path:"/usuarios",name:"Users",component:xo,meta:{adminOnly:!0}},{path:"/stats",name:"Stats",component:Po,meta:{adminOnly:!0}}],Ro=new Q["a"]({mode:"history",base:"/",routes:To}),Ao=Ro,qo=(a("b64b"),"Error inesperado. Verifique la conexión, recargue la página e intente nuevamente");n["a"].use(l["a"]);var Eo=new l["a"].Store({state:{loading:!1,collections:{Active:[],Client:[],Closed:[],Maintenance:[],Office:[],Piece:[],Product:[],Request:[],User:[]},session:{user:null,token:null},snackbar:{activated:!1,title:"",message:"",error:""}},mutations:{logIn:function(e,t){e.session=t},logOut:function(e){e.session={user:null,token:null}},toggleLoader:function(e){e.loading=!e.loading},showSnackbar:function(e,t){var a=t.error,n=t.message;e.snackbar={activated:!0,title:a?"Acción denegada":"Acción realizada",message:a||n,error:a}},setCollection:function(e,t){e.collections[t.name]=t.data},addNewDocument:function(e,t){var a=t.collection,n=t.body;e.collections[a]&&e.collections[a].push(n)},updateDocument:function(e,t){var a=t.collection,n=t.body;if(e.collections[a]){var i=e.collections[a].findIndex((function(e){return e._id===n._id}));-1!==i&&e.collections[a].splice(i,1,n)}},removeDocument:function(e,t){var a=t.collection,n=t.body;if(e.collections[a]){var i=e.collections[a].findIndex((function(e){return e._id===n._id}));-1!==i&&e.collections[a].splice(i,1)}},setRelatedDocuments:function(e,t){var a=e.collections.Active.findIndex((function(e){return e.serialCode===t.serialCode})),n=Object.assign({},e.collections.Active[a]);n.relatedDocuments=t.data,e.collections.Active.splice(a,1,n)}},actions:{logIn:function(e,t){var a=e.commit;return new Promise((function(e,n){ia.a.post("/login",t).then((function(t){var i=t.data;if(i.error)return n(a("showSnackbar",{error:i.error}));a("logIn",i),a("showSnackbar",{message:"".concat(i.user.firstName,", te damos la bienvenida")}),e(i)})).catch((function(e){a("showSnackbar",{error:qo}),n(e),console.error(e)}))}))},getcollections:function(e){var t=e.state,a=e.dispatch,n=e.commit;n("toggleLoader");for(var i=Object.keys(t.collections),r=[],o=0,c=i;o<c.length;o++){var s=c[o];r.push(a("getCollection",s))}Promise.all(r).then((function(){return n("toggleLoader")})).catch((function(e){n("showSnackbar",{error:qo}),console.error(e)}))},getCollection:function(e,t){var a=e.state,n=e.commit,i="all";if("Closed"===t){var r="".concat(le()(new Date).format("yyyy-MM"),"-01");i=r}return new Promise((function(e,r){ia.a.get("/".concat(t,"/").concat(i),{headers:{"auth-token":a.session.token}}).then((function(a){var i=a.data;if(i.error)return r(n("showSnackbar",{error:i.error}));e(n("setCollection",{name:t,data:i}))})).catch((function(e){return r(n("showSnackbar",{error:qo}),console.error(e))}))}))},createDocument:function(e,t){var a=e.state,n=e.commit,i=t.collection,r=t.body;return new Promise((function(e,t){ia.a.post(i,r,{headers:{"auth-token":a.session.token}}).then((function(a){var r=a.data;if(r.error)return t(n("showSnackbar",{error:r.error}));e(n("addNewDocument",{collection:i,body:r}),n("showSnackbar",{message:"Base de datos actualizada"}))})).catch((function(e){return t(n("showSnackbar",{error:qo}),console.error(e))}))}))},deleteDocument:function(e,t){var a=e.state,n=e.commit,i=t.collection,r=t.body;return new Promise((function(e,t){ia.a.delete("/".concat(i,"/").concat(r._id),{headers:{"auth-token":a.session.token}}).then((function(a){var r=a.data;if(r.error)return t(n("showSnackbar",{error:r.error}));e(n("removeDocument",{collection:i,body:r}),n("showSnackbar",{message:"Base de datos actualizada"}))})).catch((function(e){return t(n("showSnackbar",{error:qo}),console.error(e))}))}))},updateDocument:function(e,t){var a=e.state,n=e.commit,i=t.collection,r=t.body;return new Promise((function(e,t){ia.a.put("/".concat(i,"/").concat(r._id),r,{headers:{"auth-token":a.session.token}}).then((function(a){var r=a.data;if(r.error)return t(n("showSnackbar",{error:r.error}));e(n("updateDocument",{collection:i,body:r}),n("showSnackbar",{message:"Base de datos actualizada"}))})).catch((function(e){return t(n("showSnackbar",{error:qo}),console.error(e))}))}))},updateDocuments:function(e,t){var a=e.state,n=e.commit,i=e.dispatch,r=t.collection,o=t.query,c=t.update,s=t.options;return new Promise((function(e,t){ia.a.put("/updateMany/".concat(r),{query:o,update:c,options:s},{headers:{"auth-token":a.session.token}}).then((function(o){var c=o.data;if(c.error)return t(n("showSnackbar",{error:c.error}));a.collections[r]&&c.nModified&&i("getCollection",r).then((function(){return n("showSnackbar",{message:"Base de datos actualizada"})}),e())})).catch((function(e){return t(n("showSnackbar",{error:qo}),console.error(e))}))}))},findDocuments:function(e,t){var a=e.state,n=e.commit;return new Promise((function(e,i){ia.a.post("/find/".concat(t.collection),{filter:t.filter},{headers:{"auth-token":a.session.token}}).then((function(t){var a=t.data;if(a.error)return i(n("showSnackbar",{error:a.error}));e(a)})).catch((function(e){return i(n("showSnackbar",{error:qo}),console.error(e))}))}))}},getters:{formOptions:function(e){var t,a=e.collections,n=e.session,i=n.token,r="".concat(le()(new Date).format("yyyy"),"-01-01"),o={fullName:n.user?"".concat(n.user.firstName," ").concat(n.user.lastName):"",_id:n.user?n.user._id:""},c=[],s=a.Client.map((function(e){return e.clientName})).sort(),l=Object(Z["a"])(s);try{var u=function(){var e=t.value;c.push(a.Client.find((function(t){return t.clientName===e})))};for(l.s();!(t=l.n()).done;)u()}catch(x){l.e(x)}finally{l.f()}var d=a.Client.filter((function(e){return e.contracts.find((function(e){return e.active}))})),m=a.Office.filter((function(e){return!e.lastMaintenance||e.lastMaintenance<r})),f=a.Product.map((function(e){return e.productType})),v=a.User.filter((function(e){return e.assignable})).sort((function(e,t){return e.firstName>t.firstName?1:-1})),p=[];if(v.length){var b,h=Object(Z["a"])(v);try{for(h.s();!(b=h.n()).done;){var g=b.value,y="".concat(g.firstName," ").concat(g.lastName);p.push({text:y,value:{fullName:y,_id:g._id}})}}catch(x){h.e(x)}finally{h.f()}}var C=a.Product.map((function(e){return e.categories}));function k(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.reduce((function(e,t){return[].concat(Object(J["a"])(e),Object(J["a"])(new Set(t)))}),[])}return C=k(C)[0],{categories:C,clients:c,clientNames:s,clientsWithContract:d,pendingMaintenance:m,productTypes:f,technicians:p,token:i,user:o}}}}),Lo=a("f309"),Ho=a("5e4e");n["a"].use(Lo["a"]);var Bo=new Lo["a"]({theme:{options:{customProperties:!0},themes:{light:{primary:"#11bD56",secondary:"#10b060",accent:"#00c0d0",error:"#FF5252",info:"#1156bD",success:"#11CD56",warning:"#FFBF00"}}},lang:{locales:{es:Ho["a"]},current:"es"}}),Yo=(a("d5e8"),a("5363"),a("bf15")),zo=a("0628"),Go=a.n(zo);ia.a.defaults.baseURL="https://testing-mantra.herokuapp.com/api",n["a"].config.productionTip=!1,n["a"].use(Go.a),n["a"].use(Yo["a"]),new n["a"]({router:Ao,store:Eo,vueSession:Go.a,vuetify:Bo,render:function(e){return e(G)}}).$mount("#app")},"64c3":function(e,t,a){e.exports=a.p+"img/failure.84274bc5.svg"},"6f9f":function(e,t,a){e.exports=a.p+"img/dashboard.951d648f.svg"},"7a62":function(e,t,a){e.exports=a.p+"img/status.c96190ab.svg"},"7e7c":function(e,t,a){e.exports=a.p+"img/barcode-identification.7e14a460.svg"},"85ec":function(e,t,a){},c7d4:function(e,t,a){e.exports=a.p+"img/sla.82698f69.svg"},c88b:function(e,t,a){e.exports=a.p+"img/typewriter.b829ae0d.svg"},cbb6:function(e,t,a){e.exports=a.p+"img/logoMfc.bb7dcf84.png"},ccc1:function(e,t,a){e.exports=a.p+"img/bank.7533ae65.svg"},d9c9:function(e,t,a){e.exports=a.p+"img/handshake.f7006fd2.svg"},ef5c:function(e,t,a){e.exports=a.p+"img/bg12.7147fc0c.jpg"},f625:function(e,t,a){e.exports=a.p+"img/protection.21d590fa.svg"},fd1c:function(e,t,a){e.exports=a.p+"img/timer.950e0aa3.svg"},fe3c:function(e,t,a){e.exports=a.p+"img/file.56231ac6.svg"}});
//# sourceMappingURL=app.2dcb8757.js.map